{"version":3,"sources":["D2App/components/Visualization/styles/StartScreen.module.css","D2App/assets/PivotTableIcon.js","D2App/reducers/visualization.js","D2App/modules/options.js","D2App/modules/visualization.js","D2App/modules/layout.js","D2App/modules/current.js","D2App/reducers/current.js","D2App/modules/orgUnit.js","D2App/modules/program.js","D2App/modules/ui.js","D2App/reducers/ui.js","D2App/actions/current.js","D2App/reducers/loader.js","D2App/reducers/metadata.js","D2App/reducers/settings.js","D2App/actions/metadata.js","D2App/api/settings.js","D2App/modules/settings.js","D2App/actions/ui.js","D2App/reducers/user.js","D2App/actions/visualization.js","D2App/modules/dataStatistics.js","D2App/modules/history.js","D2App/components/Interpretations/common/Interpretation/InterpretationDeleteButton.js","D2App/components/Interpretations/common/Interpretation/InterpretationUpdateForm.js","D2App/components/Interpretations/common/Interpretation/Interpretation.js","D2App/components/Interpretations/common/Interpretation/useLike.js","D2App/components/Interpretations/common/Message/Message.js","D2App/components/Interpretations/common/Message/MessageButtonStrip.js","D2App/components/Interpretations/common/Message/MessageIconButton.js","D2App/components/Interpretations/common/Message/MessageInput.js","D2App/components/Interpretations/common/Message/MessageEditorContainer.js","D2App/components/Interpretations/common/Message/MessageStatsBar.js","D2App/components/Interpretations/common/UserMention/styles/UserMentionWrapper.style.js","D2App/components/Interpretations/common/UserMention/UserList.js","D2App/components/Interpretations/common/UserMention/useUserSearchResults.js","D2App/components/Interpretations/common/UserMention/UserMentionWrapper.js","D2App/components/Interpretations/common/RichTextEditor/markdownHandler.js","D2App/components/Interpretations/common/RichTextEditor/styles/RichTextEditor.style.js","D2App/components/Interpretations/common/RichTextEditor/RichTextEditor.js","D2App/components/Interpretations/InterpretationsUnit/InterpretationForm.js","D2App/components/Interpretations/InterpretationsUnit/InterpretationList.js","D2App/components/Interpretations/InterpretationsUnit/InterpretationsUnit.js","D2App/components/DetailsPanel/DetailsPanel.js","D2App/modules/conditions.js","D2App/components/Dialogs/AddToLayoutButton/AddToLayoutButton.js","D2App/components/Dialogs/DimensionModal.js","D2App/components/Dialogs/Conditions/AlphanumericCondition.js","D2App/components/Dialogs/Conditions/BooleanCondition.js","D2App/components/Dialogs/Conditions/DateCondition.js","D2App/api/legendSets.js","D2App/components/Dialogs/Conditions/NumericCondition.js","D2App/api/options.js","D2App/modules/utils.js","D2App/components/Dialogs/Conditions/OptionSetCondition.js","D2App/components/Dialogs/Conditions/OrgUnitCondition.js","D2App/components/Dialogs/Conditions/ConditionsManager.js","D2App/components/Dialogs/FixedDimension.js","D2App/components/Dialogs/DialogManager.js","D2App/components/DndContext.js","D2App/components/Toolbar/MenuBar/MenuButton.js","D2App/components/DownloadMenu/constants.js","D2App/components/DownloadMenu/PlainDataSourceSubMenu.js","D2App/components/DownloadMenu/DownloadMenu.js","D2App/components/DownloadMenu/useDownloadMenu.js","D2App/components/DownloadMenu/ToolbarDownloadDropdown.js","D2App/components/DownloadMenu/ModalDownloadDropdown.js","D2App/components/Visualization/useAnalyticsData.js","D2App/components/Visualization/useAvailableWidth.js","D2App/components/Visualization/Visualization.js","D2App/components/Interpretations/InterpretationModal/CommentDeleteButton.js","D2App/components/Interpretations/InterpretationModal/CommentUpdateForm.js","D2App/components/Interpretations/InterpretationModal/Comment.js","D2App/components/Interpretations/InterpretationModal/CommentAddForm.js","D2App/components/Interpretations/InterpretationModal/InterpretationThread.js","D2App/components/Interpretations/InterpretationModal/InterpretationModal.js","D2App/components/InterpretationModal/interpretationIdQueryParam.js","D2App/components/InterpretationModal/InterpretationModal.js","D2App/modules/axis.js","D2App/assets/DynamicDimensionIcon.js","D2App/components/Layout/TooltipContent.js","D2App/components/Layout/Chip.js","D2App/modules/dnd.js","D2App/components/DimensionMenu/DimensionMenu.js","D2App/components/IconButton/IconButton.js","D2App/components/Layout/ChipMenu.js","D2App/components/Layout/DefaultLayout/DefaultAxis.js","D2App/components/Layout/LineListLayout/LineListLayout.js","D2App/components/Layout/Layout.js","D2App/components/LoadingMask/LoadingMask.js","D2App/components/MainSidebar/InputPanel/InputOption.js","D2App/components/MainSidebar/InputPanel/InputPanel.js","D2App/components/MainSidebar/MenuItem/MenuItem.js","D2App/components/MainSidebar/ProgramDimensionsPanel/StageSelect.js","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsFilter.js","D2App/components/MainSidebar/DimensionsList/DimensionListFields.js","D2App/components/MainSidebar/DimensionsList/DimensionListItem.js","D2App/components/MainSidebar/DimensionsList/DimensionsList.js","D2App/components/MainSidebar/ProgramDimensionsPanel/useProgramDimensions.js","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsList.js","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramSelect.js","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsPanel.js","D2App/components/MainSidebar/YourDimensionsPanel/useYourDimensions.js","D2App/components/MainSidebar/YourDimensionsPanel/YourDimensionsPanel.js","D2App/components/MainSidebar/MainSidebar.js","D2App/components/TitleBar/TitleBar.js","D2App/assets/ErrorIcons.js","D2App/modules/error.js","D2App/components/VisualizationOptions/styles/VisualizationOptions.style.js","D2App/components/VisualizationOptions/Options/CheckboxBaseOption.js","D2App/components/VisualizationOptions/Options/CompletedOnly.js","D2App/components/VisualizationOptions/Options/SelectBaseOption.js","D2App/components/VisualizationOptions/Options/DigitGroupSeparator.js","D2App/components/VisualizationOptions/Options/DisplayDensity.js","D2App/components/VisualizationOptions/Options/FontSize.js","D2App/modules/options/sections/templates/display.js","D2App/modules/options/tabs/data.js","D2App/modules/options/tabs/style.js","D2App/components/VisualizationOptions/Options/ColSubTotals.js","D2App/components/VisualizationOptions/Options/ColTotals.js","D2App/components/VisualizationOptions/Options/HideEmptyRows.js","D2App/components/VisualizationOptions/Options/RowSubTotals.js","D2App/components/VisualizationOptions/Options/RowTotals.js","D2App/components/VisualizationOptions/Options/ShowDimensionLabels.js","D2App/components/VisualizationOptions/Options/ShowHierarchy.js","D2App/components/VisualizationOptions/Options/TextBaseOption.js","D2App/components/VisualizationOptions/Options/Title.js","D2App/modules/options/sections/templates/emptyData.js","D2App/modules/options/sections/templates/totals.js","D2App/components/VisualizationOptions/Options/LegendSet.js","D2App/components/VisualizationOptions/Options/LegendDisplayStrategy.js","D2App/components/VisualizationOptions/Options/RadioBaseOption.js","D2App/components/VisualizationOptions/Options/LegendDisplayStyle.js","D2App/components/VisualizationOptions/Options/ShowLegendKey.js","D2App/components/VisualizationOptions/Options/Legend.js","D2App/components/VisualizationOptions/Options/MeasureCriteria.js","D2App/modules/options/config.js","D2App/modules/options/pivotTableConfig.js","D2App/modules/options/tabs/legend.js","D2App/modules/options/tabs/limitValues.js","D2App/modules/options/lineListConfig.js","D2App/components/VisualizationOptions/VisualizationOptionsManager.js","D2App/components/Toolbar/MenuBar/InterpretationsButton.js","D2App/components/Toolbar/MenuBar/MenuBar.js","D2App/assets/ArrowDown.js","D2App/components/Toolbar/VisualizationTypeSelector/ListItemIcon.js","D2App/components/Toolbar/VisualizationTypeSelector/VisualizationTypeListItem.js","D2App/components/Toolbar/VisualizationTypeSelector/VisualizationTypeSelector.js","D2App/components/Toolbar/Toolbar.js","D2App/components/Visualization/StartScreen.js","D2App/components/App.js","D2App/actions/settings.js","D2App/modules/metadata.js","D2App/actions/user.js","D2App/actions/loader.js","D2App/components/UserSettingsProvider.js","D2App/reducers/index.js","D2App/configureStore.js","D2App/middleware/metadata.js","D2App/locales/index.js","D2App/AppWrapper.js","D2App/components/Dialogs/Conditions/styles/Condition.module.css","D2App/components/App.module.css","D2App/components/Layout/DefaultLayout/styles/DefaultAxis.module.css","D2App/components/Toolbar/VisualizationTypeSelector/styles/VisualizationTypeSelector.module.css","D2App/components/DetailsPanel/styles/DetailsPanel.module.css","D2App/components/Dialogs/styles/DimensionModal.module.css","D2App/components/Dialogs/Conditions/styles/ConditionsManager.module.css","D2App/components/Toolbar/MenuBar/styles/MenuButton.module.css","D2App/components/DownloadMenu/ModalDownloadDropdown.module.css","D2App/components/Visualization/styles/Visualization.module.css","D2App/components/Layout/styles/Chip.module.css","D2App/components/Layout/styles/Tooltip.module.css","D2App/components/IconButton/styles/IconButton.module.css","D2App/components/Layout/DefaultLayout/styles/DefaultLayout.module.css","D2App/components/Layout/LineListLayout/styles/LineListLayout.module.css","D2App/components/Layout/styles/Layout.module.css","D2App/components/LoadingMask/styles/LoadingMask.module.css","D2App/components/MainSidebar/InputPanel/InputOption.module.css","D2App/components/MainSidebar/InputPanel/InputPanel.module.css","D2App/components/MainSidebar/MainSidebar.module.css","D2App/components/MainSidebar/MenuItem/MenuItem.module.css","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsFilter.module.css","D2App/components/MainSidebar/DimensionsList/DimensionListItem.module.css","D2App/components/MainSidebar/DimensionsList/DimensionsList.module.css","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsPanel.module.css","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramSelect.module.css","D2App/components/MainSidebar/YourDimensionsPanel/YourDimensionsPanel.module.css","D2App/components/TitleBar/styles/TitleBar.module.css","D2App/components/Toolbar/MenuBar/styles/InterpretationsButton.module.css","D2App/components/Toolbar/MenuBar/styles/MenuBar.module.css"],"names":["module","exports","PivotTableIcon","style","paddingRight","width","height","React","createElement","xmlns","viewBox","fill","fillRule","points","x","y","stroke","strokeWidth","SET_VISUALIZATION","CLEAR_VISUALIZATION","DEFAULT_VISUALIZATION","sGetVisualization","state","visualization","OPTION_LEGEND_DISPLAY_STRATEGY","OPTION_LEGEND_DISPLAY_STYLE","OPTION_LEGEND_SET","DISPLAY_DENSITY_COMFORTABLE","DISPLAY_DENSITY_NORMAL","DISPLAY_DENSITY_COMPACT","FONT_SIZE_NORMAL","options","completedOnly","defaultValue","requestable","savable","displayDensity","fontSize","digitGroupSeparator","getOptionsForUi","Object","entries","reduce","map","option","props","DIMENSION_TYPE_ALL","DIMENSION_TYPE_DATA_ELEMENT","DIMENSION_TYPE_PROGRAM_ATTRIBUTE","DIMENSION_TYPE_PROGRAM_INDICATOR","VIS_TYPE_PIVOT_TABLE","VIS_TYPE_LINE_LIST","OUTPUT_TYPE_EVENT","OUTPUT_TYPE_ENROLLMENT","TIME_DIMENSION_EVENT_DATE","TIME_DIMENSION_ENROLLMENT_DATE","TIME_DIMENSION_INCIDENT_DATE","TIME_DIMENSION_SCHEDULED_DATE","TIME_DIMENSION_LAST_UPDATED","headersMap","ou","programStatus","eventStatus","storedBy","lastUpdatedBy","visTypeMap","name","i18n","t","description","icon","disabled","disabledText","transformDimension","dimensionObj","outputType","timeDimensionMap","dimensionType","dimension","DIMENSION_ID_PERIOD","STATE_EMPTY","STATE_SAVED","STATE_UNSAVED","STATE_DIRTY","getFilteredLayout","layout","excludedIds","_layout$AXIS_ID_COLUM","_layout$AXIS_ID_ROWS","_layout$AXIS_ID_FILTE","ids","Array","isArray","AXIS_ID_COLUMNS","filter","dim","includes","AXIS_ID_ROWS","AXIS_ID_FILTERS","LAYOUT_TYPE_LINE_LIST","getAdaptedUiLayoutByType","type","getLineListLayout","columns","slice","rows","getProgramFromUi","ui","_ui$program","program","id","getProgramStageFromUi","_ui$program2","stage","programStage","getOptionsFromUi","pick","keys","getAxesFromUi","axisId","dimensionIds","dimensionId","_ui$conditions$dimens","_ui$conditions$dimens2","dimensionCreate","itemsByDimension","conditions","condition","legendSet","getItemsByDimensionFromUi","result","forEach","key","SET_CURRENT","SET_CURRENT_FROM_UI","CLEAR_CURRENT","DEFAULT_CURRENT","sGetCurrent","current","sGetCurrentId","_state$current","removeLastPathSegment","path","match","length","substr","lastIndexOf","getOuPath","metadata","parentGraphMap","undefined","getProgramFromVisualisation","vis","_vis$program","_vis$programStage","getAdaptedUiByType","lineListUiAdapter","getParentGraphMapFromVisualization","ouAxis","getInverseLayout","layoutGetAxisIdDimensionIdsObject","DIMENSION_ID_ORGUNIT","find","items","orgUnit","getConditionsFromVisualization","filters","item","acc","_key$legendSet","SET_UI_INPUT","CLEAR_UI_PROGRAM","UPDATE_UI_PROGRAM_ID","UPDATE_UI_PROGRAM_STAGE","SET_UI_OPTIONS","ADD_UI_LAYOUT_DIMENSIONS","REMOVE_UI_LAYOUT_DIMENSIONS","SET_UI_LAYOUT","SET_UI_FROM_VISUALIZATION","CLEAR_UI","SET_UI_DETAILS_PANEL_OPEN","SET_UI_ACCESSORY_PANEL_OPEN","SET_UI_EXPANDED_LAYOUT_PANEL","SET_UI_ACTIVE_MODAL_DIALOG","SET_UI_ITEMS","ADD_UI_PARENT_GRAPH_MAP","SET_UI_CONDITIONS","SET_UI_REPETITION","EMPTY_UI","input","repetitionByDimension","DEFAULT_UI","showAccessoryPanel","showDetailsPanel","showExpandedLayoutPanel","activeModalDialog","sGetUi","sGetUiInput","sGetUiProgram","sGetUiOptions","sGetUiItems","sGetUiLayout","sGetUiShowDetailsPanel","sGetUiShowAccessoryPanel","sGetUiType","sGetUiActiveModalDialog","sGetUiParentGraphMap","sGetUiInputType","sGetUiProgramId","sGetUiProgramStage","sGetUiItemsByDimension","sGetDimensionIdsFromLayout","values","axisDimensionIds","concat","sGetUiConditionsByDimension","sGetUiConditions","acSetCurrent","value","tSetCurrentFromUi","async","dispatch","getState","SET_LOAD_ERROR","CLEAR_LOAD_ERROR","SET_VISUALIZATION_LOADING","DEFAULT_LOADING","loadingError","isVisualizationLoading","sGetIsVisualizationLoading","loader","ADD_METADATA","DEFAULT_METADATA","sGetMetadata","sGetMetadataById","ADD_SETTINGS","DEFAULT_SETTINGS","displayNameProperty","rootOrgUnits","sGetSettings","settings","sGetSettingsDisplayNameProperty","sGetRootOrgUnits","acAddMetadata","systemSettingsQuery","resource","params","acClearUiProgram","acUpdateUiProgramStage","tSetUiProgram","programId","stageId","acUpdateUiProgramId","acSetUiOptions","acSetUiOption","acAddUiLayoutDimensions","acSetUiDetailsPanelOpen","acSetShowExpandedLayoutPanel","acSetUiOpenDimensionModal","acAddParentGraphMap","SET_USER","DEFAULT_USER","username","uiLocale","isSuperuser","authorities","sGetUser","user","sGetUsername","acSetVisualization","_dim$optionSet","valueType","optionSet","_dim$optionSet2","EVENT_TYPE","createHashHistory","mutation","InterpretationDeleteButton","onComplete","remove","loading","useDataMutation","variables","MessageIconButton","tooltipContent","iconComponent","IconDelete16","onClick","partial","data","interpretationText","InterpretationUpdateForm","close","currentUser","text","setInterpretationText","useState","update","error","errorText","message","className","_JSXStyle","dynamic","spacers","dp8","colors","grey100","MessageEditorContainer","RichTextEditor","inputPlaceholder","onChange","MessageButtonStrip","Button","primary","small","secondary","Interpretation","interpretation","onUpdated","onDeleted","onReplyIconClick","isUpdateMode","setIsUpdateMode","toggleLike","isLikedByCurrentUser","toggleLikeInProgress","likeMutationRef","useRef","unlikeMutationRef","like","likeLoading","unlike","unlikeLoading","setIsLikedByCurrentUser","useEffect","likedBy","some","useLike","Message","created","displayName","MessageStatsBar","IconThumbUp16","selected","count","likes","IconReply16","comments","access","IconEdit16","delete","_","event","stopPropagation","children","grey900","dp12","grey600","UserAvatar","extrasmall","dateTime","moment","format","RichTextParser","Icon","Tooltip","closeDelay","content","dp4","grey700","teal600","cx","color","teal500","_extends","assign","target","i","arguments","source","prototype","hasOwnProperty","call","apply","this","MessageInput","forwardRef","ref","Fragment","grey500","theme","focus","medium","userMentionWrapperClasses","dp16","white","__hash","resolvedHeaderStyle","styles","UserList","users","selectedUserIndex","onUserClick","pager","u","_users$selectedUserIn","MenuItem","dense","label","active","total","pageSize","usersQuery","searchText","fields","order","rootJunction","getVirtualPopperReference","rects","getClientRects","lastRect","left","getBoundingClientRect","top","right","bottom","UserMentionWrapper","inputReference","onUserSelect","captureText","setCaptureText","capturedText","setCapturedText","cloneText","setCloneText","cloneRef","captureStartPosition","setCaptureStartPosition","setSelectedUserIndex","fetching","clear","setData","refetch","useDataQuery","lazy","debouncedRefetch","useCallback","debounce","cancel","useUserSearchResults","reset","onSelect","originalValue","newValue","replace","requestAnimationFrame","setSelectionRange","onKeyDown","selectionStart","preventDefault","substring","onInput","selectionEnd","spacePosition","indexOf","filterValue","Portal","Popper","reference","placement","Card","Menu","MenuSectionHeader","hideDivider","CenteredContent","CircularLoader","defaultProps","Function","BOLD","ITALIC","LINK","MENTION","EMOJI_SMILEY_FACE","EMOJI_SAD_FACE","EMOJI_THUMBS_UP","EMOJI_THUMBS_DOWN","emojis","markdownMap","prefix","postfix","insertMarkdown","markdown","cb","start","end","marker","caretPos","padMarkers","valueArr","split","splice","join","trimmedText","mainClasses","toolbarClasses","grey050","grey300","emojisPopoverClasses","EmojisPopover","onInsertMarkdown","onClose","Popover","onClickOutside","Toolbar","onTogglePreview","previewButtonDisabled","previewMode","emojisButtonRef","emojisPopoverIsOpen","setEmojisPopoverIsOpen","iconColor","IconTextBold24","IconTextItalic24","IconLink24","IconAt24","IconFaceAdd24","markup","externalRef","setPreviewMode","internalRef","textareaRef","_textareaRef$current","dispatchEvent","KeyboardEvent","bubbles","Field","validationText","placeholder","ctrlKey","metaKey","convertCtrlKey","InterpretationForm","onSave","showRichTextEditor","setShowRichTextEditor","saveMutationRef","save","saveMutationInProgress","Input","onFocus","sortByDateProp","a","b","dateA","dateB","InterpretationList","interpretations","onInterpretationClick","refresh","interpretationsByDate","groupedInterpretations","date","push","grey800","dp32","sort","reverse","IconCalendar24","interpretationsQuery","InterpretationsUnit","isExpanded","setIsExpanded","onCompleteAction","useImperativeHandle","grey400","expanded","IconChevronUp24","IconChevronDown24","navigateToOpenModal","interpretationId","initialFocus","history","pathName","location","pathname","search","stringify","isModalOpening","connect","interpretationsUnitRef","classes","panel","AboutAOUnit","parseConditionsStringToArray","conditionsString","NULL_VALUE","OPERATOR_EQUAL","OPERATOR_NOT_EQUAL","OPERATOR_EMPTY","OPERATOR_NOT_EMPTY","OPERATOR_IN","CASE_INSENSITIVE_PREFIX","NOT_PREFIX","visType","dialogId","onAddDimension","dataTest","availableAxes","getAvailableAxes","AddToLayoutButton","SplitButton","clickHandler","component","FlyoutMenu","maxWidth","axis","axisName","getAxisNameByLayoutType","getLayoutTypeByVisType","DimensionModal","isInLayout","onUpdate","title","Modal","position","large","ModalTitle","ModalContent","modalContent","ModalActions","ButtonStrip","alert","operators","prefixOperator","operator","isCaseSensitive","checkIsCaseSensitive","BaseCondition","onRemove","allowCaseSensitive","parts","unprefixOperator","container","SingleSelectField","inputWidth","SingleSelectOption","setValue","Checkbox","checked","caseSensitiveCheckbox","removeButton","AlphanumericCondition","CaseSensitiveAlphanumericCondition","showFalseOption","onCheckboxChange","currentValues","setValues","v","checkboxOption","BooleanCondition","TrueOnlyCondition","replaceAll","DateCondition","DateTimeCondition","TimeCondition","dataElementsQuery","trackedEntityAttributesQuery","programIndicatorsQuery","legendSetsQuery","paging","NumericCondition","legendSetId","numberOfConditions","onLegendSetChange","enableDecimalSteps","_legendSet$legends","_value","_legendSet$legends2","useDispatch","availableLegendSets","useSelector","_sGetMetadataById","legendSets","dataEngine","useDataEngine","fetchLegendSets","query","Error","onError","console","log","apiFetchLegendSetsByDimension","setOperator","fetchLegendSet","apiFetchLegendSetById","onOperatorChange","MenuDivider","step","MultiSelectField","legends","startValue","legend","MultiSelectOption","optionsQuery","optionSetId","searchTerm","nameProp","page","useDebounce","delay","debouncedValue","setDebouncedValue","handler","setTimeout","clearTimeout","LeftHeader","setSearchTerm","transferLeftHeader","transferLeftTitle","InputField","EmptySelection","transferEmptyList","RightHeader","transferRightHeader","SourceEmptyPlaceholder","displayNameProp","addMetadata","_parts$","selectedOptions","code","setState","nextPage","debouncedSearchTerm","fetchItems","_result$options","response","apiFetchOptions","newOptions","every","newOption","selectedItem","fn","inputs","didMountRef","useDidUpdateEffect","Transfer","so","loadingPicked","sourceEmptyPlaceholder","onEndReached","leftHeader","selectedEmptyComponent","rightHeader","renderOption","TransferOption","OrgUnitCondition","addParentGraphMap","_selected$path","roots","rootOrgUnit","OrganisationUnitTree","initiallyExpanded","forMetadata","forParentGraphMap","singleSelection","VALUE_TYPE_NUMBER","VALUE_TYPE_UNIT_INTERVAL","VALUE_TYPE_PERCENTAGE","VALUE_TYPE_INTEGER","VALUE_TYPE_INTEGER_POSITIVE","VALUE_TYPE_INTEGER_NEGATIVE","VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE","VALUE_TYPE_TEXT","VALUE_TYPE_LONG_TEXT","VALUE_TYPE_LETTER","VALUE_TYPE_PHONE_NUMBER","VALUE_TYPE_EMAIL","VALUE_TYPE_USERNAME","VALUE_TYPE_BOOLEAN","VALUE_TYPE_TRUE_ONLY","VALUE_TYPE_DATE","VALUE_TYPE_TIME","VALUE_TYPE_DATETIME","VALUE_TYPE_ORGANISATION_UNIT","NUMERIC_TYPES","SINGLETON_TYPES","SUPPORTED_TYPES","mapDispatchToProps","setConditionsByDimension","ownProps","dimensionIdsInLayout","isProgramIndicator","isOptionSetCondition","canHaveLegendSets","isSupported","conditionsList","setConditionsList","_conditions$condition","getInitConditions","selectedLegendSet","setSelectedLegendSet","addCondition","removeCondition","conditionIndex","filteredConditionsList","index","setCondition","storeConditions","inputCondition","conditionsArray","cnd","disableAddButton","paragraph","mainSection","getDividerContent","separator","OptionSetCondition","renderNumericCondition","renderConditionsContent","infoIcon","IconInfo16","onMouseOver","onMouseOut","tooltipReference","addConditionButton","FixedDimension","ouIds","setUiItems","selectUiItems","itemIds","ouIdHelper","removePrefix","closeModal","dimensionProps","ouUid","display","OrgUnitDimension","renderModalContent","DialogManager","changeDialog","ConditionsManager","onAddDimensions","onReorderDimensions","DragDropContext","onDragEnd","destination","draggableId","droppableId","addDimensionToLayout","sourceAxisId","sourceIndex","destinationAxisId","destinationIndex","sourceList","from","moved","rearrangeLayoutDimensions","MenuButton","menuButton","propTypes","PropTypes","node","bool","func","DOWNLOAD_TYPE_PLAIN","DOWNLOAD_TYPE_TABLE","FILE_FORMAT_CSV","FILE_FORMAT_HTML_CSS","FILE_FORMAT_XLS","ID_SCHEME_NAME","PlainDataSourceSubMenu","download","menuItemProps","DownloadMenu","useDownloadMenu","relativePeriodDate","baseUrl","useConfig","analyticsEngine","Analytics","getAnalytics","buttonRef","isOpen","setIsOpen","idScheme","req","request","fromVisualization","withProgram","withStage","withPath","withFormat","withTableLayout","withColumns","column","withRows","row","withParameters","dataIdScheme","withOutputIdScheme","withRelativePeriodDate","url","URL","buildUrl","window","origin","buildQuery","searchParams","append","open","toggleOpen","ToolbarDownloadDropdown","Layer","ModalDownloadDropdown","DropdownButton","booleanMap","analyticsApiEndpointMap","formatRowValue","rowValue","header","metaDataItems","_findOptionSetItem","_metaDataItems$rowVal","findOptionSetItem","isTimeDimension","fetchAnalyticsData","sortField","sortDirection","adaptedVisualization","headers","timeDimensionParameters","adaptedColumns","adaptedFilters","_dimensionObj$items","_dimensionObj$items2","getAdaptedVisualization","withDisplayProperty","withOutputType","withPageSize","withPage","withAsc","withDesc","analyticsApiEndpoint","getQuery","useAnalyticsData","onResponseReceived","mounted","setLoading","setFetching","setError","analyticsResponse","extractHeaders","filteredRows","rowIndex","rowsCount","filteredRow","headerIndex","headersCount","metaData","extractRows","pageCount","doFetch","computeAvailableWidth","windowWidth","leftOpen","rightOpen","availableWidth","Visualization","setWindowWidth","innerWidth","debounceWindowWidth","setAvailableWidth","onResize","addEventListener","removeEventListener","useAvailableWidth","setSorting","setPage","setPageSize","NoticeBox","fontSizeClass","fontSizeLarge","fontSizeSmall","fontSizeNormal","getFontSizeClass","colSpan","String","Math","max","wrapper","fetchIndicator","DataTable","scrollHeight","scrollWidth","DataTableHead","DataTableRow","DataTableColumnHeader","fixed","onSortIconClick","direction","DataTableBody","_data$headers$index","DataTableCell","formatValue","skipRounding","DataTableFoot","stickyFooter","staticStyle","Pagination","onPageChange","onPageSizeChange","pageSizeSelectText","pageSummaryText","firstItem","lastItem","firstCaseIndex","lastCaseIndex","defaultValue_plural","commentId","CommentDeleteButton","CommentUpdateForm","commentText","setCommentText","updateMutationRef","Comment","comment","onThreadUpdated","createdBy","CommentAddForm","focusRef","InterpretationThread","onInterpretationDeleted","downloadMenuComponent","IconClock16","_focusRef$current","modalCSS","InterpretationModal","onInterpretationUpdate","isDirty","setIsDirty","shouldRenderModalContent","shouldCssHideModal","handleClose","hidden","dp24","visualisationName","nsSeparator","affectsInterpretation","parseBooleans","removeInterpretationQueryParams","parsed","parse","parsedWithoutInterpretationId","isModalClosing","setParams","listen","_location$state","_location$state2","useInterpretationQueryParams","setIsVisualizationLoading","AnalyticsInterpretationModal","getAxisName","DynamicDimensionIcon","version","transform","strokeLinecap","strokeLinejoin","d","labels","number","displayLimitedAmount","lockedLabel","getNameList","idList","levelString","levelId","itemDisplayNames","levelIds","groupIds","hasLevelPrefix","hasGroupPrefix","getItemDisplayNames","warningLabel","getWarningLabel","hasNoItemsLabel","list","iconWrapper","IconWarningFilled16","renderWarningLabel","IconLock16","itemsToRender","numberOfItems","renderItems","Chip","dimensionName","contextMenu","random","toString","renderChipContent","leftIconWrapper","itemsLabel","renderChipLabelSuffix","chipWrapper","chipEmpty","onDragStart","e","dataTransfer","JSON","dataset","dimensionid","TooltipContent","chip","chipLeft","chipRight","getAxisItemLabel","isDimensionInLayout","DimensionMenu","currentAxisId","axisItemHandler","removeItemHandler","menuItems","applicableAxisIds","IconButton","onBlur","ariaOwns","ariaHaspopup","iconButton","menuIsOpen","setMenuIsOpen","toggleMenu","IconMore16","renderChipsSelector","createSelector","layoutItems","flat","dataObjects","getConditionsByDimension","getItemsByDimension","renderChips","getOpenHandler","stateProps","dispatchProps","axisContainer","onDragOver","Droppable","provided","innerRef","droppableProps","Draggable","draggableProps","dragHandleProps","ChipMenu","Layout","defaultLayoutStyles","ct","axisGroup","lineListLayoutStyles","axisGroupLeft","DefaultAxis","defaultAxisStyles","axisContainerLeft","axisGroupRight","componentMap","LineListLayout","sGetUiShowExpandedLayoutPanel","LayoutComponent","ButtonIcon","IconChevronUp16","IconChevronDown16","overflowContainer","button","LoadingMask","outer","progress","InputOption","Radio","getLabelForInputType","InputPanel","visible","selectedInput","setSelectedInput","tabIndex","IconChevronRight16","StageSelect","optional","stages","selectedStageId","SingleSelect","ProgramDimensionsFilter","setDimensionType","showStageSelect","programStages","DIMENSION_LIST_FIELDS","DIMENSION_TYPE_ICONS","DATA_ELEMENT","DATA_ELEMENT_OPERAND","INDICATOR","IconDimensionIndicator16","REPORTING_RATE","PROGRAM_DATA_ELEMENT","PROGRAM_ATTRIBUTE","PROGRAM_INDICATOR","IconDimensionProgramIndicator16","PERIOD","ORGANISATION_UNIT","IconDimensionOrgUnit16","CATEGORY_OPTION","OPTION_GROUP","DATA_ELEMENT_GROUP","ORGANISATION_UNIT_GROUP","CATEGORY_OPTION_GROUP","DimensionListItem","warn","getIconForDimensionType","dimensionItem","picked","recommended","dragOnly","menuTrigger","isEndReached","el","scrollTop","clientHeight","DimensionsList","dimensions","programName","setIsListEndVisible","scrollBoxRef","loaderWrap","errorWrap","scrollbox","onScroll","loadMoreWrap","noResults","getNoResultsMessage","ACTIONS_RESET","ACTIONS_INIT","ACTIONS_SUCCESS","ACTIONS_ERROR","ACTIONS_SET_LIST_END_VISIBLE","initialState","isLastPage","isListEndVisible","reducer","action","payload","createDimensionsQuery","inputType","programStageId","ProgramDimensionsList","engine","useReducer","fetchDimensions","shouldReset","isVisible","useProgramDimensions","ProgramSelect","programs","setSelectedProgramId","requiredStageSelection","selectedProgram","select","stretch","PROGRAM_TYPE_WITHOUT_REGISTRATION","ProgramDimensionsPanel","selectedProgramId","called","filteredPrograms","programType","isProgramSelectionComplete","artificialStageId","section","bordered","helptext","YourDimensionsPanel","setDimensions","currDimensions","useYourDimensions","TAB_INPUT","TAB_PROGRAM","TAB_YOUR","MainSidebar","selectedInputType","selectedTabId","setSelectedTabId","setOpen","newOpen","main","IconArrowRight16","IconFolder16","accessory","padded","accessoryInner","defaultTitleClasses","cell","getTitleText","titleState","getSuffix","titleDirty","suffix","getVisualizationState","titleText","titleClasses","titleUnsaved","getCustomTitleClasses","titleBar","GenericError","VisualizationError","constructor","genericErrorTitle","tabSectionTitle","tabSectionTitleMargin","tabSectionOption","tabSectionOptionText","tabSectionOptionToggleable","tabSectionOptionComplexInline","inverted","CompletedOnly","Label","CheckboxBaseOption","_option$items$find","DigitGroupSeparator","SelectBaseOption","DisplayDensity","FontSize","ColSubTotals","ColTotals","HideEmptyRows","RowSubTotals","RowTotals","ShowDimensionLabels","ShowHierarchy","TextBaseOption","Title","LegendSetSelect","loadingText","sGetUiOption","optionId","setOptions","isLoaded","setIsLoaded","LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM","LEGEND_DISPLAY_STRATEGY_FIXED","LegendSet","LegendDisplayStyle","RadioBaseOption","LEGEND_DISPLAY_STYLE_FILL","LEGEND_DISPLAY_STYLE_TEXT","ShowLegendKey","legendDisplayStrategy","hideStyleOptions","legendEnabled","setLegendEnabled","FieldSet","UiCoreLegend","LegendDisplayStrategy","_defineProperty","obj","defineProperty","enumerable","configurable","writable","OperatorSelect","inputMaxWidth","ValueInput","MeasureCriteria","Component","super","defaultState","op1","v1","op2","v2","_op","_v","_op2","_v2","render","paddingTop","onClear","measureCriteria","getOptionsByType","getDataTab","getDisplayTemplate","Children","toArray","getTotalsTemplate","getEmptyDataTemplate","Legend","getStyleTab","dialogIsOpen","setDialogIsOpen","optionsConfig","VisualizationOptions","InterpretationsButton","IconChevronRight24","IconChevronLeft24","visualizationSaveMutation","skipTranslations","skipSharing","visualizationSaveAsMutation","setCurrent","setVisualization","apiObjectName","d2","useD2","show","showAlert","useAlert","details","copy","visualizationType","Date","toLocaleDateString","year","month","day","postVisualization","putVisualization","onSaveComplete","res","uid","historyEntry","isSaving","errorCode","statusCode","httpStatusCode","menuBar","updateButton","FileMenu","fileType","fileObject","onOpen","isOpening","onNew","isResetting","onRename","updatedVisualization","updatedCurrent","success","duration","onSaveAs","onDelete","deletedVisualization","deletedObject","VisualizationOptionsManager","flexGrow","ArrowDown","ListItemIcon","VisualizationTypeListItem","isSelected","listItem","listItemActive","listItemDisabled","listItemIcon","listItemText","listItemName","listItemDescription","listIsOpen","setListIsOpen","renderVisualizationTypeListItem","isDisabled","VisTypesList","listContainer","listSection","createRef","arrowIcon","cardContainer","sectionToolbar","flexCt","VisualizationTypeSelector","toolbarMenubar","flexGrow1","MenuBar","mostViewedVisualizationsQuery","mostViewedVisualizations","eventType","getErrorContent","errorContainer","errorIcon","errorTitle","errorDescription","inner","guide","guideItem","visualizationQuery","eventVisualization","dataStatisticsMutation","favorite","addSettings","extraSettings","onSuccess","fetchedSettings","fetchSystemSettings","systemSettings","apiFetchSystemSettings","fetchOrgUnitRoots","apiFetchOrganisationUnitRoots","orgUnitRoots","Promise","all","err","clearVisualization","clearCurrent","clearUi","setInitMetadata","USER_ORG_UNIT","USER_ORG_UNIT_CHILDREN","USER_ORG_UNIT_GRANDCHILDREN","getDimensionById","setUser","setUiFromVisualization","setVisualizationLoading","isLoading","initialLocation","userSettings","previousLocation","setPreviousLocation","initialLoadIsComplete","setInitialLoadIsComplete","postDataStatistics","loadVisualization","isExisting","pathParts","parseLocation","needsRefetch","onMount","unlisten","_location$state3","_location$state4","_location$state5","isValidLocationChange","transformVisualization","eventReportsApp","flexDirCol","sectionMain","DndContext","mainCenter","flexBasis0","mainCenterLayout","mainCenterTitlebar","TitleBar","mainCenterCanvas","loadingCover","itemsMetadata","dimensionItemType","StartScreen","mainRight","DetailsPanel","CssVariables","userSettingsQuery","UserSettingsCtx","createContext","UserSettingsProvider","setSettings","keyAnalysisDisplayProperty","keyUiLocale","rest","displayProperty","fetchData","Provider","combineReducers","getDefaultFromUi","transfers","newLayout","currentState","layoutGetDimensionIdItemIdsObject","getUiFromVisualization","rootOrgUnitIds","root","getPreselectedUi","repetition","d2Object","has","configureStore","middleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","applyMiddleware","next","meta","addResources","enTranslations","AppWrapper","store","thunk","withExtraArgument","metadataMiddleware","Cypress","ouLevels","setOuLevels","doFetchOuLevelsData","apiFetchOrganisationUnitLevels","ouLevelsData","d2Config","schemas","ReduxProvider","Consumer","D2Shim","i18nRoot","locale","App"],"mappings":"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","file":"static/js/app.e29f73bc.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"outer\":\"StartScreen_outer__2nbkE\",\"inner\":\"StartScreen_inner__2exeL\",\"errorContainer\":\"StartScreen_errorContainer__u2dgL\",\"errorIcon\":\"StartScreen_errorIcon__1QTyz\",\"errorTitle\":\"StartScreen_errorTitle__2Ksw9\",\"errorDescription\":\"StartScreen_errorDescription__syq9m\",\"title\":\"StartScreen_title__2-0vP\",\"section\":\"StartScreen_section__3ITr1\",\"guide\":\"StartScreen_guide__d793i\",\"guideItem\":\"StartScreen_guideItem__13mvT\",\"visualization\":\"StartScreen_visualization__3FqSm\",\"visIcon\":\"StartScreen_visIcon__2SFAA\"};","import PropTypes from 'prop-types';\nimport React from 'react';\n\nconst PivotTableIcon = ({\n  style = {\n    paddingRight: '8px',\n    width: 24,\n    height: 24\n  }\n}) => /*#__PURE__*/React.createElement(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  viewBox: \"0,0,48,48\",\n  style: style\n}, /*#__PURE__*/React.createElement(\"g\", {\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"polygon\", {\n  points: \"0 0 48 0 48 48 0 48\"\n}), /*#__PURE__*/React.createElement(\"rect\", {\n  width: \"34\",\n  height: \"26\",\n  x: \"7\",\n  y: \"11\",\n  stroke: \"#4A5768\",\n  strokeWidth: \"2\"\n}), /*#__PURE__*/React.createElement(\"rect\", {\n  width: \"32\",\n  height: \"2\",\n  x: \"8\",\n  y: \"18\",\n  fill: \"#4A5768\"\n}), /*#__PURE__*/React.createElement(\"rect\", {\n  width: \"2\",\n  height: \"26\",\n  x: \"19\",\n  y: \"11\",\n  fill: \"#4A5768\"\n}), /*#__PURE__*/React.createElement(\"rect\", {\n  width: \"32\",\n  height: \"2\",\n  x: \"8\",\n  y: \"24\",\n  fill: \"#4A5768\"\n}), /*#__PURE__*/React.createElement(\"rect\", {\n  width: \"32\",\n  height: \"2\",\n  x: \"8\",\n  y: \"30\",\n  fill: \"#4A5768\"\n})));\n\nPivotTableIcon.propTypes = {\n  style: PropTypes.object\n};\nexport default PivotTableIcon;","export const SET_VISUALIZATION = 'SET_VISUALIZATION';\nexport const CLEAR_VISUALIZATION = 'CLEAR_VISUALIZATION';\nexport const DEFAULT_VISUALIZATION = null;\nexport default ((state = DEFAULT_VISUALIZATION, action) => {\n  switch (action.type) {\n    case SET_VISUALIZATION:\n      {\n        return action.value;\n      }\n\n    case CLEAR_VISUALIZATION:\n      {\n        return DEFAULT_VISUALIZATION;\n      }\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetVisualization = state => state.visualization;\nexport const sGetInterpretations = state => state.visualization ? state.visualization.interpretations : [];","import pick from 'lodash-es/pick';\nexport const OPTION_LEGEND_DISPLAY_STRATEGY = 'legendDisplayStrategy';\nexport const OPTION_LEGEND_DISPLAY_STYLE = 'legendDisplayStyle';\nexport const OPTION_LEGEND_SET = 'legendSet';\nexport const OPTION_SHOW_LEGEND_KEY = 'showLegendKey';\nexport const DISPLAY_DENSITY_COMFORTABLE = 'COMFORTABLE';\nexport const DISPLAY_DENSITY_NORMAL = 'NORMAL';\nexport const DISPLAY_DENSITY_COMPACT = 'COMPACT';\nexport const FONT_SIZE_LARGE = 'LARGE';\nexport const FONT_SIZE_NORMAL = 'NORMAL';\nexport const FONT_SIZE_SMALL = 'SMALL';\nexport const options = {\n  /*\n  TODO: PIVOT TABLE OPTIONS:\n  showHierarchy: { defaultValue: false, requestable: true, savable: true },\n  showDimensionLabels: {\n      defaultValue: false,\n      requestable: false,\n      savable: true,\n  },\n  colTotals: { defaultValue: false, requestable: false, savable: true },\n  colSubTotals: { defaultValue: false, requestable: false, savable: true },\n  rowTotals: { defaultValue: false, requestable: false, savable: true },\n  rowSubTotals: { defaultValue: false, requestable: false, savable: true },\n  // FIXME: hideEmptyRowItems or hideEmptyRows ??\n  hideEmptyRowItems: {\n      defaultValue: 'NONE',\n      requestable: false,\n      savable: true,\n  },\n  hideEmptyRows: { defaultValue: false, requestable: false, savable: true },\n  // TODO: Hide n/a data\n  legend: {\n      defaultValue: {},\n      requestable: false,\n      savable: true,\n  },\n  title: { defaultValue: undefined, requestable: false, savable: true },*/\n  completedOnly: {\n    defaultValue: false,\n    requestable: true,\n    savable: true\n  },\n  displayDensity: {\n    defaultValue: DISPLAY_DENSITY_NORMAL,\n    requestable: false,\n    savable: true\n  },\n  fontSize: {\n    defaultValue: FONT_SIZE_NORMAL,\n    requestable: false,\n    savable: true\n  },\n  digitGroupSeparator: {\n    defaultValue: 'SPACE',\n    requestable: false,\n    savable: true\n  } // TODO: Limit the number of rows shown in the table\n  // TODO: Only show the [top/bottom] x rows\n\n};\nexport default options;\nexport const getOptionsForUi = () => {\n  return Object.entries({ ...options\n  }).reduce((map, [option, props]) => {\n    map[option] = props.defaultValue;\n    return map;\n  }, {});\n};\nexport const getOptionsFromVisualization = visualization => {\n  const optionsFromVisualization = { ...getOptionsForUi(),\n    ...pick(visualization, Object.keys(options))\n  };\n  return optionsFromVisualization;\n};","import { AXIS_ID_COLUMNS, AXIS_ID_ROWS, AXIS_ID_FILTERS, DIMENSION_ID_PERIOD } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport PivotTableIcon from '../assets/PivotTableIcon.js';\nimport { DEFAULT_CURRENT } from '../reducers/current.js';\nimport { DEFAULT_VISUALIZATION } from '../reducers/visualization.js';\nimport { default as options } from './options.js';\nexport const DIMENSION_TYPE_ALL = 'ALL';\nexport const DIMENSION_TYPE_DATA_ELEMENT = 'DATA_ELEMENT';\nexport const DIMENSION_TYPE_PROGRAM_ATTRIBUTE = 'PROGRAM_ATTRIBUTE';\nexport const DIMENSION_TYPE_PROGRAM_INDICATOR = 'PROGRAM_INDICATOR';\nexport const VIS_TYPE_PIVOT_TABLE = 'PIVOT_TABLE';\nexport const VIS_TYPE_LINE_LIST = 'LINE_LIST';\nexport const OUTPUT_TYPE_EVENT = 'EVENT';\nexport const OUTPUT_TYPE_ENROLLMENT = 'ENROLLMENT';\nexport const TIME_DIMENSION_EVENT_DATE = 'eventDate';\nexport const TIME_DIMENSION_ENROLLMENT_DATE = 'enrollmentDate';\nexport const TIME_DIMENSION_INCIDENT_DATE = 'incidentDate';\nexport const TIME_DIMENSION_SCHEDULED_DATE = 'scheduledDate';\nexport const TIME_DIMENSION_LAST_UPDATED = 'lastUpdated';\nexport const headersMap = {\n  ou: 'ouname',\n  programStatus: 'programstatus',\n  eventStatus: 'eventstatus',\n  storedBy: 'storedby',\n  lastUpdatedBy: 'lastupdatedby',\n  [TIME_DIMENSION_EVENT_DATE]: 'eventdate',\n  [TIME_DIMENSION_ENROLLMENT_DATE]: 'enrollmentdate',\n  [TIME_DIMENSION_INCIDENT_DATE]: 'incidentdate',\n  [TIME_DIMENSION_SCHEDULED_DATE]: 'scheduleddate',\n  [TIME_DIMENSION_LAST_UPDATED]: 'lastupdated'\n};\nexport const visTypeMap = {\n  [VIS_TYPE_LINE_LIST]: {\n    name: i18n.t('Line list'),\n    description: 'TEXT description for Line list',\n    icon: PivotTableIcon,\n    disabled: false\n  },\n  [VIS_TYPE_PIVOT_TABLE]: {\n    name: i18n.t('Pivot table'),\n    description: 'TEXT description for Pivot table',\n    icon: PivotTableIcon,\n    disabled: true,\n    disabledText: i18n.t('Pivot tables are not supported by this app yet')\n  }\n};\nexport const outputTypeMap = {\n  [OUTPUT_TYPE_EVENT]: {\n    name: i18n.t('Event'),\n    description: i18n.t('Events are single registrations or incidents in a program')\n  },\n  [OUTPUT_TYPE_ENROLLMENT]: {\n    name: i18n.t('Enrollment'),\n    description: i18n.t('Programs track enrollments across time')\n  }\n};\nexport const transformVisualization = visualization => ({ ...visualization,\n  [AXIS_ID_COLUMNS]: visualization[AXIS_ID_COLUMNS].map(dimensionObj => transformDimension(dimensionObj, visualization.outputType)),\n  [AXIS_ID_ROWS]: visualization[AXIS_ID_ROWS].map(dimensionObj => transformDimension(dimensionObj, visualization.outputType)),\n  [AXIS_ID_FILTERS]: visualization[AXIS_ID_FILTERS].map(dimensionObj => transformDimension(dimensionObj, visualization.outputType))\n});\n\nconst transformDimension = (dimensionObj, outputType) => {\n  // TODO waiting for the time dimensions work to be completed.\n  // most likely there are going to be constants for these time dimensions\n  const timeDimensionMap = {\n    [OUTPUT_TYPE_EVENT]: TIME_DIMENSION_EVENT_DATE,\n    [OUTPUT_TYPE_ENROLLMENT]: TIME_DIMENSION_ENROLLMENT_DATE\n  };\n\n  if (dimensionObj.dimensionType === 'PROGRAM_DATA_ELEMENT') {\n    return { ...dimensionObj,\n      dimensionType: DIMENSION_TYPE_DATA_ELEMENT\n    };\n  } else if (dimensionObj.dimension === DIMENSION_ID_PERIOD) {\n    return { ...dimensionObj,\n      dimension: timeDimensionMap[outputType]\n    };\n  } else {\n    return dimensionObj;\n  }\n};\n\nexport const getVisualizationFromCurrent = current => {\n  const visualization = Object.assign({}, current);\n  const nonSavableOptions = Object.keys(options).filter(option => !options[option].savable);\n  nonSavableOptions.forEach(option => delete visualization[option]);\n  return visualization;\n};\nexport const getVisualizationState = (visualization, current) => {\n  if (current === DEFAULT_CURRENT) {\n    return STATE_EMPTY;\n  } else if (visualization === DEFAULT_VISUALIZATION) {\n    return STATE_UNSAVED;\n  } else if (current === visualization) {\n    return STATE_SAVED;\n  } else {\n    return STATE_DIRTY;\n  }\n};\nexport const STATE_EMPTY = 'EMPTY';\nexport const STATE_SAVED = 'SAVED';\nexport const STATE_UNSAVED = 'UNSAVED';\nexport const STATE_DIRTY = 'DIRTY';","import { AXIS_ID_COLUMNS, AXIS_ID_FILTERS, AXIS_ID_ROWS } from '@dhis2/analytics';\nimport { VIS_TYPE_LINE_LIST, VIS_TYPE_PIVOT_TABLE } from './visualization.js'; // Names for dnd sources\n\nexport const SOURCE_DIMENSIONS = 'dimensions'; // Exclude one or many dimensions from layout\n\nexport const getFilteredLayout = (layout, excludedIds) => {\n  var _layout$AXIS_ID_COLUM, _layout$AXIS_ID_ROWS, _layout$AXIS_ID_FILTE;\n\n  const ids = Array.isArray(excludedIds) ? excludedIds : [excludedIds];\n  return {\n    [AXIS_ID_COLUMNS]: ((_layout$AXIS_ID_COLUM = layout[AXIS_ID_COLUMNS]) === null || _layout$AXIS_ID_COLUM === void 0 ? void 0 : _layout$AXIS_ID_COLUM.filter(dim => !ids.includes(dim))) || [],\n    [AXIS_ID_ROWS]: ((_layout$AXIS_ID_ROWS = layout[AXIS_ID_ROWS]) === null || _layout$AXIS_ID_ROWS === void 0 ? void 0 : _layout$AXIS_ID_ROWS.filter(dim => !ids.includes(dim))) || [],\n    [AXIS_ID_FILTERS]: ((_layout$AXIS_ID_FILTE = layout[AXIS_ID_FILTERS]) === null || _layout$AXIS_ID_FILTE === void 0 ? void 0 : _layout$AXIS_ID_FILTE.filter(dim => !ids.includes(dim))) || []\n  };\n};\nexport const LAYOUT_TYPE_LINE_LIST = 'LAYOUT_TYPE_LINE_LIST';\nexport const LAYOUT_TYPE_PIVOT_TABLE = 'LAYOUT_TYPE_PIVOT_TABLE';\nexport const getAdaptedUiLayoutByType = (layout, type) => {\n  switch (type) {\n    case VIS_TYPE_LINE_LIST:\n      {\n        return getLineListLayout(layout);\n      }\n\n    case VIS_TYPE_PIVOT_TABLE:\n    default:\n      return layout;\n  }\n}; // Transform from ui.layout to line list layout format\n\nconst getLineListLayout = layout => {\n  const columns = layout[AXIS_ID_COLUMNS].slice();\n  const rows = layout[AXIS_ID_ROWS].slice();\n  return {\n    [AXIS_ID_COLUMNS]: [...columns, ...rows],\n    [AXIS_ID_ROWS]: [],\n    [AXIS_ID_FILTERS]: [...layout[AXIS_ID_FILTERS]]\n  };\n}; // Accepts layout: { columns: ['dx'] }\n// Returns inverse layout: { dx: 'columns' }\n\n\nexport const getInverseLayout = layout => {\n  const entries = Object.entries(layout);\n  const map = {};\n  entries.forEach(([axisId, dimensionIds]) => {\n    dimensionIds.forEach(id => {\n      map[id] = axisId;\n    });\n  });\n  return map;\n};","import { dimensionCreate } from '@dhis2/analytics';\nimport pick from 'lodash-es/pick';\nimport { BASE_FIELD_TYPE } from './fields.js';\nimport { getAdaptedUiLayoutByType } from './layout.js';\nimport { options } from './options.js';\nimport { VIS_TYPE_LINE_LIST } from './visualization.js';\nexport const getDefaultFromUi = (current, action) => {\n  const ui = { ...action.value,\n    layout: { ...getAdaptedUiLayoutByType(action.value.layout, VIS_TYPE_LINE_LIST)\n    },\n    itemsByDimension: getItemsByDimensionFromUi(action.value)\n  };\n  return { ...current,\n    [BASE_FIELD_TYPE]: ui.type,\n    outputType: ui.input.type,\n    ...getProgramFromUi(ui),\n    ...getProgramStageFromUi(ui),\n    ...getAxesFromUi(ui),\n    ...getOptionsFromUi(ui)\n  };\n};\nexport const getProgramFromUi = ui => {\n  var _ui$program;\n\n  return ((_ui$program = ui.program) === null || _ui$program === void 0 ? void 0 : _ui$program.id) && {\n    program: {\n      id: ui.program.id\n    }\n  };\n};\nexport const getProgramStageFromUi = ui => {\n  var _ui$program2;\n\n  return ((_ui$program2 = ui.program) === null || _ui$program2 === void 0 ? void 0 : _ui$program2.stage) && {\n    programStage: {\n      id: ui.program.stage\n    }\n  };\n};\nexport const getOptionsFromUi = ui => pick(ui.options, Object.keys(options));\nexport const getAxesFromUi = ui => Object.entries(ui.layout).reduce((layout, [axisId, dimensionIds]) => ({ ...layout,\n  [axisId]: dimensionIds.map(dimensionId => {\n    var _ui$conditions$dimens, _ui$conditions$dimens2;\n\n    return dimensionCreate(dimensionId, ui.itemsByDimension[dimensionId], {\n      filter: (_ui$conditions$dimens = ui.conditions[dimensionId]) === null || _ui$conditions$dimens === void 0 ? void 0 : _ui$conditions$dimens.condition,\n      ...(((_ui$conditions$dimens2 = ui.conditions[dimensionId]) === null || _ui$conditions$dimens2 === void 0 ? void 0 : _ui$conditions$dimens2.legendSet) && {\n        legendSet: {\n          id: ui.conditions[dimensionId].legendSet\n        }\n      })\n    });\n  }).filter(dim => dim !== null)\n}), {});\nexport const getItemsByDimensionFromUi = ui => {\n  const result = {};\n  Object.keys(ui.itemsByDimension).forEach(key => result[key] = ui.itemsByDimension[key]);\n  return result;\n};","import { getDefaultFromUi } from '../modules/current.js';\nexport const SET_CURRENT = 'SET_CURRENT';\nexport const SET_CURRENT_FROM_UI = 'SET_CURRENT_FROM_UI';\nexport const CLEAR_CURRENT = 'CLEAR_CURRENT';\nexport const DEFAULT_CURRENT = null;\nexport default ((state = DEFAULT_CURRENT, action) => {\n  switch (action.type) {\n    case SET_CURRENT:\n      {\n        return action.value;\n      }\n\n    case SET_CURRENT_FROM_UI:\n      {\n        switch (action.value.type) {\n          default:\n            {\n              return getDefaultFromUi(state, action);\n            }\n        }\n      }\n\n    case CLEAR_CURRENT:\n      return DEFAULT_CURRENT;\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetCurrent = state => state.current;\nexport const sGetCurrentId = state => {\n  var _state$current;\n\n  return (_state$current = state.current) === null || _state$current === void 0 ? void 0 : _state$current.id;\n};","export const removeLastPathSegment = path => {\n  // if root path, then return unprocessed path\n  if (path.match(/\\//g).length === 1) {\n    return path;\n  }\n\n  return path.substr(0, path.lastIndexOf('/'));\n};\nexport const getOuPath = (id, metadata, parentGraphMap) => {\n  if (metadata[id] && metadata[id].path) {\n    return metadata[id].path;\n  } // for root org units\n\n\n  if (parentGraphMap[id] === id || parentGraphMap[id] === '') {\n    return `/${id}`;\n  }\n\n  return parentGraphMap[id] ? `/${parentGraphMap[id]}/${id}` : undefined;\n};","export const getProgramFromVisualisation = vis => {\n  var _vis$program, _vis$programStage;\n\n  return {\n    id: (_vis$program = vis.program) === null || _vis$program === void 0 ? void 0 : _vis$program.id,\n    stage: (_vis$programStage = vis.programStage) === null || _vis$programStage === void 0 ? void 0 : _vis$programStage.id\n  };\n};","import { DIMENSION_ID_ORGUNIT, layoutGetAxisIdDimensionIdsObject, layoutGetDimensionIdItemIdsObject } from '@dhis2/analytics';\nimport isObject from 'lodash-es/isObject';\nimport { getAdaptedUiLayoutByType, getInverseLayout } from './layout.js';\nimport { getOptionsFromVisualization } from './options.js';\nimport { removeLastPathSegment } from './orgUnit.js';\nimport { getProgramFromVisualisation } from './program.js';\nimport { VIS_TYPE_LINE_LIST, VIS_TYPE_PIVOT_TABLE } from './visualization.js';\n\nconst lineListUiAdapter = ui => ({ ...ui,\n  layout: getAdaptedUiLayoutByType(ui.layout, VIS_TYPE_LINE_LIST)\n});\n\nexport const getAdaptedUiByType = ui => {\n  switch (ui.type) {\n    case VIS_TYPE_LINE_LIST:\n      return lineListUiAdapter(ui);\n\n    case VIS_TYPE_PIVOT_TABLE:\n    default:\n      return ui;\n  }\n};\nexport const getUiFromVisualization = (vis, currentState = {}) => ({ ...currentState,\n  program: getProgramFromVisualisation(vis),\n  options: getOptionsFromVisualization(vis),\n  layout: layoutGetAxisIdDimensionIdsObject(vis),\n  itemsByDimension: layoutGetDimensionIdItemIdsObject(vis),\n  conditions: getConditionsFromVisualization(vis),\n  parentGraphMap: vis.parentGraphMap || getParentGraphMapFromVisualization(vis) || currentState.parentGraphMap\n});\nexport const getParentGraphMapFromVisualization = vis => {\n  const dimensionIdsByAxis = layoutGetAxisIdDimensionIdsObject(vis);\n  const inverseLayout = getInverseLayout(dimensionIdsByAxis);\n  const ouAxis = inverseLayout[DIMENSION_ID_ORGUNIT];\n\n  if (!ouAxis) {\n    return {};\n  }\n\n  const parentGraphMap = {};\n  const ouDimension = vis[ouAxis].find(dimension => dimension.dimension === DIMENSION_ID_ORGUNIT);\n  ouDimension.items.filter(orgUnit => orgUnit.path).forEach(orgUnit => {\n    if ('/' + orgUnit.id === orgUnit.path) {\n      // root org unit case\n      parentGraphMap[orgUnit.id] = '';\n    } else {\n      const path = removeLastPathSegment(orgUnit.path);\n      parentGraphMap[orgUnit.id] = path[0] === '/' ? path.substr(1) : path;\n    }\n  });\n  return parentGraphMap;\n};\n\nconst getConditionsFromVisualization = vis => [...vis.columns, ...vis.rows, ...vis.filters].filter(item => item.filter || item.legendSet).reduce((acc, key) => {\n  var _key$legendSet;\n\n  return { ...acc,\n    [key.dimension]: {\n      condition: key.filter,\n      legendSet: (_key$legendSet = key.legendSet) === null || _key$legendSet === void 0 ? void 0 : _key$legendSet.id\n    }\n  };\n}, {}); // Repetition\n\n\nexport const PROP_MOST_RECENT = 'mostRecent';\nexport const PROP_OLDEST = 'oldest';\nexport const getDefaultCurrentRepetition = () => [0];\nexport const getDefaultUiRepetition = () => ({\n  [PROP_MOST_RECENT]: 1,\n  [PROP_OLDEST]: 0\n});\nexport const PARSE_CURRENT_REPETITION_ERROR = 'parseCurrentRepetition: Invalid input';\nexport const PARSE_UI_REPETITION_ERROR = 'parseUiRepetition: Invalid input';\nexport const parseCurrentRepetition = repetition => {\n  if (!(Array.isArray(repetition) && repetition.length && repetition.every(i => typeof i === 'number'))) {\n    throw new Error(PARSE_CURRENT_REPETITION_ERROR);\n  }\n\n  return {\n    [PROP_MOST_RECENT]: repetition.filter(n => n < 1).length,\n    [PROP_OLDEST]: repetition.filter(n => n > 0).length\n  };\n};\nexport const parseUiRepetition = repetition => {\n  if (!(isObject(repetition) && typeof repetition[PROP_MOST_RECENT] === 'number' && repetition[PROP_MOST_RECENT] >= 0 && typeof repetition[PROP_OLDEST] === 'number' && repetition[PROP_OLDEST] >= 0)) {\n    throw new Error(PARSE_UI_REPETITION_ERROR);\n  }\n\n  if (repetition[PROP_MOST_RECENT] === 0 && repetition[PROP_OLDEST] === 0) {\n    return getDefaultCurrentRepetition();\n  }\n\n  return [...new Array(repetition[PROP_OLDEST]).fill().map((_, i) => i + 1), ...new Array(repetition[PROP_MOST_RECENT]).fill().map((_, i) => -i + 0).sort((a, b) => a - b)];\n};","/*eslint no-unused-vars: [\"error\", { \"ignoreRestSiblings\": true }]*/\nimport { DIMENSION_ID_ORGUNIT, USER_ORG_UNIT } from '@dhis2/analytics';\nimport { getFilteredLayout } from '../modules/layout.js';\nimport { getOptionsForUi } from '../modules/options.js';\nimport { getAdaptedUiByType, getUiFromVisualization } from '../modules/ui.js';\nimport { OUTPUT_TYPE_EVENT, VIS_TYPE_LINE_LIST } from '../modules/visualization.js';\nexport const SET_UI_INPUT = 'SET_UI_INPUT';\nexport const CLEAR_UI_PROGRAM = 'CLEAR_UI_PROGRAM';\nexport const UPDATE_UI_PROGRAM_ID = 'UPDATE_UI_PROGRAM_ID';\nexport const UPDATE_UI_PROGRAM_STAGE = 'UPDATE_UI_PROGRAM_STAGE';\nexport const SET_UI_OPTIONS = 'SET_UI_OPTIONS';\nexport const SET_UI_OPTION = 'SET_UI_OPTION';\nexport const ADD_UI_LAYOUT_DIMENSIONS = 'ADD_UI_LAYOUT_DIMENSIONS';\nexport const REMOVE_UI_LAYOUT_DIMENSIONS = 'REMOVE_UI_LAYOUT_DIMENSIONS';\nexport const SET_UI_LAYOUT = 'SET_UI_LAYOUT';\nexport const SET_UI_FROM_VISUALIZATION = 'SET_UI_FROM_VISUALIZATION';\nexport const CLEAR_UI = 'CLEAR_UI';\nexport const SET_UI_DETAILS_PANEL_OPEN = 'SET_UI_DETAILS_PANEL_OPEN';\nexport const SET_UI_ACCESSORY_PANEL_OPEN = 'SET_UI_ACCESSORY_PANEL_OPEN';\nexport const SET_UI_EXPANDED_LAYOUT_PANEL = 'SET_UI_EXPANDED_LAYOUT_PANEL';\nexport const SET_UI_ACTIVE_MODAL_DIALOG = 'SET_UI_ACTIVE_MODAL_DIALOG';\nexport const SET_UI_ITEMS = 'SET_UI_ITEMS';\nexport const ADD_UI_PARENT_GRAPH_MAP = 'ADD_UI_PARENT_GRAPH_MAP';\nexport const SET_UI_CONDITIONS = 'SET_UI_CONDITIONS';\nexport const SET_UI_REPETITION = 'SET_UI_REPETITION';\nconst EMPTY_UI = {\n  type: VIS_TYPE_LINE_LIST,\n  input: {\n    type: OUTPUT_TYPE_EVENT\n  },\n  program: {},\n  layout: {\n    columns: [],\n    filters: []\n  },\n  itemsByDimension: {},\n  options: {},\n  parentGraphMap: {},\n  repetitionByDimension: {}\n};\nexport const DEFAULT_UI = {\n  type: VIS_TYPE_LINE_LIST,\n  input: {\n    type: OUTPUT_TYPE_EVENT\n  },\n  program: {},\n  layout: {\n    // TODO: Populate the layout with the correct default dimensions, these are just temporary for testing\n    columns: [DIMENSION_ID_ORGUNIT],\n    filters: []\n  },\n  itemsByDimension: {\n    [DIMENSION_ID_ORGUNIT]: []\n  },\n  options: getOptionsForUi(),\n  showAccessoryPanel: false,\n  showDetailsPanel: false,\n  showExpandedLayoutPanel: false,\n  activeModalDialog: null,\n  parentGraphMap: {},\n  repetitionByDimension: {}\n};\n\nconst getPreselectedUi = options => {\n  const rootOrgUnitIds = options.rootOrgUnits.filter(root => root.id).map(root => root.id);\n  const parentGraphMap = { ...DEFAULT_UI.parentGraphMap\n  };\n  rootOrgUnitIds.forEach(id => {\n    parentGraphMap[id] = '';\n  });\n  return { ...DEFAULT_UI,\n    options: { ...DEFAULT_UI.options //digitGroupSeparator,\n\n    },\n    itemsByDimension: { ...DEFAULT_UI.itemsByDimension,\n      [DIMENSION_ID_ORGUNIT]: [USER_ORG_UNIT]\n    },\n    parentGraphMap\n  };\n};\n\nexport default ((state = EMPTY_UI, action) => {\n  switch (action.type) {\n    case SET_UI_INPUT:\n      {\n        return { ...state,\n          input: action.value\n        };\n      }\n\n    case CLEAR_UI_PROGRAM:\n      {\n        return { ...state,\n          program: EMPTY_UI.program\n        };\n      }\n\n    case UPDATE_UI_PROGRAM_ID:\n      {\n        return { ...state,\n          program: { ...state.program,\n            id: action.value\n          }\n        };\n      }\n\n    case UPDATE_UI_PROGRAM_STAGE:\n      {\n        return { ...state,\n          program: { ...state.program,\n            stage: action.value\n          }\n        };\n      }\n\n    case SET_UI_OPTIONS:\n      {\n        return { ...state,\n          options: { ...state.options,\n            ...action.value\n          }\n        };\n      }\n    // action.value: transfer object (dimensionId:axisId) saying what to add where: { ou: 'rows' }\n    // Reducer takes care of swapping (retransfer) if dimension already exists in layout\n\n    case ADD_UI_LAYOUT_DIMENSIONS:\n      {\n        const transfers = { ...action.value\n        };\n        let newLayout = state.layout; // Add dimension ids to destination (axisId === null means remove from layout)\n\n        Object.entries(transfers).forEach(([dimensionId, {\n          axisId,\n          index\n        }]) => {\n          if (newLayout[axisId]) {\n            // Filter out transferred dimension id (remove from source)\n            newLayout = getFilteredLayout(newLayout, [dimensionId]);\n\n            if (index === null || index === undefined) {\n              newLayout[axisId].push(dimensionId);\n            } else {\n              newLayout[axisId].splice(index, 0, dimensionId);\n            }\n          }\n        });\n        return { ...state,\n          layout: newLayout\n        };\n      }\n\n    case REMOVE_UI_LAYOUT_DIMENSIONS:\n      {\n        return { ...state,\n          layout: getFilteredLayout(state.layout, action.value)\n        };\n      }\n\n    case SET_UI_FROM_VISUALIZATION:\n      {\n        return getAdaptedUiByType(getUiFromVisualization(action.value, state));\n      }\n\n    case SET_UI_LAYOUT:\n      {\n        return { ...state,\n          layout: { ...action.value\n          }\n        };\n      }\n\n    case SET_UI_DETAILS_PANEL_OPEN:\n      {\n        return { ...state,\n          showDetailsPanel: action.value,\n\n          /*\n           * Always close left sidebar when opening the right sidebar\n           * Leave left sidebar unaffected when closing the right sidebar\n           */\n          showAccessoryPanel: action.value ? false : state.showAccessoryPanel\n        };\n      }\n\n    case SET_UI_ACCESSORY_PANEL_OPEN:\n      {\n        return { ...state,\n          showAccessoryPanel: action.value,\n\n          /*\n           * Always close right sidebar when opening the left sidebar\n           * Leave right sidebar unaffected when closing the left sidebar\n           */\n          showDetailsPanel: action.value ? false : state.showDetailsPanel\n        };\n      }\n\n    case SET_UI_EXPANDED_LAYOUT_PANEL:\n      {\n        return { ...state,\n          showExpandedLayoutPanel: action.value\n        };\n      }\n\n    case CLEAR_UI:\n      {\n        return getPreselectedUi(action.value);\n      }\n\n    case SET_UI_ACTIVE_MODAL_DIALOG:\n      {\n        return { ...state,\n          activeModalDialog: action.value || DEFAULT_UI.activeModalDialog\n        };\n      }\n\n    case SET_UI_ITEMS:\n      {\n        const {\n          dimensionId,\n          itemIds\n        } = action.value;\n        return { ...state,\n          itemsByDimension: { ...state.itemsByDimension,\n            [dimensionId]: itemIds\n          }\n        };\n      }\n\n    case ADD_UI_PARENT_GRAPH_MAP:\n      {\n        return { ...state,\n          parentGraphMap: { ...state.parentGraphMap,\n            ...action.value\n          }\n        };\n      }\n\n    case SET_UI_CONDITIONS:\n      {\n        const {\n          dimension,\n          inputCondition,\n          legendSet\n        } = action.value;\n        return { ...state,\n          conditions: { ...state.conditions,\n            [dimension]: inputCondition.length || legendSet ? {\n              condition: inputCondition,\n              legendSet\n            } : undefined\n          }\n        };\n      }\n\n    case SET_UI_REPETITION:\n      {\n        const {\n          dimensionId,\n          repetition\n        } = action.value;\n        return { ...state,\n          repetitionByDimension: { ...state.repetitionByDimension,\n            [dimensionId]: repetition\n          }\n        };\n      }\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetUi = state => state.ui;\nexport const sGetUiInput = state => sGetUi(state).input;\nexport const sGetUiProgram = state => sGetUi(state).program;\nexport const sGetUiOptions = state => sGetUi(state).options;\nexport const sGetUiOption = () => {}; // TODO: items stored here should be flattened and reintegrated into sGetUiOptions (above)\n\nexport const sGetUiItems = state => sGetUi(state).itemsByDimension;\nexport const sGetUiLayout = state => sGetUi(state).layout;\nexport const sGetUiShowDetailsPanel = state => sGetUi(state).showDetailsPanel;\nexport const sGetUiShowAccessoryPanel = state => sGetUi(state).showAccessoryPanel;\nexport const sGetUiShowExpandedLayoutPanel = state => sGetUi(state).showExpandedLayoutPanel;\nexport const sGetUiType = state => sGetUi(state).type;\nexport const sGetUiActiveModalDialog = state => sGetUi(state).activeModalDialog;\nexport const sGetUiParentGraphMap = state => sGetUi(state).parentGraphMap;\nexport const sGetUiConditions = state => sGetUi(state).conditions || {};\nexport const sGetUiRepetition = state => sGetUi(state).repetitionByDimension; // Selectors level 2\n\nexport const sGetUiInputType = state => sGetUiInput(state).type;\nexport const sGetUiProgramId = state => sGetUiProgram(state).id;\nexport const sGetUiProgramStage = state => sGetUiProgram(state).stage;\nexport const sGetUiItemsByDimension = (state, dimension) => sGetUiItems(state)[dimension] || DEFAULT_UI.itemsByDimension[dimension];\nexport const sGetDimensionIdsFromLayout = state => Object.values(sGetUiLayout(state)).reduce((ids, axisDimensionIds) => ids.concat(axisDimensionIds), []);\nexport const sGetUiConditionsByDimension = (state, dimension) => sGetUiConditions(state)[dimension];\nexport const sGetUiRepetitionByDimension = (state, dimensionId) => sGetUiRepetition(state)[dimensionId];","import { SET_CURRENT, CLEAR_CURRENT, SET_CURRENT_FROM_UI } from '../reducers/current.js';\nimport { sGetUi } from '../reducers/ui.js';\nexport const acSetCurrent = value => ({\n  type: SET_CURRENT,\n  value\n});\nexport const acClearCurrent = () => ({\n  type: CLEAR_CURRENT\n});\nexport const acSetCurrentFromUi = value => ({\n  type: SET_CURRENT_FROM_UI,\n  value\n});\nexport const tSetCurrentFromUi = () => async (dispatch, getState) => {\n  dispatch(acSetCurrentFromUi(sGetUi(getState())));\n};","export const SET_LOAD_ERROR = 'SET_LOAD_ERROR';\nexport const CLEAR_LOAD_ERROR = 'CLEAR_LOAD_ERROR';\nexport const SET_VISUALIZATION_LOADING = 'SET_VISUALIZATION_LOADING';\nexport const DEFAULT_LOADING = {\n  loadingError: null,\n  isVisualizationLoading: true\n};\nexport default ((state = DEFAULT_LOADING, action) => {\n  switch (action.type) {\n    case SET_LOAD_ERROR:\n      {\n        return { ...state,\n          loadingError: action.value\n        };\n      }\n\n    case CLEAR_LOAD_ERROR:\n      return { ...state,\n        loadingError: DEFAULT_LOADING.loadingError\n      };\n\n    case SET_VISUALIZATION_LOADING:\n      return { ...state,\n        isVisualizationLoading: action.value\n      };\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetLoadError = state => state.loader.loadingError;\nexport const sGetIsVisualizationLoading = state => state.loader.isVisualizationLoading;","export const ADD_METADATA = 'ADD_METADATA';\nexport const DEFAULT_METADATA = {};\nexport default ((state = DEFAULT_METADATA, action) => {\n  switch (action.type) {\n    case ADD_METADATA:\n      {\n        const result = { ...state\n        };\n        Object.entries(action.value).forEach(([key, value]) => result[key] = { ...result[key],\n          ...value\n        });\n        return result;\n      }\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetMetadata = state => state.metadata;\nexport const sGetMetadataById = (state, id) => state.metadata[id];","// TODO: Remove unused settings props\nexport const ADD_SETTINGS = 'ADD_SETTINGS';\nexport const DEFAULT_SETTINGS = {\n  // keyDateFormat: 'yyyy-MM-dd',\n  // keyAnalysisRelativePeriod: 'LAST_12_MONTHS',\n  // keyAnalysisDigitGroupSeparator: 'SPACE',\n  // keyIgnoreAnalyticsApprovalYearThreshold: -1,\n  displayNameProperty: 'displayName',\n  // uiLocale: 'en',\n  rootOrgUnits: []\n};\nexport default ((state = DEFAULT_SETTINGS, action) => {\n  switch (action.type) {\n    case ADD_SETTINGS:\n      {\n        return { ...state,\n          ...action.value\n        };\n      }\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetSettings = state => state.settings;\nexport const sGetSettingsDisplayNameProperty = state => sGetSettings(state).displayNameProperty; // export const sGetSettingsDigitGroupSeparator = state =>\n//     sGetSettings(state).keyAnalysisDigitGroupSeparator\n\nexport const sGetRootOrgUnits = state => sGetSettings(state).rootOrgUnits; // export const sGetRelativePeriod = state =>\n//     sGetSettings(state).keyAnalysisRelativePeriod\n// export const sGetUiLocale = state => sGetSettings(state).uiLocale","import defaultMetadata from '../modules/metadata.js';\nimport { ADD_METADATA } from '../reducers/metadata.js';\nimport { sGetRootOrgUnits } from '../reducers/settings.js';\nexport const acAddMetadata = value => ({\n  type: ADD_METADATA,\n  value\n});\nexport const tSetInitMetadata = () => (dispatch, getState) => {\n  const metaData = { ...defaultMetadata()\n  };\n  const rootOrgUnits = sGetRootOrgUnits(getState());\n  rootOrgUnits.forEach(rootOrgUnit => {\n    if (rootOrgUnit.id) {\n      metaData[rootOrgUnit.id] = { ...rootOrgUnit,\n        path: `/${rootOrgUnit.id}`\n      };\n    }\n  });\n  dispatch(acAddMetadata(metaData));\n};","import { SYSTEM_SETTINGS } from '../modules/settings.js';\nconst systemSettingsQuery = {\n  resource: 'systemSettings',\n  params: {\n    key: SYSTEM_SETTINGS\n  }\n};\nexport const apiFetchSystemSettings = async dataEngine => {\n  const systemSettingsData = await dataEngine.query({\n    systemSettings: systemSettingsQuery\n  }, {});\n  return systemSettingsData.systemSettings;\n};","export const SYSTEM_SETTINGS = ['keyDateFormat', 'keyAnalysisRelativePeriod', 'keyAnalysisDigitGroupSeparator', 'keyIgnoreAnalyticsApprovalYearThreshold', 'keyHideBiMonthlyPeriods', 'keyHideDailyPeriods', 'keyHideMonthlyPeriods', 'keyHideWeeklyPeriods', 'keyHideBiWeeklyPeriods']; // TODO: Remove unused settings props","import { sGetRootOrgUnits } from '../reducers/settings.js';\nimport { ADD_UI_LAYOUT_DIMENSIONS, REMOVE_UI_LAYOUT_DIMENSIONS, SET_UI_LAYOUT, SET_UI_OPTION, SET_UI_OPTIONS, SET_UI_FROM_VISUALIZATION, CLEAR_UI, SET_UI_DETAILS_PANEL_OPEN, SET_UI_ACCESSORY_PANEL_OPEN, SET_UI_EXPANDED_LAYOUT_PANEL, SET_UI_ACTIVE_MODAL_DIALOG, SET_UI_ITEMS, ADD_UI_PARENT_GRAPH_MAP, SET_UI_CONDITIONS, SET_UI_REPETITION, SET_UI_INPUT, UPDATE_UI_PROGRAM_ID, UPDATE_UI_PROGRAM_STAGE, CLEAR_UI_PROGRAM } from '../reducers/ui.js';\nexport const acSetUiInput = value => ({\n  type: SET_UI_INPUT,\n  value\n});\nexport const acClearUiProgram = () => ({\n  type: CLEAR_UI_PROGRAM\n});\nexport const acUpdateUiProgramId = (value, metadata) => ({\n  type: UPDATE_UI_PROGRAM_ID,\n  value,\n  metadata\n});\nexport const acUpdateUiProgramStage = (value, metadata) => ({\n  type: UPDATE_UI_PROGRAM_STAGE,\n  value,\n  metadata\n});\nexport const tSetUiProgram = ({\n  programId,\n  stageId,\n  metadata\n}) => async dispatch => {\n  dispatch(acClearUiProgram());\n  programId && dispatch(acUpdateUiProgramId(programId, metadata));\n  stageId && dispatch(acUpdateUiProgramStage(stageId));\n};\nexport const acSetUiOptions = value => ({\n  type: SET_UI_OPTIONS,\n  value\n});\nexport const acSetUiOption = value => ({\n  type: SET_UI_OPTION,\n  value\n});\nexport const acAddUiLayoutDimensions = value => ({\n  type: ADD_UI_LAYOUT_DIMENSIONS,\n  value\n});\nexport const acRemoveUiLayoutDimensions = value => ({\n  type: REMOVE_UI_LAYOUT_DIMENSIONS,\n  value\n});\nexport const acSetUiLayout = value => ({\n  type: SET_UI_LAYOUT,\n  value\n});\nexport const acSetUiFromVisualization = value => ({\n  type: SET_UI_FROM_VISUALIZATION,\n  value\n});\nexport const acClearUi = value => ({\n  type: CLEAR_UI,\n  value\n});\nexport const acSetUiDetailsPanelOpen = value => ({\n  type: SET_UI_DETAILS_PANEL_OPEN,\n  value\n});\nexport const acSetUiAccessoryPanelOpen = value => ({\n  type: SET_UI_ACCESSORY_PANEL_OPEN,\n  value\n});\nexport const acSetShowExpandedLayoutPanel = value => ({\n  type: SET_UI_EXPANDED_LAYOUT_PANEL,\n  value\n});\nexport const tClearUi = () => (dispatch, getState) => {\n  const rootOrgUnits = sGetRootOrgUnits(getState());\n  dispatch(acClearUi({\n    rootOrgUnits\n  }));\n};\nexport const acSetUiOpenDimensionModal = (value, metadata) => ({\n  type: SET_UI_ACTIVE_MODAL_DIALOG,\n  value,\n  metadata\n});\nexport const acSetUiItems = value => ({\n  type: SET_UI_ITEMS,\n  value\n});\nexport const acAddParentGraphMap = value => ({\n  type: ADD_UI_PARENT_GRAPH_MAP,\n  value\n});\nexport const acSetUiConditions = value => ({\n  type: SET_UI_CONDITIONS,\n  value\n});\nexport const acSetUiRepetition = value => ({\n  type: SET_UI_REPETITION,\n  value\n});","export const SET_USER = 'SET_USER';\nexport const DEFAULT_USER = {\n  id: '',\n  username: '',\n  name: '',\n  uiLocale: '',\n  isSuperuser: false,\n  authorities: {}\n};\nexport default ((state = DEFAULT_USER, action) => {\n  switch (action.type) {\n    case SET_USER:\n      {\n        return fromD2ToUserObj(action.value);\n      }\n\n    default:\n      return state;\n  }\n});\n\nfunction fromD2ToUserObj(d2Object) {\n  return {\n    id: d2Object.id,\n    username: d2Object.username,\n    name: d2Object.name,\n    uiLocale: d2Object.settings.keyUiLocale,\n    isSuperuser: d2Object.authorities.has('ALL')\n  };\n} // Selectors\n\n\nexport const sGetUser = state => state.user;\nexport const sGetUserId = state => sGetUser(state).id;\nexport const sGetUsername = state => sGetUser(state).username;\nexport const sGetIsSuperuser = state => sGetUser(state).isSuperuser;\nexport const sGetUiLocale = state => sGetUser(state).uiLocale;\nexport const sGetUserAuthorities = state => sGetUser(state).authorities;","import { SET_VISUALIZATION, CLEAR_VISUALIZATION } from '../reducers/visualization.js';\nexport const acSetVisualization = value => {\n  const metadata = [...(value.columns || []), ...(value.rows || []), ...(value.filters || [])].filter(dim => {\n    var _dim$optionSet;\n\n    return dim.valueType || ((_dim$optionSet = dim.optionSet) === null || _dim$optionSet === void 0 ? void 0 : _dim$optionSet.id) || dim.dimensionType;\n  }).map(dim => {\n    var _dim$optionSet2;\n\n    return {\n      [dim.dimension]: {\n        valueType: dim.valueType,\n        optionSet: (_dim$optionSet2 = dim.optionSet) === null || _dim$optionSet2 === void 0 ? void 0 : _dim$optionSet2.id,\n        dimensionType: dim.dimensionType\n      }\n    };\n  });\n  return {\n    type: SET_VISUALIZATION,\n    value,\n    metadata\n  };\n};\nexport const acClearVisualization = () => ({\n  type: CLEAR_VISUALIZATION\n});","export const EVENT_TYPE = 'EVENT_REPORT_VIEW';","import { createHashHistory } from 'history';\nexport default createHashHistory();","import { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { IconDelete16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { MessageIconButton } from '../index.js';\nconst mutation = {\n  resource: 'interpretations',\n  id: ({\n    id\n  }) => id,\n  type: 'delete'\n};\n\nconst InterpretationDeleteButton = ({\n  id,\n  onComplete\n}) => {\n  const [remove, {\n    loading\n  }] = useDataMutation(mutation, {\n    onComplete,\n    variables: {\n      id\n    }\n  });\n  return /*#__PURE__*/React.createElement(MessageIconButton, {\n    tooltipContent: i18n.t('Delete'),\n    iconComponent: IconDelete16,\n    onClick: remove,\n    disabled: loading\n  });\n};\n\nInterpretationDeleteButton.propTypes = {\n  id: PropTypes.string.isRequired,\n  onComplete: PropTypes.func.isRequired\n};\nexport { InterpretationDeleteButton };","import _JSXStyle from \"styled-jsx/style\";\nimport { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button, spacers, colors } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { MessageEditorContainer, RichTextEditor, MessageButtonStrip } from '../index.js';\nconst mutation = {\n  resource: 'interpretations',\n  type: 'update',\n  partial: false,\n  id: ({\n    id\n  }) => id,\n  data: ({\n    interpretationText\n  }) => interpretationText\n};\nexport const InterpretationUpdateForm = ({\n  close,\n  currentUser,\n  id,\n  onComplete,\n  text\n}) => {\n  const [interpretationText, setInterpretationText] = useState(text || '');\n  const [update, {\n    loading,\n    error\n  }] = useDataMutation(mutation, {\n    onComplete: () => {\n      onComplete();\n      close();\n    },\n    variables: {\n      id\n    }\n  });\n  const errorText = error ? error.message || i18n.t('Could not update interpretation') : '';\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"2690082310\", [spacers.dp8, spacers.dp8, colors.grey100]]]) + \" \" + \"message\"\n  }, /*#__PURE__*/React.createElement(MessageEditorContainer, {\n    currentUser: currentUser\n  }, /*#__PURE__*/React.createElement(RichTextEditor, {\n    inputPlaceholder: i18n.t('Enter interpretation text'),\n    onChange: setInterpretationText,\n    value: interpretationText,\n    disabled: loading,\n    errorText: errorText\n  }), /*#__PURE__*/React.createElement(MessageButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    loading: loading,\n    primary: true,\n    small: true,\n    onClick: () => update({\n      interpretationText\n    })\n  }, i18n.t('Update')), /*#__PURE__*/React.createElement(Button, {\n    disabled: loading,\n    secondary: true,\n    small: true,\n    onClick: close\n  }, i18n.t('Cancel')))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2690082310\",\n    dynamic: [spacers.dp8, spacers.dp8, colors.grey100]\n  }, [`.message.__jsx-style-dynamic-selector{padding:0 ${spacers.dp8} ${spacers.dp8};background-color:${colors.grey100};border-radius:5px;}`]));\n};\nInterpretationUpdateForm.propTypes = {\n  close: PropTypes.func.isRequired,\n  currentUser: PropTypes.object.isRequired,\n  id: PropTypes.string.isRequired,\n  onComplete: PropTypes.func.isRequired,\n  text: PropTypes.string\n};","import i18n from '@dhis2/d2-i18n';\nimport { Button, IconReply16, IconThumbUp16, IconEdit16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { Message, MessageStatsBar, MessageIconButton } from '../index.js';\nimport { InterpretationDeleteButton } from './InterpretationDeleteButton.js';\nimport { InterpretationUpdateForm } from './InterpretationUpdateForm.js';\nimport { useLike } from './useLike.js';\nexport const Interpretation = ({\n  interpretation,\n  currentUser,\n  onClick,\n  onUpdated,\n  onDeleted,\n  onReplyIconClick\n}) => {\n  const [isUpdateMode, setIsUpdateMode] = useState(false);\n  const {\n    toggleLike,\n    isLikedByCurrentUser,\n    toggleLikeInProgress\n  } = useLike({\n    interpretation,\n    currentUser,\n    onComplete: onUpdated\n  });\n  return isUpdateMode ? /*#__PURE__*/React.createElement(InterpretationUpdateForm, {\n    close: () => setIsUpdateMode(false),\n    id: interpretation.id,\n    onComplete: onUpdated,\n    text: interpretation.text,\n    currentUser: currentUser\n  }) : /*#__PURE__*/React.createElement(Message, {\n    text: interpretation.text,\n    created: interpretation.created,\n    id: interpretation.id,\n    username: interpretation.user.displayName,\n    onClick: onClick\n  }, /*#__PURE__*/React.createElement(MessageStatsBar, null, /*#__PURE__*/React.createElement(MessageIconButton, {\n    tooltipContent: isLikedByCurrentUser ? i18n.t('Unlike') : i18n.t('Like'),\n    iconComponent: IconThumbUp16,\n    onClick: toggleLike,\n    selected: isLikedByCurrentUser,\n    count: interpretation.likes,\n    disabled: toggleLikeInProgress\n  }), /*#__PURE__*/React.createElement(MessageIconButton, {\n    tooltipContent: i18n.t('Reply'),\n    iconComponent: IconReply16,\n    onClick: () => onReplyIconClick(interpretation.id),\n    count: interpretation.comments.length\n  }), interpretation.access.update && /*#__PURE__*/React.createElement(MessageIconButton, {\n    iconComponent: IconEdit16,\n    tooltipContent: i18n.t('Edit'),\n    onClick: () => setIsUpdateMode(true)\n  }), interpretation.access.delete && /*#__PURE__*/React.createElement(InterpretationDeleteButton, {\n    id: interpretation.id,\n    onComplete: onDeleted\n  })), !!onClick && /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    onClick: (_, event) => {\n      event.stopPropagation();\n      onClick(interpretation.id);\n    }\n  }, i18n.t('See interpretation')));\n};\nInterpretation.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  interpretation: PropTypes.object.isRequired,\n  onDeleted: PropTypes.func.isRequired,\n  onReplyIconClick: PropTypes.func.isRequired,\n  onUpdated: PropTypes.func.isRequired,\n  onClick: PropTypes.func\n};","import { useDataMutation } from '@dhis2/app-runtime';\nimport { useEffect, useRef, useState } from 'react';\n\nconst useLike = ({\n  interpretation,\n  currentUser,\n  onComplete\n}) => {\n  const resource = `interpretations/${interpretation.id}/like`;\n  const likeMutationRef = useRef({\n    resource,\n    type: 'create'\n  });\n  const unlikeMutationRef = useRef({\n    resource,\n    type: 'delete'\n  });\n  const [like, {\n    loading: likeLoading\n  }] = useDataMutation(likeMutationRef.current, {\n    onComplete\n  });\n  const [unlike, {\n    loading: unlikeLoading\n  }] = useDataMutation(unlikeMutationRef.current, {\n    onComplete\n  });\n  const [isLikedByCurrentUser, setIsLikedByCurrentUser] = useState(false);\n\n  const toggleLike = () => {\n    isLikedByCurrentUser ? unlike() : like();\n  };\n\n  useEffect(() => {\n    setIsLikedByCurrentUser(interpretation.likedBy.some(likedBy => likedBy.id === currentUser.id));\n  }, [currentUser, interpretation]);\n  return {\n    isLikedByCurrentUser,\n    toggleLike,\n    toggleLikeInProgress: likeLoading || unlikeLoading\n  };\n};\n\nexport { useLike };","import _JSXStyle from \"styled-jsx/style\";\nimport { Parser as RichTextParser } from '@dhis2/d2-ui-rich-text';\nimport { UserAvatar, spacers, colors } from '@dhis2/ui';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst Message = ({\n  children,\n  text,\n  created,\n  id,\n  username,\n  onClick\n}) => /*#__PURE__*/React.createElement(\"li\", {\n  onClick: () => onClick && onClick(id),\n  className: _JSXStyle.dynamic([[\"1430255203\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, spacers.dp12, colors.grey600, colors.grey900, spacers.dp8]]]) + \" \" + \"container\"\n}, /*#__PURE__*/React.createElement(\"div\", {\n  className: _JSXStyle.dynamic([[\"1430255203\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, spacers.dp12, colors.grey600, colors.grey900, spacers.dp8]]]) + \" \" + \"header\"\n}, /*#__PURE__*/React.createElement(UserAvatar, {\n  name: username,\n  extrasmall: true\n}), username, /*#__PURE__*/React.createElement(\"time\", {\n  dateTime: created,\n  className: _JSXStyle.dynamic([[\"1430255203\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, spacers.dp12, colors.grey600, colors.grey900, spacers.dp8]]])\n}, moment(created).format('DD/MM/YY hh:mm'))), /*#__PURE__*/React.createElement(\"div\", {\n  className: _JSXStyle.dynamic([[\"1430255203\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, spacers.dp12, colors.grey600, colors.grey900, spacers.dp8]]]) + \" \" + \"content\"\n}, /*#__PURE__*/React.createElement(RichTextParser, null, text)), /*#__PURE__*/React.createElement(\"div\", {\n  className: _JSXStyle.dynamic([[\"1430255203\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, spacers.dp12, colors.grey600, colors.grey900, spacers.dp8]]]) + \" \" + \"footer\"\n}, children), /*#__PURE__*/React.createElement(_JSXStyle, {\n  id: \"1430255203\",\n  dynamic: [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, spacers.dp12, colors.grey600, colors.grey900, spacers.dp8]\n}, [`.container.__jsx-style-dynamic-selector{padding:${spacers.dp8};background-color:${colors.grey100};border-radius:5px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:${spacers.dp8};}`, `.header.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:6px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:13px;line-height:15px;color:${colors.grey900};}`, `.header.__jsx-style-dynamic-selector time.__jsx-style-dynamic-selector{font-size:${spacers.dp12};line-height:15px;color:${colors.grey600};}`, `.content.__jsx-style-dynamic-selector{font-size:14px;line-height:19px;color:${colors.grey900};}`, \".content.__jsx-style-dynamic-selector p:first-child{margin:0;}\", `.footer.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;gap:${spacers.dp8};}`]));\n\nMessage.propTypes = {\n  children: PropTypes.node.isRequired,\n  created: PropTypes.string.isRequired,\n  id: PropTypes.string.isRequired,\n  text: PropTypes.string.isRequired,\n  username: PropTypes.string.isRequired,\n  onClick: PropTypes.func\n};\nexport { Message };","import _JSXStyle from \"styled-jsx/style\";\nimport { spacers } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst MessageButtonStrip = ({\n  children\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: _JSXStyle.dynamic([[\"1819118406\", [spacers.dp8, spacers.dp8]]]) + \" \" + \"container\"\n}, children, /*#__PURE__*/React.createElement(_JSXStyle, {\n  id: \"1819118406\",\n  dynamic: [spacers.dp8, spacers.dp8]\n}, [`.container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${spacers.dp8};margin-top:${spacers.dp8};}`]));\n\nMessageButtonStrip.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { MessageButtonStrip };","import _JSXStyle from \"styled-jsx/style\";\nimport { Tooltip, colors, spacers } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst MessageIconButton = ({\n  tooltipContent,\n  disabled,\n  onClick,\n  selected,\n  count,\n  iconComponent: Icon\n}) => /*#__PURE__*/React.createElement(Tooltip, {\n  closeDelay: 200,\n  content: tooltipContent\n}, /*#__PURE__*/React.createElement(\"button\", {\n  onClick: event => {\n    event.stopPropagation();\n    onClick();\n  },\n  disabled: disabled,\n  className: _JSXStyle.dynamic([[\"2233852149\", [spacers.dp4, colors.grey700, colors.teal600]]]) + \" \" + (cx('button', {\n    selected\n  }) || \"\")\n}, count && count, /*#__PURE__*/React.createElement(Icon, {\n  color: selected ? colors.teal500 : colors.grey700,\n  className: _JSXStyle.dynamic([[\"2233852149\", [spacers.dp4, colors.grey700, colors.teal600]]])\n})), /*#__PURE__*/React.createElement(_JSXStyle, {\n  id: \"2233852149\",\n  dynamic: [spacers.dp4, colors.grey700, colors.teal600]\n}, [`.button.__jsx-style-dynamic-selector{all:unset;cursor:pointer;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:${spacers.dp4};-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:12px;line-height:14px;color:${colors.grey700};}`, `.button.selected.__jsx-style-dynamic-selector{color:${colors.teal600};font-weight:500;}`]));\n\nMessageIconButton.propTypes = {\n  iconComponent: PropTypes.oneOfType([PropTypes.object, PropTypes.func]).isRequired,\n  tooltipContent: PropTypes.string.isRequired,\n  count: PropTypes.number,\n  disabled: PropTypes.bool,\n  selected: PropTypes.bool,\n  onClick: PropTypes.func\n};\nexport { MessageIconButton };","import _JSXStyle from \"styled-jsx/style\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { theme, colors } from '@dhis2/ui';\nimport React, { forwardRef } from 'react';\nconst MessageInput = /*#__PURE__*/forwardRef((props, ref) => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"input\", _extends({\n  ref: ref\n}, props, {\n  className: _JSXStyle.dynamic([[\"2769305849\", [colors.grey900, colors.grey500, theme.focus, colors.grey100, colors.grey500, theme.disabled]]]) + \" \" + (props && props.className != null && props.className || \"input\")\n})), /*#__PURE__*/React.createElement(_JSXStyle, {\n  id: \"2769305849\",\n  dynamic: [colors.grey900, colors.grey500, theme.focus, colors.grey100, colors.grey500, theme.disabled]\n}, [`.input.__jsx-style-dynamic-selector{width:100%;box-sizing:border-box;font-size:14px;line-height:16px;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;color:${colors.grey900};background-color:white;padding:12px 11px 10px;outline:0;border:1px solid ${colors.grey500};border-radius:3px;box-shadow:inset 0 1px 2px 0 rgba(48,54,60,0.1);text-overflow:ellipsis;}`, `input.__jsx-style-dynamic-selector:focus{outline:none;box-shadow:0 0 0 3px ${theme.focus};}`, `input.disabled.__jsx-style-dynamic-selector{background-color:${colors.grey100};border-color:${colors.grey500};color:${theme.disabled};cursor:not-allowed;}`])));\nMessageInput.displayName = 'MessageInput';\nexport { MessageInput };","import _JSXStyle from \"styled-jsx/style\";\nimport { UserAvatar, spacers } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst MessageEditorContainer = ({\n  children,\n  currentUser\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: _JSXStyle.dynamic([[\"3807884305\", [spacers.dp8, spacers.dp12]]]) + \" \" + \"container\"\n}, /*#__PURE__*/React.createElement(\"div\", {\n  className: _JSXStyle.dynamic([[\"3807884305\", [spacers.dp8, spacers.dp12]]]) + \" \" + \"avatar\"\n}, /*#__PURE__*/React.createElement(UserAvatar, {\n  name: currentUser.name,\n  medium: true\n})), /*#__PURE__*/React.createElement(\"div\", {\n  className: _JSXStyle.dynamic([[\"3807884305\", [spacers.dp8, spacers.dp12]]]) + \" \" + \"editor\"\n}, children), /*#__PURE__*/React.createElement(_JSXStyle, {\n  id: \"3807884305\",\n  dynamic: [spacers.dp8, spacers.dp12]\n}, [`.container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${spacers.dp8};margin-top:${spacers.dp12};}`, \".avatar.__jsx-style-dynamic-selector{-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;}\", \".editor.__jsx-style-dynamic-selector{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}\"]));\n\nMessageEditorContainer.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  children: PropTypes.node\n};\nexport { MessageEditorContainer };","import _JSXStyle from \"styled-jsx/style\";\nimport { spacers } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst MessageStatsBar = ({\n  children\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: _JSXStyle.dynamic([[\"2534339265\", [spacers.dp12]]]) + \" \" + \"container\"\n}, children, /*#__PURE__*/React.createElement(_JSXStyle, {\n  id: \"2534339265\",\n  dynamic: [spacers.dp12]\n}, [`.container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${spacers.dp12};}`]));\n\nMessageStatsBar.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { MessageStatsBar };","import _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nimport { colors, spacers } from '@dhis2/ui';\n\n/*\n * Note that the clone and clone > pre styles have been chosen\n * to emulate the styles of the textarea. If we decide to make\n * changes there, they should be refelcted here too.\n */\nexport const userMentionWrapperClasses = [\".wrapper.jsx-1289989717{position:relative;}\", `.clone.jsx-1289989717{position:absolute;visibility:hidden;inset:0;box-sizing:border-box;padding:${spacers.dp8} ${spacers.dp12};border:1px solid ${colors.grey500};font-size:14px;line-height:${spacers.dp16};z-index:1;pointer-events:none;}`, \".clone.jsx-1289989717>pre.jsx-1289989717{display:inline;word-wrap:break-word;overflow-wrap:break-word;font:inherit;margin:0;}\", `.container.jsx-1289989717{background-color:${colors.white};max-height:180px;overflow:auto;}`];\nuserMentionWrapperClasses.__hash = \"1289989717\";\nexport const resolvedHeaderStyle = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"4275958396\"\n  }, [\".jsx-4275958396{position:-webkit-sticky;position:sticky;top:0;}\"]),\n  className: \"jsx-4275958396\"\n};","import i18n from '@dhis2/d2-i18n';\nimport { MenuItem } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nexport const UserList = ({\n  users,\n  selectedUserIndex,\n  onUserClick,\n  pager\n}) => {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, users.map(u => {\n    var _users$selectedUserIn;\n\n    return /*#__PURE__*/React.createElement(MenuItem, {\n      dense: true,\n      key: u.id,\n      onClick: onUserClick(u),\n      label: `${u.displayName} (${u.username})`,\n      active: ((_users$selectedUserIn = users[selectedUserIndex]) === null || _users$selectedUserIn === void 0 ? void 0 : _users$selectedUserIn.id) === u.id\n    });\n  }), pager.total > pager.pageSize && /*#__PURE__*/React.createElement(MenuItem, {\n    dense: true,\n    disabled: true,\n    label: i18n.t('Too many results. Try refining the search.')\n  }));\n};\nUserList.propTypes = {\n  pager: PropTypes.object.isRequired,\n  selectedUserIndex: PropTypes.number.isRequired,\n  users: PropTypes.array.isRequired,\n  onUserClick: PropTypes.func.isRequired\n};","import { useDataQuery } from '@dhis2/app-runtime';\nimport debounce from 'lodash/debounce';\nimport { useCallback, useEffect, useState } from 'react';\nconst usersQuery = {\n  users: {\n    resource: 'users/gist',\n    params: ({\n      searchText\n    }) => ({\n      fields: 'id,displayName,userCredentials.username~rename(username)',\n      order: 'firstName,surname',\n      total: true,\n      filter: `userCredentials.username:ilike:${searchText},firstName:ilike:${searchText},surname:ilike:${searchText},email:ilike:${searchText}`,\n      rootJunction: 'OR'\n    })\n  }\n};\nexport const useUserSearchResults = ({\n  searchText\n}) => {\n  const [{\n    users,\n    pager\n  }, setData] = useState({\n    users: [],\n    pager: {}\n  });\n  const {\n    data,\n    fetching,\n    refetch\n  } = useDataQuery(usersQuery, {\n    lazy: true\n  });\n  const debouncedRefetch = useCallback(debounce(refetch, 250), [refetch]);\n  useEffect(() => {\n    if (searchText.length) {\n      debouncedRefetch({\n        searchText\n      });\n    }\n\n    return () => debouncedRefetch.cancel();\n  }, [searchText]);\n  useEffect(() => {\n    if (data) {\n      setData(data.users);\n    }\n  }, [data]);\n  return {\n    users,\n    pager,\n    fetching,\n    clear: () => setData({\n      users: [],\n      pager: {}\n    })\n  };\n};","import _JSXStyle from \"styled-jsx/style\";\nimport i18n from '@dhis2/d2-i18n';\nimport { CenteredContent, CircularLoader, Menu, MenuSectionHeader, MenuItem, Popper, Card, Portal } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState, useRef } from 'react';\nimport { resolvedHeaderStyle, userMentionWrapperClasses } from './styles/UserMentionWrapper.style.js';\nimport { UserList } from './UserList.js';\nimport { useUserSearchResults } from './useUserSearchResults.js';\nconst AT_SYMBOL_WIDTH = 14;\n\nconst getVirtualPopperReference = ref => {\n  const rects = ref.current.getClientRects();\n  const lastRect = rects[rects.length - 1];\n  const left = lastRect.left + lastRect.width - AT_SYMBOL_WIDTH;\n  return {\n    getBoundingClientRect: () => ({\n      top: lastRect.top,\n      right: lastRect.right,\n      bottom: lastRect.bottom,\n      left,\n      width: AT_SYMBOL_WIDTH,\n      height: lastRect.height,\n      x: left\n    })\n  };\n};\n\nexport const UserMentionWrapper = ({\n  children,\n  inputReference,\n  onUserSelect\n}) => {\n  const [captureText, setCaptureText] = useState(false);\n  const [capturedText, setCapturedText] = useState('');\n  const [cloneText, setCloneText] = useState('');\n  const cloneRef = useRef(null);\n  const [captureStartPosition, setCaptureStartPosition] = useState(null);\n  const [selectedUserIndex, setSelectedUserIndex] = useState(0);\n  const {\n    users,\n    pager,\n    fetching,\n    clear\n  } = useUserSearchResults({\n    searchText: capturedText\n  });\n\n  const reset = () => {\n    setCaptureText(false);\n    setCapturedText('');\n    setCloneText('');\n    setCaptureStartPosition(null);\n    setSelectedUserIndex(0);\n    clear();\n  }; // event bubbles up from the input/textarea\n\n\n  const onInput = ({\n    target\n  }) => {\n    const {\n      selectionEnd,\n      value\n    } = target;\n\n    if (captureText) {\n      clear();\n      const spacePosition = value.indexOf(' ', captureStartPosition - 1);\n      const filterValue = value.substring(captureStartPosition, spacePosition > 0 ? spacePosition : selectionEnd + 1);\n\n      if (filterValue !== capturedText) {\n        setCapturedText(filterValue);\n      } else if (filterValue.length === 0) {\n        setCapturedText('');\n        clear();\n      }\n    }\n  }; // event bubbles up from the wrapped input/textarea\n\n\n  const onKeyDown = ({\n    key,\n    target\n  }) => {\n    const {\n      selectionStart\n    } = target;\n\n    if (!captureText && key === '@') {\n      setCaptureText(true);\n      setCaptureStartPosition(selectionStart + 1);\n      setCloneText(target.value.substring(0, selectionStart) + '@');\n    } else if (captureText) {\n      if (key === ' ' || key === 'Backspace' && selectionStart <= captureStartPosition) {\n        reset();\n      } else if (users.length) {\n        switch (key) {\n          case 'Enter':\n            event.preventDefault();\n\n            if (selectedUserIndex >= 0) {\n              onSelect(users[selectedUserIndex]);\n            }\n\n            break;\n\n          case 'ArrowDown':\n            event.preventDefault();\n\n            if (selectedUserIndex < users.length - 1) {\n              setSelectedUserIndex(selectedUserIndex + 1);\n            }\n\n            break;\n\n          case 'ArrowUp':\n            event.preventDefault();\n\n            if (selectedUserIndex > 0) {\n              setSelectedUserIndex(selectedUserIndex - 1);\n            }\n\n            break;\n\n          default: // other key strokes, typically the text typed\n          // the onInput event handler set on the input element is triggering the user lookup\n\n        }\n      }\n    }\n  };\n\n  const onSelect = user => {\n    const originalValue = inputReference.current.value;\n    const newValue = `${originalValue.slice(0, captureStartPosition - 1)}${originalValue.slice(captureStartPosition - 1).replace(/^@\\w*/, `@${user.username} `)}`;\n    reset(); // typically for connected components we want the state to be updated too\n    // but the logic belongs to the wrapped component, so we just invoke the supplied callback\n\n    if (onUserSelect) {\n      onUserSelect(newValue);\n    } // need to refocus on the input/textarea\n\n\n    inputReference.current.focus(); // position the cursor at the end\n\n    requestAnimationFrame(() => inputReference.current.setSelectionRange(-1, -1), 0);\n  };\n\n  const onClick = user => () => onSelect(user);\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    onKeyDown: onKeyDown,\n    onInput: onInput,\n    className: `jsx-${userMentionWrapperClasses.__hash}` + \" \" + \"wrapper\"\n  }, children, /*#__PURE__*/React.createElement(\"div\", {\n    className: `jsx-${userMentionWrapperClasses.__hash}` + \" \" + \"clone\"\n  }, /*#__PURE__*/React.createElement(\"pre\", {\n    ref: cloneRef,\n    className: `jsx-${userMentionWrapperClasses.__hash}`\n  }, cloneText)), captureText && /*#__PURE__*/React.createElement(Portal, null, /*#__PURE__*/React.createElement(Popper, {\n    reference: getVirtualPopperReference(cloneRef),\n    placement: \"top-start\"\n  }, /*#__PURE__*/React.createElement(Card, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: `jsx-${userMentionWrapperClasses.__hash}` + \" \" + \"container\"\n  }, /*#__PURE__*/React.createElement(Menu, {\n    dense: true\n  }, /*#__PURE__*/React.createElement(MenuSectionHeader, {\n    className: resolvedHeaderStyle.className,\n    dense: true,\n    hideDivider: true,\n    label: capturedText === '' ? i18n.t('Search for a user') : i18n.t('Searching for \"{{searchText}}\"', {\n      searchText: capturedText\n    })\n  }), fetching && /*#__PURE__*/React.createElement(MenuItem, {\n    label: /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, {\n      small: true\n    }))\n  }), !fetching && users.length > 0 && /*#__PURE__*/React.createElement(UserList, {\n    users: users,\n    selectedUserIndex: selectedUserIndex,\n    onUserClick: onClick,\n    pager: pager\n  }), capturedText && !fetching && users.length === 0 && /*#__PURE__*/React.createElement(MenuItem, {\n    dense: true,\n    disabled: true,\n    label: i18n.t('No results found')\n  })))))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: userMentionWrapperClasses.__hash\n  }, userMentionWrapperClasses), resolvedHeaderStyle.styles);\n};\nUserMentionWrapper.defaultProps = {\n  onUserSelect: Function.prototype\n};\nUserMentionWrapper.propTypes = {\n  inputReference: PropTypes.object.isRequired,\n  onUserSelect: PropTypes.func.isRequired,\n  children: PropTypes.node\n};\nexport default UserMentionWrapper;","export const BOLD = 'bold';\nexport const ITALIC = 'italic';\nexport const LINK = 'link';\nexport const MENTION = 'mention';\nexport const EMOJI_SMILEY_FACE = 'smileyFace';\nexport const EMOJI_SAD_FACE = 'sadFace';\nexport const EMOJI_THUMBS_UP = 'thumbsUp';\nexport const EMOJI_THUMBS_DOWN = 'thumsDown';\nexport const emojis = {\n  [EMOJI_SMILEY_FACE]: ':-)',\n  [EMOJI_SAD_FACE]: ':-(',\n  [EMOJI_THUMBS_UP]: ':+1',\n  [EMOJI_THUMBS_DOWN]: ':-1'\n};\nconst markdownMap = {\n  [ITALIC]: {\n    prefix: '_',\n    postfix: '_'\n  },\n  [BOLD]: {\n    prefix: '*',\n    postfix: '*'\n  },\n  [LINK]: {\n    prefix: '[',\n    postfix: '](https://link-url)'\n  },\n  [MENTION]: {\n    prefix: '@'\n  },\n  [EMOJI_SMILEY_FACE]: {\n    prefix: emojis[EMOJI_SMILEY_FACE]\n  },\n  [EMOJI_SAD_FACE]: {\n    prefix: emojis[EMOJI_SAD_FACE]\n  },\n  [EMOJI_THUMBS_UP]: {\n    prefix: emojis[EMOJI_THUMBS_UP]\n  },\n  [EMOJI_THUMBS_DOWN]: {\n    prefix: emojis[EMOJI_THUMBS_DOWN]\n  }\n};\n\nconst trim = str => {\n  const leftSpaces = /^\\s+/;\n  const rightSpaces = /\\s+$/;\n  return str.replace(leftSpaces, '').replace(rightSpaces, '');\n};\n\nexport const insertMarkdown = (markdown, target, cb) => {\n  const {\n    selectionStart: start,\n    selectionEnd: end,\n    value\n  } = target;\n  const marker = markdownMap[markdown] || null;\n\n  if (!marker || !cb || start < 0) {\n    return;\n  }\n\n  let newValue;\n  let caretPos = end + 1;\n\n  const padMarkers = text => {\n    // is caret between two markers (i.e., \"**\" or \"__\")? Then do not add padding\n    if (start === end && value.length && start > 0) {\n      if (value[start - 1] === markdownMap[BOLD].prefix && value[start] === markdownMap[BOLD].prefix || value[start - 1] === markdownMap[ITALIC].prefix && value[start] === markdownMap[ITALIC].prefix) {\n        return text;\n      }\n    }\n\n    if (value.length && start > 0 && value[start - 1] !== ' ') {\n      text = ` ${text}`;\n      ++caretPos;\n    }\n\n    if (value.length && end !== value.length && value[end] !== ' ') {\n      text = `${text} `;\n    }\n\n    return text;\n  };\n\n  if (start === end) {\n    //no text\n    const valueArr = value.split('');\n    let markdown = marker.prefix;\n\n    if (marker.postfix) {\n      markdown += marker.postfix;\n    }\n\n    valueArr.splice(start, 0, padMarkers(markdown));\n    newValue = valueArr.join('');\n  } else {\n    const text = value.slice(start, end);\n    const trimmedText = trim(text); // TODO really needed?\n    // adjust caretPos based on trimmed text selection\n\n    caretPos = caretPos - (text.length - trimmedText.length) + 1;\n    let markdown = `${marker.prefix}${trimmedText}`;\n\n    if (marker.postfix) {\n      markdown += marker.postfix;\n    }\n\n    newValue = [value.slice(0, start), padMarkers(markdown), value.slice(end)].join('');\n  }\n\n  cb(newValue, caretPos);\n};\nexport const convertCtrlKey = (event, cb) => {\n  const {\n    key,\n    ctrlKey,\n    metaKey\n  } = event;\n\n  if (key === 'b' && (ctrlKey || metaKey)) {\n    event.preventDefault();\n    insertMarkdown(BOLD, event.target, cb);\n  } else if (key === 'i' && (ctrlKey || metaKey)) {\n    event.preventDefault();\n    insertMarkdown(ITALIC, event.target, cb);\n  }\n};","import { colors, spacers, theme } from '@dhis2/ui';\nexport const mainClasses = [\".container.jsx-2278350860{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;}\", `.preview.jsx-2278350860{font-size:14px;line-height:19px;color:${colors.grey900};}`, `.textarea.jsx-2278350860{width:100%;box-sizing:border-box;padding:${spacers.dp8} ${spacers.dp12};color:${colors.grey900};background-color:${colors.white};border:1px solid ${colors.grey500};border-radius:3px;box-shadow:inset 0 0 0 1px rgba(102,113,123,0.15), inset 0 1px 2px 0 rgba(102,113,123,0.1);outline:0;font-size:14px;line-height:${spacers.dp16};-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;}`, `.textarea.jsx-2278350860:focus{outline:none;box-shadow:0 0 0 3px ${theme.focus};}`, `.textarea.jsx-2278350860:disabled{background-color:${colors.grey100};border-color:${colors.grey500};color:${theme.disabled};cursor:not-allowed;}`];\nmainClasses.__hash = \"2278350860\";\nexport const toolbarClasses = [`.toolbar.jsx-1155951848{background:${colors.grey050};border-radius:3px;border:1px solid ${colors.grey300};margin-bottom:${spacers.dp4};}`, `.actionsWrapper.jsx-1155951848{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:${spacers.dp4};-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}`, `.mainActions.jsx-1155951848{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${spacers.dp8};}`, \".sideActions.jsx-1155951848{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-left:auto;}\", `.previewWrapper.jsx-1155951848{margin:${spacers.dp4};text-align:right;}`];\ntoolbarClasses.__hash = \"1155951848\";\nexport const emojisPopoverClasses = [`.emojisList.jsx-2802175370{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${spacers.dp8};list-style-type:none;margin:0 ${spacers.dp4} 0 ${spacers.dp8};padding:0;}`, \".emojisList.jsx-2802175370 li.jsx-2802175370{cursor:pointer;}\"];\nemojisPopoverClasses.__hash = \"2802175370\";","import _JSXStyle from \"styled-jsx/style\";\nimport i18n from '@dhis2/d2-i18n';\nimport { Parser as RichTextParser } from '@dhis2/d2-ui-rich-text';\nimport { Button, Popover, Tooltip, Field, IconAt24, IconFaceAdd24, IconLink24, IconTextBold24, IconTextItalic24, colors } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { forwardRef, useRef, useEffect, useState } from 'react';\nimport { UserMentionWrapper } from '../UserMention/UserMentionWrapper.js';\nimport { convertCtrlKey, insertMarkdown, emojis, EMOJI_SMILEY_FACE, EMOJI_SAD_FACE, EMOJI_THUMBS_UP, EMOJI_THUMBS_DOWN, BOLD, ITALIC, LINK, MENTION } from './markdownHandler.js';\nimport { mainClasses, toolbarClasses, emojisPopoverClasses } from './styles/RichTextEditor.style.js';\n\nconst EmojisPopover = ({\n  onInsertMarkdown,\n  onClose,\n  reference\n}) => /*#__PURE__*/React.createElement(Popover, {\n  reference: reference,\n  onClickOutside: onClose\n}, /*#__PURE__*/React.createElement(\"ul\", {\n  className: `jsx-${emojisPopoverClasses.__hash}` + \" \" + \"emojisList\"\n}, /*#__PURE__*/React.createElement(\"li\", {\n  onClick: () => onInsertMarkdown(EMOJI_SMILEY_FACE),\n  className: `jsx-${emojisPopoverClasses.__hash}`\n}, /*#__PURE__*/React.createElement(RichTextParser, null, emojis[EMOJI_SMILEY_FACE])), /*#__PURE__*/React.createElement(\"li\", {\n  onClick: () => onInsertMarkdown(EMOJI_SAD_FACE),\n  className: `jsx-${emojisPopoverClasses.__hash}`\n}, /*#__PURE__*/React.createElement(RichTextParser, null, emojis[EMOJI_SAD_FACE])), /*#__PURE__*/React.createElement(\"li\", {\n  onClick: () => onInsertMarkdown(EMOJI_THUMBS_UP),\n  className: `jsx-${emojisPopoverClasses.__hash}`\n}, /*#__PURE__*/React.createElement(RichTextParser, null, emojis[EMOJI_THUMBS_UP])), /*#__PURE__*/React.createElement(\"li\", {\n  onClick: () => onInsertMarkdown(EMOJI_THUMBS_DOWN),\n  className: `jsx-${emojisPopoverClasses.__hash}`\n}, /*#__PURE__*/React.createElement(RichTextParser, null, emojis[EMOJI_THUMBS_DOWN]))), /*#__PURE__*/React.createElement(_JSXStyle, {\n  id: emojisPopoverClasses.__hash\n}, emojisPopoverClasses));\n\nEmojisPopover.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  onInsertMarkdown: PropTypes.func.isRequired,\n  reference: PropTypes.object\n};\n\nconst Toolbar = ({\n  disabled,\n  onInsertMarkdown,\n  onTogglePreview,\n  previewButtonDisabled,\n  previewMode\n}) => {\n  const emojisButtonRef = useRef();\n  const [emojisPopoverIsOpen, setEmojisPopoverIsOpen] = useState(false);\n  const iconColor = disabled ? colors.grey600 : colors.grey700;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: `jsx-${toolbarClasses.__hash}` + \" \" + \"toolbar\"\n  }, !previewMode ? /*#__PURE__*/React.createElement(\"div\", {\n    className: `jsx-${toolbarClasses.__hash}` + \" \" + \"actionsWrapper\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `jsx-${toolbarClasses.__hash}` + \" \" + \"mainActions\"\n  }, /*#__PURE__*/React.createElement(Tooltip, {\n    content: i18n.t('Bold text'),\n    placement: \"bottom\",\n    closeDelay: 200\n  }, /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconTextBold24, {\n      color: iconColor\n    }),\n    onClick: () => onInsertMarkdown(BOLD)\n  })), /*#__PURE__*/React.createElement(Tooltip, {\n    content: i18n.t('Italic text'),\n    placement: \"bottom\",\n    closeDelay: 200\n  }, /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconTextItalic24, {\n      color: iconColor\n    }),\n    onClick: () => onInsertMarkdown(ITALIC)\n  })), /*#__PURE__*/React.createElement(Tooltip, {\n    content: i18n.t('Link to a URL'),\n    placement: \"bottom\",\n    closeDelay: 200\n  }, /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconLink24, {\n      color: iconColor\n    }),\n    onClick: () => onInsertMarkdown(LINK)\n  })), /*#__PURE__*/React.createElement(Tooltip, {\n    content: i18n.t('Mention a user'),\n    placement: \"bottom\",\n    closeDelay: 200\n  }, /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconAt24, {\n      color: iconColor\n    }),\n    onClick: () => onInsertMarkdown(MENTION)\n  })), /*#__PURE__*/React.createElement(Tooltip, {\n    content: i18n.t('Add emoji'),\n    placement: \"bottom\",\n    closeDelay: 200\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    ref: emojisButtonRef,\n    className: `jsx-${toolbarClasses.__hash}`\n  }, /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconFaceAdd24, {\n      color: iconColor\n    }),\n    onClick: () => setEmojisPopoverIsOpen(true)\n  })), emojisPopoverIsOpen && /*#__PURE__*/React.createElement(EmojisPopover, {\n    onClose: () => setEmojisPopoverIsOpen(false),\n    onInsertMarkdown: markup => {\n      onInsertMarkdown(markup);\n      setEmojisPopoverIsOpen(false);\n    },\n    reference: emojisButtonRef\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: `jsx-${toolbarClasses.__hash}` + \" \" + \"sideActions\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: previewButtonDisabled || disabled,\n    onClick: onTogglePreview\n  }, i18n.t('Preview')))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: `jsx-${toolbarClasses.__hash}` + \" \" + \"previewWrapper\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    onClick: onTogglePreview,\n    disabled: disabled\n  }, i18n.t('Back to write mode'))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: toolbarClasses.__hash\n  }, toolbarClasses));\n};\n\nToolbar.propTypes = {\n  previewButtonDisabled: PropTypes.bool.isRequired,\n  previewMode: PropTypes.bool.isRequired,\n  onInsertMarkdown: PropTypes.func.isRequired,\n  onTogglePreview: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n};\nexport const RichTextEditor = /*#__PURE__*/forwardRef(({\n  value,\n  disabled,\n  inputPlaceholder,\n  onChange,\n  errorText\n}, externalRef) => {\n  const [previewMode, setPreviewMode] = useState(false);\n  const internalRef = useRef();\n  const textareaRef = externalRef || internalRef;\n  useEffect(() => {\n    var _textareaRef$current;\n\n    return (_textareaRef$current = textareaRef.current) === null || _textareaRef$current === void 0 ? void 0 : _textareaRef$current.focus();\n  }, [textareaRef.current]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: `jsx-${mainClasses.__hash}` + \" \" + \"container\"\n  }, /*#__PURE__*/React.createElement(Toolbar, {\n    onInsertMarkdown: markdown => {\n      insertMarkdown(markdown, textareaRef.current, (text, caretPos) => {\n        onChange(text);\n        textareaRef.current.focus();\n        textareaRef.current.selectionEnd = caretPos;\n      });\n\n      if (markdown === MENTION) {\n        textareaRef.current.dispatchEvent(new KeyboardEvent('keydown', {\n          key: '@',\n          bubbles: true\n        }));\n      }\n    },\n    onTogglePreview: () => setPreviewMode(!previewMode),\n    previewMode: previewMode,\n    previewButtonDisabled: !value,\n    disabled: disabled\n  }), previewMode ? /*#__PURE__*/React.createElement(\"div\", {\n    className: `jsx-${mainClasses.__hash}` + \" \" + \"preview\"\n  }, /*#__PURE__*/React.createElement(RichTextParser, null, value)) : /*#__PURE__*/React.createElement(Field, {\n    error: !!errorText,\n    validationText: errorText\n  }, /*#__PURE__*/React.createElement(UserMentionWrapper, {\n    onUserSelect: onChange,\n    inputReference: textareaRef\n  }, /*#__PURE__*/React.createElement(\"textarea\", {\n    ref: textareaRef,\n    placeholder: inputPlaceholder,\n    disabled: disabled,\n    value: value,\n    onChange: event => onChange(event.target.value),\n    onKeyDown: event => convertCtrlKey(event, onChange),\n    className: `jsx-${mainClasses.__hash}` + \" \" + \"textarea\"\n  }))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: mainClasses.__hash\n  }, mainClasses));\n});\nRichTextEditor.displayName = 'RichTextEditor';\nRichTextEditor.propTypes = {\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n  errorText: PropTypes.string,\n  inputPlaceholder: PropTypes.string\n};","import { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button, Input } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useRef, useState } from 'react';\nimport { RichTextEditor, MessageEditorContainer, MessageButtonStrip } from '../common/index.js';\nexport const InterpretationForm = ({\n  type,\n  id,\n  currentUser,\n  onSave\n}) => {\n  const [showRichTextEditor, setShowRichTextEditor] = useState(false);\n  const [interpretationText, setInterpretationText] = useState('');\n  const saveMutationRef = useRef({\n    resource: `interpretations/${type}/${id}`,\n    type: 'create',\n    data: ({\n      interpretationText\n    }) => interpretationText\n  });\n  const [save, {\n    loading: saveMutationInProgress\n  }] = useDataMutation(saveMutationRef.current, {\n    onComplete: () => {\n      setShowRichTextEditor(false);\n      setInterpretationText('');\n      onSave();\n    }\n  });\n  const inputPlaceholder = i18n.t('Write an interpretation');\n  return /*#__PURE__*/React.createElement(MessageEditorContainer, {\n    currentUser: currentUser\n  }, showRichTextEditor ? /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(RichTextEditor, {\n    disabled: saveMutationInProgress,\n    inputPlaceholder: inputPlaceholder,\n    onChange: setInterpretationText,\n    value: interpretationText\n  }), /*#__PURE__*/React.createElement(MessageButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    small: true,\n    disabled: saveMutationInProgress,\n    onClick: () => save({\n      interpretationText\n    })\n  }, i18n.t('Save interpretation')), /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: saveMutationInProgress,\n    onClick: () => {\n      setInterpretationText('');\n      setShowRichTextEditor(false);\n    }\n  }, i18n.t('Cancel')))) : /*#__PURE__*/React.createElement(Input, {\n    onFocus: () => setShowRichTextEditor(true),\n    placeholder: inputPlaceholder\n  }));\n};\nInterpretationForm.propTypes = {\n  currentUser: PropTypes.object,\n  id: PropTypes.string,\n  type: PropTypes.string,\n  onSave: PropTypes.func\n};","import _JSXStyle from \"styled-jsx/style\";\nimport { IconCalendar24, colors, spacers } from '@dhis2/ui';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { Interpretation } from '../common/index.js';\n\nconst sortByDateProp = (a, b) => {\n  const dateA = a.created;\n  const dateB = b.created;\n\n  if (dateA < dateB) {\n    return -1;\n  }\n\n  if (dateA > dateB) {\n    return 1;\n  }\n\n  return 0;\n};\n\nexport const InterpretationList = ({\n  currentUser,\n  interpretations,\n  onInterpretationClick,\n  onReplyIconClick,\n  refresh\n}) => {\n  const interpretationsByDate = interpretations.reduce((groupedInterpretations, interpretation) => {\n    const date = interpretation.created.split('T')[0];\n\n    if (date in groupedInterpretations) {\n      groupedInterpretations[date].push(interpretation);\n    } else {\n      groupedInterpretations[date] = [interpretation];\n    }\n\n    return groupedInterpretations;\n  }, {});\n  return /*#__PURE__*/React.createElement(\"ol\", {\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]]) + \" \" + \"interpretation-groups\"\n  }, Object.keys(interpretationsByDate).sort().reverse().map(date => /*#__PURE__*/React.createElement(\"li\", {\n    key: date,\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]])\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]]) + \" \" + \"date-section\"\n  }, /*#__PURE__*/React.createElement(IconCalendar24, {\n    color: colors.grey600\n  }), /*#__PURE__*/React.createElement(\"time\", {\n    dateTime: date,\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]]) + \" \" + \"date-header\"\n  }, moment(date).format('ll'))), /*#__PURE__*/React.createElement(\"ol\", {\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]]) + \" \" + \"interpretation-list\"\n  }, interpretationsByDate[date].sort(sortByDateProp).map(interpretation => /*#__PURE__*/React.createElement(Interpretation, {\n    key: interpretation.id,\n    interpretation: interpretation,\n    currentUser: currentUser,\n    onClick: onInterpretationClick,\n    onReplyIconClick: onReplyIconClick,\n    onDeleted: refresh,\n    onUpdated: refresh\n  }))))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"4058400613\",\n    dynamic: [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]\n  }, [`.date-section.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${spacers.dp8};-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:${spacers.dp8};}`, `.date-header.__jsx-style-dynamic-selector{font-size:14px;font-weight:500;line-height:${spacers.dp16};color:${colors.grey800};}`, `.interpretation-groups.__jsx-style-dynamic-selector{margin:0;padding:0;padding-top:${spacers.dp12};list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:${spacers.dp12};}`, `.interpretation-list.__jsx-style-dynamic-selector{margin:0;padding-left:${spacers.dp32};list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:${spacers.dp4};}`]));\n};\nInterpretationList.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  interpretations: PropTypes.array.isRequired,\n  refresh: PropTypes.func.isRequired,\n  onInterpretationClick: PropTypes.func.isRequired,\n  onReplyIconClick: PropTypes.func.isRequired\n};","import _JSXStyle from \"styled-jsx/style\";\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { CircularLoader, IconChevronDown24, IconChevronUp24, colors, spacers } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useState, useImperativeHandle, forwardRef } from 'react';\nimport { InterpretationForm } from './InterpretationForm.js';\nimport { InterpretationList } from './InterpretationList.js';\nconst interpretationsQuery = {\n  interpretations: {\n    resource: 'interpretations',\n    params: ({\n      type,\n      id\n    }) => ({\n      fields: ['access', 'id', 'user[displayName]', 'created', 'text', 'comments[id]', 'likes', 'likedBy[id]'],\n      filter: `${type}.id:eq:${id}`\n    })\n  }\n};\nexport const InterpretationsUnit = /*#__PURE__*/forwardRef(({\n  currentUser,\n  type,\n  id,\n  onInterpretationClick,\n  onReplyIconClick\n}, ref) => {\n  const [isExpanded, setIsExpanded] = useState(true);\n  const {\n    data,\n    loading,\n    fetching,\n    refetch\n  } = useDataQuery(interpretationsQuery, {\n    lazy: true\n  });\n\n  const onCompleteAction = () => {\n    refetch({\n      type,\n      id\n    });\n  };\n\n  useImperativeHandle(ref, () => ({\n    refresh: onCompleteAction\n  }), []);\n  useEffect(() => {\n    if (id) {\n      refetch({\n        type,\n        id\n      });\n    }\n  }, [type, id]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"4258033373\", [spacers.dp16, colors.grey400, colors.white, spacers.dp32, spacers.dp16, colors.grey900]]]) + \" \" + (cx('container', {\n      expanded: isExpanded,\n      fetching: fetching && !loading\n    }) || \"\")\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    onClick: () => setIsExpanded(!isExpanded),\n    className: _JSXStyle.dynamic([[\"4258033373\", [spacers.dp16, colors.grey400, colors.white, spacers.dp32, spacers.dp16, colors.grey900]]]) + \" \" + \"header\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: _JSXStyle.dynamic([[\"4258033373\", [spacers.dp16, colors.grey400, colors.white, spacers.dp32, spacers.dp16, colors.grey900]]]) + \" \" + \"title\"\n  }, i18n.t('Interpretations')), isExpanded ? /*#__PURE__*/React.createElement(IconChevronUp24, {\n    color: colors.grey700\n  }) : /*#__PURE__*/React.createElement(IconChevronDown24, {\n    color: colors.grey700\n  })), isExpanded && /*#__PURE__*/React.createElement(React.Fragment, null, loading && /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"4258033373\", [spacers.dp16, colors.grey400, colors.white, spacers.dp32, spacers.dp16, colors.grey900]]]) + \" \" + \"loader\"\n  }, /*#__PURE__*/React.createElement(CircularLoader, {\n    small: true\n  })), data && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(InterpretationList, {\n    currentUser: currentUser,\n    interpretations: data.interpretations.interpretations,\n    onInterpretationClick: onInterpretationClick,\n    onReplyIconClick: onReplyIconClick,\n    refresh: onCompleteAction\n  }), /*#__PURE__*/React.createElement(InterpretationForm, {\n    currentUser: currentUser,\n    type: type,\n    id: id,\n    onSave: onCompleteAction\n  }))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"4258033373\",\n    dynamic: [spacers.dp16, colors.grey400, colors.white, spacers.dp32, spacers.dp16, colors.grey900]\n  }, [`.container.__jsx-style-dynamic-selector{position:relative;padding:${spacers.dp16};border-bottom:1px solid ${colors.grey400};background-color:${colors.white};}`, \".container.fetching.__jsx-style-dynamic-selector::before{content:'';position:absolute;inset:0px;background-color:rgba(255,255,255,0.8);}\", \".container.fetching.__jsx-style-dynamic-selector::after{content:'';position:absolute;top:calc(50% - 12px);left:calc(50% - 12px);width:24px;height:24px;border-width:4px;border-style:solid;border-color:rgba(110,122,138,0.15) rgba(110,122,138,0.15) rgb(20,124,215);border-image:initial;border-radius:50%;-webkit-animation:1s linear 0s infinite normal none running rotation-__jsx-style-dynamic-selector;animation:1s linear 0s infinite normal none running rotation-__jsx-style-dynamic-selector;}\", \"@-webkit-keyframes rotation-__jsx-style-dynamic-selector{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}\", \"@keyframes rotation-__jsx-style-dynamic-selector{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}\", `.expanded.__jsx-style-dynamic-selector{padding-bottom:${spacers.dp32};}`, \".loader.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}\", \".header.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}\", `.title.__jsx-style-dynamic-selector{font-size:${spacers.dp16};font-weight:500;line-height:21px;color:${colors.grey900};}`]));\n});\nInterpretationsUnit.displayName = 'InterpretationsUnit';\nInterpretationsUnit.defaultProps = {\n  onInterpretationClick: Function.prototype\n};\nInterpretationsUnit.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  id: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  onInterpretationClick: PropTypes.func,\n  onReplyIconClick: PropTypes.func\n};","import { AboutAOUnit } from '@dhis2/analytics';\nimport PropTypes from 'prop-types';\nimport { stringify } from 'query-string';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport history from '../../modules/history.js';\nimport { sGetCurrent } from '../../reducers/current.js';\nimport { sGetUser } from '../../reducers/user.js';\nimport { InterpretationsUnit } from '../Interpretations/InterpretationsUnit/index.js';\nimport classes from './styles/DetailsPanel.module.css';\n\nconst navigateToOpenModal = (interpretationId, initialFocus) => {\n  history.push({\n    pathName: history.location.pathname,\n    search: `?${stringify({\n      interpretationId,\n      initialFocus\n    })}`\n  }, {\n    isModalOpening: true\n  });\n};\n\nexport const DetailsPanel = ({\n  currentUser,\n  interpretationsUnitRef,\n  visualization\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: classes.panel\n}, /*#__PURE__*/React.createElement(AboutAOUnit, {\n  type: \"eventVisualizations\",\n  id: visualization.id\n}), /*#__PURE__*/React.createElement(InterpretationsUnit, {\n  ref: interpretationsUnitRef,\n  type: \"eventVisualization\",\n  id: visualization.id,\n  currentUser: currentUser,\n  onInterpretationClick: interpretationId => navigateToOpenModal(interpretationId),\n  onReplyIconClick: interpretationId => navigateToOpenModal(interpretationId, true)\n}));\nDetailsPanel.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  interpretationsUnitRef: PropTypes.object.isRequired,\n  visualization: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => ({\n  currentUser: sGetUser(state),\n  visualization: sGetCurrent(state)\n});\n\nexport default connect(mapStateToProps)(DetailsPanel);","// parse e.g. 'LT:25:GT:15' to ['LT:25', 'GT:15']\nexport const parseConditionsStringToArray = conditionsString => (conditionsString === null || conditionsString === void 0 ? void 0 : conditionsString.match(/[^:]+:[^:]+/g)) || conditionsString || []; // parse e.g. ['LT:25', 'GT:15'] to 'LT:25:GT:15'\n\nexport const parseConditionsArrayToString = conditionsArray => conditionsArray.join(':');\nexport const NULL_VALUE = 'NV';\nexport const OPERATOR_EQUAL = 'EQ';\nexport const OPERATOR_GREATER = 'GT';\nexport const OPERATOR_GREATER_OR_EQUAL = 'GE';\nexport const OPERATOR_LESS = 'LT';\nexport const OPERATOR_LESS_OR_EQUAL = 'LE';\nexport const OPERATOR_NOT_EQUAL = '!EQ';\nexport const OPERATOR_EMPTY = `EQ:${NULL_VALUE}`;\nexport const OPERATOR_NOT_EMPTY = `NE:${NULL_VALUE}`;\nexport const OPERATOR_IN = 'IN';\nexport const OPERATOR_CONTAINS = 'LIKE';\nexport const OPERATOR_NOT_CONTAINS = '!LIKE';\nexport const CASE_INSENSITIVE_PREFIX = 'I';\nexport const NOT_PREFIX = '!';","import { getAvailableAxes, getAxisNameByLayoutType, getLayoutTypeByVisType } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { SplitButton, FlyoutMenu, MenuItem, Button } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acAddUiLayoutDimensions } from '../../../actions/ui.js';\nimport { sGetUiActiveModalDialog, sGetUiType } from '../../../reducers/ui.js';\nexport const AddToLayoutButton = ({\n  dialogId,\n  visType,\n  onAddDimension,\n  onClick,\n  dataTest\n}) => {\n  const availableAxes = getAvailableAxes(visType);\n  const AddToLayoutButton = availableAxes.length > 1 ? SplitButton : Button;\n\n  const clickHandler = axisId => {\n    onAddDimension({\n      [dialogId]: {\n        axisId\n      }\n    });\n    onClick();\n  };\n\n  const renderMenu = () => /*#__PURE__*/React.createElement(FlyoutMenu, {\n    maxWidth: \"380px\",\n    dataTest: `${dataTest}-flyout-menu`\n  }, getAvailableAxes(visType).slice(1).map(axis => /*#__PURE__*/React.createElement(MenuItem, {\n    key: axis,\n    dataTest: `${dataTest}-flyout-menu-option-${axis}`,\n    onClick: () => clickHandler(axis),\n    label: i18n.t(`Add to {{axisName}}`, {\n      axisName: getAxisNameByLayoutType(axis, getLayoutTypeByVisType(visType))\n    })\n  })));\n\n  return /*#__PURE__*/React.createElement(AddToLayoutButton, {\n    component: availableAxes.length > 1 ? renderMenu() : null,\n    onClick: () => clickHandler(availableAxes[0]),\n    primary: true,\n    dataTest: dataTest\n  }, i18n.t(`Add to {{axisName}}`, {\n    axisName: getAxisNameByLayoutType(availableAxes[0], getLayoutTypeByVisType(visType))\n  }));\n};\nAddToLayoutButton.propTypes = {\n  dialogId: PropTypes.string.isRequired,\n  visType: PropTypes.string.isRequired,\n  onAddDimension: PropTypes.func.isRequired,\n  onClick: PropTypes.func.isRequired,\n  dataTest: PropTypes.string\n};\n\nconst mapStateToProps = state => ({\n  visType: sGetUiType(state),\n  dialogId: sGetUiActiveModalDialog(state)\n});\n\nexport default connect(mapStateToProps, {\n  onAddDimension: acAddUiLayoutDimensions\n})(AddToLayoutButton);","import i18n from '@dhis2/d2-i18n';\nimport { Modal, ModalContent, ModalActions, ButtonStrip, ModalTitle, Button } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport AddToLayoutButton from './AddToLayoutButton/AddToLayoutButton.js';\nimport classes from './styles/DimensionModal.module.css';\n\nconst DimensionModal = ({\n  children,\n  dataTest,\n  isInLayout,\n  onClose,\n  onUpdate,\n  title\n}) => /*#__PURE__*/React.createElement(Modal, {\n  onClose: onClose,\n  dataTest: `${dataTest}`,\n  position: \"top\",\n  large: true\n}, /*#__PURE__*/React.createElement(ModalTitle, {\n  dataTest: `${dataTest}-title}`\n}, title), /*#__PURE__*/React.createElement(ModalContent, {\n  dataTest: `${dataTest}-content`,\n  className: classes.modalContent\n}, children), /*#__PURE__*/React.createElement(ModalActions, {\n  dataTest: `${dataTest}-actions`\n}, /*#__PURE__*/React.createElement(ButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n  type: \"button\",\n  secondary: true,\n  onClick: onClose,\n  dataTest: `${dataTest}-action-cancel`\n}, i18n.t('Hide')), isInLayout ? /*#__PURE__*/React.createElement(Button, {\n  onClick: onUpdate,\n  type: \"button\",\n  primary: true,\n  dataTest: `${dataTest}-action-confirm`\n}, i18n.t('Update')) : /*#__PURE__*/React.createElement(AddToLayoutButton, {\n  onClick: () => alert('add to layout'),\n  dataTest: `${dataTest}-action-confirm`\n}))));\n\nDimensionModal.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  onUpdate: PropTypes.func.isRequired,\n  children: PropTypes.node,\n  dataTest: PropTypes.string,\n  isInLayout: PropTypes.bool,\n  title: PropTypes.node\n};\nexport default DimensionModal;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { SingleSelectField, SingleSelectOption, Button, Input, Checkbox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useEffect } from 'react';\nimport { NULL_VALUE, OPERATOR_CONTAINS, OPERATOR_EMPTY, OPERATOR_EQUAL, OPERATOR_NOT_CONTAINS, OPERATOR_NOT_EMPTY, OPERATOR_NOT_EQUAL, CASE_INSENSITIVE_PREFIX, NOT_PREFIX } from '../../../modules/conditions.js';\nimport classes from './styles/Condition.module.css';\nconst operators = {\n  [OPERATOR_EQUAL]: i18n.t('exactly'),\n  [OPERATOR_NOT_EQUAL]: i18n.t('is not'),\n  [OPERATOR_CONTAINS]: i18n.t('contains'),\n  [OPERATOR_NOT_CONTAINS]: i18n.t('does not contain'),\n  [OPERATOR_EMPTY]: i18n.t('is empty / null'),\n  [OPERATOR_NOT_EMPTY]: i18n.t('is not empty / not null')\n};\n\nconst prefixOperator = (operator, isCaseSensitive) => {\n  if (isCaseSensitive) {\n    // e.g. LIKE -> LIKE\n    return operator;\n  } else {\n    if (operator[0] === NOT_PREFIX) {\n      // e.g. !LIKE -> !ILIKE\n      return `${NOT_PREFIX}${CASE_INSENSITIVE_PREFIX}${operator.substring(1)}`;\n    } else {\n      // e.g. LIKE -> ILIKE\n      return `${CASE_INSENSITIVE_PREFIX}${operator}`;\n    }\n  }\n};\n\nconst unprefixOperator = operator => {\n  const isCaseSensitive = checkIsCaseSensitive(operator);\n\n  if (isCaseSensitive) {\n    // e.g. LIKE -> LIKE, !LIKE -> !LIKE\n    return operator;\n  } else {\n    if (operator[0] === NOT_PREFIX) {\n      // e.g. !ILIKE -> !LIKE\n      return `${NOT_PREFIX}${operator.substring(2)}`;\n    } else {\n      // e.g. ILIKE -> LIKE\n      return `${operator.substring(1)}`;\n    }\n  }\n};\n\nconst checkIsCaseSensitive = operator => {\n  if (operator[0] === NOT_PREFIX) {\n    // !LIKE, !ILIKE, !EQ, !IEQ\n    return operator[1] !== CASE_INSENSITIVE_PREFIX;\n  } else {\n    // LIKE, ILIKE, EQ, IEQ\n    return operator[0] !== CASE_INSENSITIVE_PREFIX;\n  }\n};\n\nconst BaseCondition = ({\n  condition,\n  onChange,\n  onRemove,\n  allowCaseSensitive\n}) => {\n  let operator, value, isCaseSensitive;\n  useEffect(() => {\n    if (!(condition !== null && condition !== void 0 && condition.length)) {\n      onChange(`${CASE_INSENSITIVE_PREFIX}:`);\n    }\n  }, [condition]);\n\n  if (condition.includes(NULL_VALUE)) {\n    operator = condition;\n  } else {\n    const parts = condition.split(':');\n    isCaseSensitive = checkIsCaseSensitive(parts[0]);\n    operator = unprefixOperator(parts[0]);\n    value = parts[1];\n  }\n\n  const setOperator = input => {\n    if (input.includes(NULL_VALUE)) {\n      onChange(`${input}`);\n    } else {\n      onChange(`${prefixOperator(input, isCaseSensitive)}:${value || ''}`);\n    }\n  };\n\n  const setValue = input => {\n    onChange(`${prefixOperator(operator, isCaseSensitive)}:${input || ''}`);\n  };\n\n  const toggleCaseSensitive = cs => {\n    onChange(`${prefixOperator(operator, cs)}:${value || ''}`);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(SingleSelectField, {\n    selected: operator,\n    inputWidth: \"180px\",\n    placeholder: i18n.t('Choose a condition type'),\n    dense: true,\n    onChange: ({\n      selected\n    }) => setOperator(selected)\n  }, Object.keys(operators).map(key => /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: key,\n    value: key,\n    label: operators[key]\n  }))), operator && !operator.includes(NULL_VALUE) && /*#__PURE__*/React.createElement(Input, {\n    value: value,\n    type: \"text\",\n    onChange: ({\n      value\n    }) => setValue(value),\n    width: \"150px\",\n    dense: true\n  }), allowCaseSensitive && ![OPERATOR_EMPTY, OPERATOR_NOT_EMPTY].includes(operator) && /*#__PURE__*/React.createElement(Checkbox, {\n    checked: isCaseSensitive,\n    label: i18n.t('Case sensitive'),\n    onChange: ({\n      checked\n    }) => toggleCaseSensitive(checked),\n    dense: true,\n    className: classes.caseSensitiveCheckbox\n  }), /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    small: true,\n    secondary: true,\n    onClick: onRemove,\n    className: classes.removeButton\n  }, i18n.t('Remove')));\n};\n\nBaseCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onRemove: PropTypes.func.isRequired,\n  allowCaseSensitive: PropTypes.bool\n};\nexport const AlphanumericCondition = props => /*#__PURE__*/React.createElement(BaseCondition, props);\nexport const CaseSensitiveAlphanumericCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  allowCaseSensitive: true\n}, props));","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { Checkbox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { OPERATOR_IN, NULL_VALUE } from '../../../modules/conditions.js';\nimport classes from './styles/Condition.module.css';\nconst TRUE_VALUE = '1';\nconst FALSE_VALUE = '0';\n\nconst BaseCondition = ({\n  condition,\n  onChange,\n  showFalseOption\n}) => {\n  const parts = condition.split(':');\n  const values = parts[1] || '';\n\n  const onCheckboxChange = (input, checked) => {\n    const currentValues = values.length ? values.split(';') : [];\n\n    if (checked) {\n      setValues([...currentValues, input].join(';'));\n    } else {\n      setValues(currentValues.filter(v => v !== input).join(';'));\n    }\n  };\n\n  const setValues = input => {\n    onChange(`${OPERATOR_IN}:${input || ''}`);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(Checkbox, {\n    checked: values.includes(TRUE_VALUE),\n    label: i18n.t('Yes'),\n    onChange: ({\n      checked\n    }) => onCheckboxChange(TRUE_VALUE, checked),\n    dense: true,\n    className: classes.checkboxOption\n  }), showFalseOption && /*#__PURE__*/React.createElement(Checkbox, {\n    checked: values.includes(FALSE_VALUE),\n    label: i18n.t('No'),\n    onChange: ({\n      checked\n    }) => onCheckboxChange(FALSE_VALUE, checked),\n    dense: true,\n    className: classes.checkboxOption\n  }), /*#__PURE__*/React.createElement(Checkbox, {\n    checked: values.includes(NULL_VALUE),\n    label: i18n.t('Not answered'),\n    onChange: ({\n      checked\n    }) => onCheckboxChange(NULL_VALUE, checked),\n    dense: true,\n    className: classes.checkboxOption\n  }));\n};\n\nBaseCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  showFalseOption: PropTypes.boolean\n};\nexport const BooleanCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  showFalseOption: true\n}, props));\nexport const TrueOnlyCondition = props => /*#__PURE__*/React.createElement(BaseCondition, props);","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { SingleSelectField, SingleSelectOption, Button, Input } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { NULL_VALUE, OPERATOR_EQUAL, OPERATOR_NOT_EQUAL, OPERATOR_GREATER, OPERATOR_GREATER_OR_EQUAL, OPERATOR_LESS, OPERATOR_LESS_OR_EQUAL, OPERATOR_EMPTY, OPERATOR_NOT_EMPTY } from '../../../modules/conditions.js';\nimport classes from './styles/Condition.module.css';\nconst TYPE_DATE = 'date';\nconst TYPE_DATETIME = 'datetime-local';\nconst TYPE_TIME = 'time';\nconst operators = {\n  [OPERATOR_EQUAL]: i18n.t('exactly'),\n  [OPERATOR_NOT_EQUAL]: i18n.t('is not'),\n  [OPERATOR_GREATER]: i18n.t('after'),\n  [OPERATOR_GREATER_OR_EQUAL]: i18n.t('after and including'),\n  [OPERATOR_LESS]: i18n.t('before'),\n  [OPERATOR_LESS_OR_EQUAL]: i18n.t('before or including'),\n  [OPERATOR_EMPTY]: i18n.t('is empty / null'),\n  [OPERATOR_NOT_EMPTY]: i18n.t('is not empty / not null')\n};\nconst API_TIME_DIVIDER = '.'; // TODO: Currently just picked a random character, use the correct character preferred by backend\n\nconst UI_TIME_DIVIDER = ':';\n\nconst BaseCondition = ({\n  condition,\n  onChange,\n  onRemove,\n  type\n}) => {\n  let operator, value;\n\n  if (condition.includes(NULL_VALUE)) {\n    operator = condition;\n  } else {\n    const parts = condition.split(':');\n    operator = parts[0];\n    value = parts[1];\n  }\n\n  const setOperator = input => {\n    if (input.includes(NULL_VALUE)) {\n      onChange(`${input}`);\n    } else {\n      onChange(`${input}:${value || ''}`);\n    }\n  };\n\n  const setValue = input => {\n    onChange(`${operator}:${input.replaceAll(UI_TIME_DIVIDER, API_TIME_DIVIDER) || ''}`);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(SingleSelectField, {\n    selected: operator,\n    inputWidth: \"180px\",\n    placeholder: i18n.t('Choose a condition type'),\n    dense: true,\n    onChange: ({\n      selected\n    }) => setOperator(selected)\n  }, Object.keys(operators).map(key => /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: key,\n    value: key,\n    label: operators[key]\n  }))), operator && !operator.includes(NULL_VALUE) && /*#__PURE__*/React.createElement(Input, {\n    value: value.replaceAll(API_TIME_DIVIDER, UI_TIME_DIVIDER),\n    type: type,\n    onChange: ({\n      value\n    }) => setValue(value),\n    width: \"150px\",\n    dense: true\n  }), /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    small: true,\n    secondary: true,\n    onClick: onRemove,\n    className: classes.removeButton\n  }, i18n.t('Remove')));\n};\n\nBaseCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onRemove: PropTypes.func.isRequired\n};\nexport const DateCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  type: TYPE_DATE\n}, props));\nexport const DateTimeCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  type: TYPE_DATETIME\n}, props));\nexport const TimeCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  type: TYPE_TIME\n}, props));","import { DIMENSION_TYPE_DATA_ELEMENT, DIMENSION_TYPE_PROGRAM_ATTRIBUTE, DIMENSION_TYPE_PROGRAM_INDICATOR } from '../modules/visualization.js';\nconst dataElementsQuery = {\n  resource: 'dataElements',\n  id: ({\n    id\n  }) => id,\n  params: {\n    fields: 'legendSets[id,name]'\n  }\n};\nconst trackedEntityAttributesQuery = {\n  resource: 'trackedEntityAttributes',\n  id: ({\n    id\n  }) => id,\n  params: {\n    fields: 'legendSets[id,name]'\n  }\n};\nconst programIndicatorsQuery = {\n  resource: 'programIndicators',\n  id: ({\n    id\n  }) => id,\n  params: {\n    fields: 'legendSets[id,name]'\n  }\n};\nconst legendSetsQuery = {\n  resource: 'legendSets',\n  id: ({\n    id\n  }) => id,\n  params: {\n    fields: ['id', 'displayName~rename(name)', 'legends[id,displayName~rename(name),startValue,endValue]'],\n    paging: 'false'\n  }\n};\nexport const apiFetchLegendSetById = async ({\n  dataEngine,\n  id\n}) => {\n  const response = await dataEngine.query({\n    legendSet: legendSetsQuery\n  }, {\n    variables: {\n      id\n    },\n    onError: error => console.log('Error: ', error)\n  });\n  return response.legendSet;\n};\nexport const apiFetchLegendSetsByDimension = async ({\n  dataEngine,\n  dimensionId,\n  dimensionType\n}) => {\n  let query;\n\n  switch (dimensionType) {\n    case DIMENSION_TYPE_DATA_ELEMENT:\n      query = dataElementsQuery;\n      break;\n\n    case DIMENSION_TYPE_PROGRAM_ATTRIBUTE:\n      query = trackedEntityAttributesQuery;\n      break;\n\n    case DIMENSION_TYPE_PROGRAM_INDICATOR:\n      query = programIndicatorsQuery;\n      break;\n\n    default:\n      throw new Error(`${dimensionType} is not a valid dimension type`);\n  }\n\n  const response = await dataEngine.query({\n    legendSets: query\n  }, {\n    variables: {\n      id: dimensionId\n    },\n    onError: error => console.log('Error: ', error)\n  });\n  return response.legendSets.legendSets;\n};","import { useDataEngine } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { SingleSelectField, SingleSelectOption, Button, Input, MultiSelectField, MultiSelectOption, MenuDivider } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { acAddMetadata } from '../../../actions/metadata.js';\nimport { apiFetchLegendSetById, apiFetchLegendSetsByDimension } from '../../../api/legendSets.js';\nimport { OPERATOR_EQUAL, OPERATOR_GREATER, OPERATOR_GREATER_OR_EQUAL, OPERATOR_LESS, OPERATOR_LESS_OR_EQUAL, OPERATOR_NOT_EQUAL, OPERATOR_EMPTY, OPERATOR_NOT_EMPTY, OPERATOR_IN } from '../../../modules/conditions.js';\nimport { sGetMetadataById } from '../../../reducers/metadata.js';\nimport classes from './styles/Condition.module.css';\nconst NULL_VALUE = 'NV';\nconst operators = {\n  [OPERATOR_EQUAL]: i18n.t('equal to (=)'),\n  [OPERATOR_GREATER]: i18n.t('greater than (>)'),\n  [OPERATOR_GREATER_OR_EQUAL]: i18n.t('greater than or equal to (≥)'),\n  [OPERATOR_LESS]: i18n.t('less than (<)'),\n  [OPERATOR_LESS_OR_EQUAL]: i18n.t('less than or equal to (≤)'),\n  [OPERATOR_NOT_EQUAL]: i18n.t('not equal to (≠)'),\n  [OPERATOR_EMPTY]: i18n.t('is empty / null'),\n  [OPERATOR_NOT_EMPTY]: i18n.t('is not empty / not null')\n};\n\nconst NumericCondition = ({\n  condition,\n  onChange,\n  onRemove,\n  legendSetId,\n  numberOfConditions,\n  onLegendSetChange,\n  enableDecimalSteps,\n  dimension\n}) => {\n  var _legendSet$legends, _value, _legendSet$legends2;\n\n  let operator, value;\n  const dispatch = useDispatch();\n  const availableLegendSets = useSelector(state => {\n    var _sGetMetadataById;\n\n    return (_sGetMetadataById = sGetMetadataById(state, dimension.id)) === null || _sGetMetadataById === void 0 ? void 0 : _sGetMetadataById.legendSets;\n  });\n\n  const setAvailableLegendSets = legendSets => dispatch(acAddMetadata({\n    [dimension.id]: {\n      legendSets\n    }\n  }));\n\n  const legendSet = useSelector(state => sGetMetadataById(state, legendSetId));\n\n  const setLegendSet = input => dispatch(acAddMetadata({\n    [input.id]: input\n  }));\n\n  const dataEngine = useDataEngine();\n\n  const fetchLegendSets = async () => {\n    const result = await apiFetchLegendSetsByDimension({\n      dataEngine,\n      dimensionId: dimension.id,\n      dimensionType: dimension.dimensionType\n    });\n    setAvailableLegendSets(result);\n  };\n\n  useEffect(() => {\n    if (operator === OPERATOR_IN && !availableLegendSets) {\n      fetchLegendSets();\n    }\n  }, []);\n\n  if (condition.includes(NULL_VALUE)) {\n    operator = condition;\n  } else if (legendSetId && !condition) {\n    operator = OPERATOR_IN;\n  } else {\n    const parts = condition.split(':');\n    operator = parts[0];\n    value = parts[1];\n  }\n\n  const onOperatorChange = input => {\n    if (input === OPERATOR_IN && !availableLegendSets) {\n      fetchLegendSets();\n    }\n\n    setOperator(input);\n  };\n\n  const setOperator = input => {\n    if (input.includes(NULL_VALUE)) {\n      onChange(`${input}`);\n    } else if (input === OPERATOR_IN || operator === OPERATOR_IN) {\n      onChange(`${input}:`);\n    } else {\n      onChange(`${input}:${value || ''}`);\n    }\n\n    if (!input.includes(OPERATOR_IN) && legendSetId) {\n      onLegendSetChange();\n    }\n  };\n\n  useEffect(() => {\n    const fetchLegendSet = async () => {\n      const result = await apiFetchLegendSetById({\n        dataEngine,\n        id: legendSetId\n      });\n      setLegendSet(result);\n    };\n\n    if (legendSetId && !legendSet) {\n      fetchLegendSet();\n    }\n  }, [legendSetId]);\n\n  const setValue = input => onChange(`${operator}:${input || ''}`);\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(SingleSelectField, {\n    selected: operator,\n    inputWidth: \"180px\",\n    placeholder: i18n.t('Choose a condition type'),\n    dense: true,\n    onChange: ({\n      selected\n    }) => onOperatorChange(selected)\n  }, Object.keys(operators).map(key => /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: key,\n    value: key,\n    label: operators[key]\n  })), /*#__PURE__*/React.createElement(MenuDivider, {\n    dense: true\n  }), /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: OPERATOR_IN,\n    value: OPERATOR_IN,\n    label: i18n.t('is one of preset options'),\n    disabled: numberOfConditions > 1\n  })), operator && !operator.includes(NULL_VALUE) && operator !== OPERATOR_IN && /*#__PURE__*/React.createElement(Input, {\n    value: value,\n    type: \"number\",\n    onChange: ({\n      value\n    }) => setValue(value),\n    width: \"150px\",\n    dense: true,\n    step: enableDecimalSteps ? '0.1' : '1'\n  }), operator === OPERATOR_IN && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(SingleSelectField, {\n    selected: availableLegendSets && legendSetId,\n    inputWidth: \"136px\",\n    placeholder: !availableLegendSets ? i18n.t('Loading...') : i18n.t('Choose a set of options'),\n    dense: true,\n    onChange: ({\n      selected\n    }) => {\n      onLegendSetChange(selected);\n      setValue(null);\n    },\n    loading: !availableLegendSets\n  }, availableLegendSets === null || availableLegendSets === void 0 ? void 0 : availableLegendSets.map(item => /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: item.id,\n    value: item.id,\n    label: item.name\n  }))), legendSetId && /*#__PURE__*/React.createElement(MultiSelectField, {\n    placeholder: !legendSet ? i18n.t('Loading...') : i18n.t('Choose options'),\n    onChange: ({\n      selected\n    }) => setValue(selected.join(';')),\n    inputWidth: \"330px\",\n    selected: (legendSet === null || legendSet === void 0 ? void 0 : (_legendSet$legends = legendSet.legends) === null || _legendSet$legends === void 0 ? void 0 : _legendSet$legends.length) && ((_value = value) === null || _value === void 0 ? void 0 : _value.length) && value.split(';') || [],\n    dense: true,\n    loading: !legendSet\n  }, (legendSet === null || legendSet === void 0 ? void 0 : (_legendSet$legends2 = legendSet.legends) === null || _legendSet$legends2 === void 0 ? void 0 : _legendSet$legends2.length) && legendSet.legends.sort((a, b) => a.startValue - b.startValue).map(legend => /*#__PURE__*/React.createElement(MultiSelectOption, {\n    key: legend.id,\n    value: legend.id,\n    label: legend.name\n  })))), /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    small: true,\n    secondary: true,\n    onClick: onRemove,\n    className: classes.removeButton\n  }, i18n.t('Remove')));\n};\n\nNumericCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  numberOfConditions: PropTypes.number.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onLegendSetChange: PropTypes.func.isRequired,\n  onRemove: PropTypes.func.isRequired,\n  dimension: PropTypes.shape({\n    dimensionType: PropTypes.string,\n    id: PropTypes.string\n  }),\n  enableDecimalSteps: PropTypes.bool,\n  legendSetId: PropTypes.string\n};\nexport default NumericCondition;","const optionsQuery = {\n  resource: 'options',\n  params: ({\n    optionSetId,\n    searchTerm,\n    nameProp,\n    page\n  }) => {\n    const filters = [`optionSet.id:eq:${optionSetId}`];\n\n    if (searchTerm) {\n      filters.push(`${nameProp}:ilike:${searchTerm}`);\n    }\n\n    return {\n      fields: 'code,name,id',\n      filter: filters,\n      paging: true,\n      page\n    };\n  }\n};\nexport const apiFetchOptions = async ({\n  dataEngine,\n  searchTerm,\n  nameProp,\n  optionSetId,\n  page\n}) => {\n  const optionsData = await dataEngine.query({\n    options: optionsQuery\n  }, {\n    variables: {\n      searchTerm,\n      nameProp,\n      optionSetId,\n      page\n    },\n    onError: error => console.log('Error: ', error)\n  });\n  const response = optionsData.options;\n  return {\n    options: response.options,\n    nextPage: response.pager.nextPage ? response.pager.page + 1 : null\n  };\n};","import { useState, useEffect, useRef } from 'react';\nconst DEFAULT_USER_INPUT_DELAY = 500;\nexport const useDebounce = (value, delay = DEFAULT_USER_INPUT_DELAY) => {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n  return debouncedValue;\n};\nexport const useDidUpdateEffect = (fn, inputs) => {\n  const didMountRef = useRef(false);\n  useEffect(() => {\n    if (didMountRef.current) {\n      fn();\n    } else {\n      didMountRef.current = true;\n    }\n  }, inputs);\n};","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { InputField, Transfer, TransferOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { acAddMetadata } from '../../../actions/metadata.js';\nimport { apiFetchOptions } from '../../../api/options.js';\nimport { OPERATOR_IN } from '../../../modules/conditions.js';\nimport { useDebounce, useDidUpdateEffect } from '../../../modules/utils.js';\nimport { sGetMetadata } from '../../../reducers/metadata.js';\nimport { sGetSettingsDisplayNameProperty } from '../../../reducers/settings.js';\nimport classes from './styles/Condition.module.css';\n\nconst LeftHeader = ({\n  searchTerm,\n  setSearchTerm,\n  dataTest\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: classes.transferLeftHeader\n}, /*#__PURE__*/React.createElement(\"p\", {\n  className: classes.transferLeftTitle\n}, i18n.t('Available options')), /*#__PURE__*/React.createElement(InputField, {\n  value: searchTerm,\n  onChange: ({\n    value\n  }) => setSearchTerm(value),\n  placeholder: i18n.t('Filter options'),\n  dataTest: `${dataTest}-filter-input-field`,\n  dense: true,\n  initialFocus: true,\n  type: 'search'\n}));\n\nLeftHeader.propTypes = {\n  dataTest: PropTypes.string,\n  searchTerm: PropTypes.string,\n  setSearchTerm: PropTypes.func\n};\n\nconst EmptySelection = () => /*#__PURE__*/React.createElement(\"p\", {\n  className: classes.transferEmptyList\n}, i18n.t('No items selected'));\n\nconst RightHeader = () => /*#__PURE__*/React.createElement(\"p\", {\n  className: classes.transferRightHeader\n}, i18n.t('Selected options'));\n\nconst SourceEmptyPlaceholder = ({\n  loading,\n  searchTerm,\n  options,\n  dataTest\n}) => !loading && !options.length && /*#__PURE__*/React.createElement(\"p\", {\n  className: classes.transferEmptyList,\n  \"data-test\": dataTest\n}, searchTerm ? i18n.t('Nothing found for \"{{- searchTerm}}\"', {\n  searchTerm: searchTerm\n}) : i18n.t('No options'));\n\nSourceEmptyPlaceholder.propTypes = {\n  dataTest: PropTypes.string,\n  loading: PropTypes.bool,\n  options: PropTypes.array,\n  searchTerm: PropTypes.string\n};\n\nconst OptionSetCondition = ({\n  condition,\n  optionSetId,\n  onChange,\n  displayNameProp,\n  metadata,\n  addMetadata\n}) => {\n  var _parts$;\n\n  const parts = condition.split(':');\n  const values = (_parts$ = parts[1]) !== null && _parts$ !== void 0 && _parts$.length ? parts[1].split(';') : [];\n  const selectedOptions = values.map(code => ({\n    code,\n    name: Object.values(metadata).find(item => item.code === code).name\n  }));\n  const dataTest = 'option-set';\n\n  const setValues = selected => {\n    addMetadata(state.options.filter(item => selected.includes(item.code) && !selectedOptions.find(so => so.code === item.code)).reduce((acc, item) => ({ ...acc,\n      [item.id]: item\n    }), {}));\n    onChange(`${OPERATOR_IN}:${selected.join(';') || ''}`);\n  };\n\n  const [state, setState] = useState({\n    searchTerm: '',\n    options: [],\n    loading: true,\n    nextPage: 1\n  });\n  const dataEngine = useDataEngine();\n\n  const setSearchTerm = searchTerm => setState(state => ({ ...state,\n    searchTerm\n  }));\n\n  const debouncedSearchTerm = useDebounce(state.searchTerm);\n\n  const fetchItems = async page => {\n    var _result$options;\n\n    setState(state => ({ ...state,\n      loading: true\n    }));\n    const result = await apiFetchOptions({\n      dataEngine,\n      nameProp: displayNameProp,\n      page,\n      optionSetId,\n      searchTerm: state.searchTerm\n    });\n    const newOptions = [];\n    (_result$options = result.options) === null || _result$options === void 0 ? void 0 : _result$options.forEach(item => {\n      newOptions.push({\n        name: item.name,\n        code: item.code,\n        id: item.id\n      });\n    });\n    setState(state => ({ ...state,\n      loading: false,\n      options: page > 1 ? [...state.options, ...newOptions] : newOptions,\n      nextPage: result.nextPage\n    }));\n    /*  The following handles a very specific edge-case where the user can select all items from a \n        page and then reopen the modal. Usually Transfer triggers the onEndReached when the end of \n        the page is reached (scrolling down) or if too few items are on the left side (e.g. selecting \n        49 items from page 1, leaving only 1 item on the left side). However, due to the way Transfer \n        works, if 0 items are available, more items are fetched, but all items are already selected \n        (leaving 0 items on the left side still), the onReachedEnd won't trigger. Hence the code below:\n        IF there is a next page AND some options were just fetched AND you have the same or more\n        selected items than fetched items AND all fetched items are already selected -> fetch more!\n    */\n\n    if (result.nextPage && newOptions.length && selectedOptions.length >= newOptions.length && newOptions.every(newOption => selectedOptions.find(selectedItem => selectedItem.value === newOption.value))) {\n      fetchItems(result.nextPage);\n    }\n  };\n\n  useDidUpdateEffect(() => {\n    setState(state => ({ ...state,\n      loading: true,\n      nextPage: 1\n    }));\n    fetchItems(1);\n  }, [debouncedSearchTerm, state.filter]);\n\n  const onEndReached = () => {\n    if (state.nextPage) {\n      fetchItems(state.nextPage);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(Transfer, {\n    onChange: ({\n      selected\n    }) => setValues(selected),\n    selected: selectedOptions.map(option => option.code),\n    options: [...state.options, ...selectedOptions].map(option => ({\n      value: option.code,\n      label: option.name\n    })),\n    loading: state.loading,\n    loadingPicked: state.loading,\n    sourceEmptyPlaceholder: /*#__PURE__*/React.createElement(SourceEmptyPlaceholder, {\n      loading: state.loading,\n      searchTerm: debouncedSearchTerm,\n      options: state.options,\n      dataTest: `${dataTest}-empty-source`\n    }),\n    onEndReached: onEndReached,\n    leftHeader: /*#__PURE__*/React.createElement(LeftHeader, {\n      searchTerm: state.searchTerm,\n      setSearchTerm: setSearchTerm,\n      dataTest: `${dataTest}-left-header`\n    }),\n    height: '340px',\n    selectedEmptyComponent: /*#__PURE__*/React.createElement(EmptySelection, null),\n    rightHeader: /*#__PURE__*/React.createElement(RightHeader, null),\n    renderOption: props => /*#__PURE__*/React.createElement(TransferOption, _extends({}, props, {\n      dataTest: `${dataTest}-transfer-option`\n    })),\n    dataTest: `${dataTest}-transfer`\n  });\n};\n\nOptionSetCondition.propTypes = {\n  addMetadata: PropTypes.func.isRequired,\n  condition: PropTypes.string.isRequired,\n  displayNameProp: PropTypes.string.isRequired,\n  metadata: PropTypes.object.isRequired,\n  optionSetId: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = state => ({\n  displayNameProp: sGetSettingsDisplayNameProperty(state),\n  metadata: sGetMetadata(state)\n});\n\nexport default connect(mapStateToProps, {\n  addMetadata: acAddMetadata\n})(OptionSetCondition);","import { OrganisationUnitTree } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acAddMetadata } from '../../../actions/metadata.js';\nimport { acAddParentGraphMap } from '../../../actions/ui.js';\nimport { OPERATOR_EQUAL } from '../../../modules/conditions.js';\nimport { getOuPath, removeLastPathSegment } from '../../../modules/orgUnit.js';\nimport { sGetMetadata } from '../../../reducers/metadata.js';\nimport { sGetRootOrgUnits, sGetSettingsDisplayNameProperty } from '../../../reducers/settings.js';\nimport { sGetUiParentGraphMap } from '../../../reducers/ui.js';\n\nconst OrgUnitCondition = ({\n  addMetadata,\n  addParentGraphMap,\n  condition,\n  onChange,\n  rootOrgUnits,\n  metadata,\n  parentGraphMap\n}) => {\n  var _parts$, _selected$path;\n\n  const parts = condition.split(':');\n  const value = ((_parts$ = parts[1]) === null || _parts$ === void 0 ? void 0 : _parts$.length) && parts[1];\n\n  const setValues = item => {\n    if (item.checked) {\n      const forMetadata = {};\n      const forParentGraphMap = {};\n      forMetadata[item.id] = {\n        id: item.id,\n        name: item.name || item.displayName,\n        displayName: item.displayName\n      };\n\n      if (item.path) {\n        const path = removeLastPathSegment(item.path);\n        forParentGraphMap[item.id] = path === `/${item.id}` ? '' : path.replace(/^\\//, '');\n      }\n\n      addMetadata(forMetadata);\n      addParentGraphMap(forParentGraphMap);\n      onChange(`${OPERATOR_EQUAL}:${item.id}`);\n    } else {\n      onChange('');\n    }\n  };\n\n  const selected = value ? {\n    id: value,\n    name: metadata[value].displayName || metadata[value].name,\n    path: getOuPath(value, metadata, parentGraphMap)\n  } : {};\n  const roots = rootOrgUnits.map(rootOrgUnit => rootOrgUnit.id);\n  return /*#__PURE__*/React.createElement(OrganisationUnitTree, {\n    roots: roots,\n    initiallyExpanded: [...(roots.length === 1 ? [`/${roots[0]}`] : []), selected === null || selected === void 0 ? void 0 : (_selected$path = selected.path) === null || _selected$path === void 0 ? void 0 : _selected$path.substring(0, selected.path.lastIndexOf('/'))].filter(path => path),\n    selected: selected.path && [selected.path],\n    onChange: item => setValues(item),\n    dataTest: 'org-unit-tree',\n    singleSelection: true\n  });\n};\n\nOrgUnitCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  addMetadata: PropTypes.func,\n  addParentGraphMap: PropTypes.func,\n  metadata: PropTypes.object,\n  parentGraphMap: PropTypes.object,\n  rootOrgUnits: PropTypes.array\n};\nOrgUnitCondition.defaultProps = {\n  rootOrgUnits: []\n};\n\nconst mapStateToProps = state => ({\n  displayNameProp: sGetSettingsDisplayNameProperty(state),\n  metadata: sGetMetadata(state),\n  rootOrgUnits: sGetRootOrgUnits(state),\n  parentGraphMap: sGetUiParentGraphMap(state)\n});\n\nexport default connect(mapStateToProps, {\n  addMetadata: acAddMetadata,\n  addParentGraphMap: acAddParentGraphMap\n})(OrgUnitCondition);","import i18n from '@dhis2/d2-i18n';\nimport { Button, IconInfo16, Tooltip } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { tSetCurrentFromUi } from '../../../actions/current.js';\nimport { acSetUiConditions } from '../../../actions/ui.js';\nimport { OPERATOR_IN, parseConditionsArrayToString, parseConditionsStringToArray } from '../../../modules/conditions.js';\nimport { DIMENSION_TYPE_PROGRAM_INDICATOR } from '../../../modules/visualization.js';\nimport { sGetMetadata } from '../../../reducers/metadata.js';\nimport { sGetSettingsDisplayNameProperty } from '../../../reducers/settings.js';\nimport { sGetDimensionIdsFromLayout, sGetUiConditionsByDimension } from '../../../reducers/ui.js';\nimport DimensionModal from '../DimensionModal.js';\nimport { AlphanumericCondition, CaseSensitiveAlphanumericCondition } from './AlphanumericCondition.js';\nimport { BooleanCondition, TrueOnlyCondition } from './BooleanCondition.js';\nimport { DateCondition, DateTimeCondition, TimeCondition } from './DateCondition.js';\nimport NumericCondition from './NumericCondition.js';\nimport OptionSetCondition from './OptionSetCondition.js';\nimport OrgUnitCondition from './OrgUnitCondition.js';\nimport classes from './styles/ConditionsManager.module.css';\nconst VALUE_TYPE_NUMBER = 'NUMBER';\nconst VALUE_TYPE_UNIT_INTERVAL = 'UNIT_INTERVAL';\nconst VALUE_TYPE_PERCENTAGE = 'PERCENTAGE';\nconst VALUE_TYPE_INTEGER = 'INTEGER';\nconst VALUE_TYPE_INTEGER_POSITIVE = 'INTEGER_POSITIVE';\nconst VALUE_TYPE_INTEGER_NEGATIVE = 'INTEGER_NEGATIVE';\nconst VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE = 'INTEGER_ZERO_OR_POSITIVE';\nconst VALUE_TYPE_TEXT = 'TEXT';\nconst VALUE_TYPE_LONG_TEXT = 'LONG_TEXT';\nconst VALUE_TYPE_LETTER = 'LETTER';\nconst VALUE_TYPE_PHONE_NUMBER = 'PHONE_NUMBER';\nconst VALUE_TYPE_EMAIL = 'EMAIL';\nconst VALUE_TYPE_USERNAME = 'USERNAME';\nconst VALUE_TYPE_URL = 'URL';\nconst VALUE_TYPE_BOOLEAN = 'BOOLEAN';\nconst VALUE_TYPE_TRUE_ONLY = 'TRUE_ONLY';\nconst VALUE_TYPE_DATE = 'DATE';\nconst VALUE_TYPE_TIME = 'TIME';\nconst VALUE_TYPE_DATETIME = 'DATETIME';\nconst VALUE_TYPE_ORGANISATION_UNIT = 'ORGANISATION_UNIT';\nconst NUMERIC_TYPES = [VALUE_TYPE_NUMBER, VALUE_TYPE_UNIT_INTERVAL, VALUE_TYPE_PERCENTAGE, VALUE_TYPE_INTEGER, VALUE_TYPE_INTEGER_POSITIVE, VALUE_TYPE_INTEGER_NEGATIVE, VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE];\nconst SINGLETON_TYPES = [VALUE_TYPE_BOOLEAN, VALUE_TYPE_TRUE_ONLY, VALUE_TYPE_ORGANISATION_UNIT];\nconst SUPPORTED_TYPES = [VALUE_TYPE_NUMBER, VALUE_TYPE_UNIT_INTERVAL, VALUE_TYPE_PERCENTAGE, VALUE_TYPE_INTEGER, VALUE_TYPE_INTEGER_POSITIVE, VALUE_TYPE_INTEGER_NEGATIVE, VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE, VALUE_TYPE_TEXT, VALUE_TYPE_LONG_TEXT, VALUE_TYPE_LETTER, VALUE_TYPE_PHONE_NUMBER, VALUE_TYPE_EMAIL, VALUE_TYPE_USERNAME, VALUE_TYPE_URL, VALUE_TYPE_BOOLEAN, VALUE_TYPE_TRUE_ONLY, VALUE_TYPE_DATE, VALUE_TYPE_TIME, VALUE_TYPE_DATETIME, VALUE_TYPE_ORGANISATION_UNIT];\nconst EMPTY_CONDITION = '';\n\nconst ConditionsManager = ({\n  conditions,\n  isInLayout,\n  onUpdate,\n  dimension,\n  onClose,\n  setConditionsByDimension\n}) => {\n  const valueType = dimension.valueType;\n  const isProgramIndicator = dimension.dimensionType === DIMENSION_TYPE_PROGRAM_INDICATOR;\n  const isOptionSetCondition = valueType === VALUE_TYPE_TEXT && dimension.optionSet;\n  const canHaveLegendSets = NUMERIC_TYPES.includes(valueType) || isProgramIndicator;\n  const isSupported = SUPPORTED_TYPES.includes(valueType) || isProgramIndicator;\n\n  const getInitConditions = () => {\n    var _conditions$condition;\n\n    return (_conditions$condition = conditions.condition) !== null && _conditions$condition !== void 0 && _conditions$condition.length ? parseConditionsStringToArray(conditions.condition) : null;\n  };\n\n  const getEmptyConditions = () => SINGLETON_TYPES.includes(valueType) || isOptionSetCondition || conditions.legendSet ? [EMPTY_CONDITION] : [];\n\n  const [conditionsList, setConditionsList] = useState(getInitConditions() || getEmptyConditions());\n  const [selectedLegendSet, setSelectedLegendSet] = useState(conditions.legendSet);\n\n  const addCondition = () => setConditionsList([...conditionsList, EMPTY_CONDITION]);\n\n  const removeCondition = conditionIndex => {\n    const filteredConditionsList = conditionsList.filter((_, index) => index !== conditionIndex);\n    setConditionsList(filteredConditionsList);\n\n    if (selectedLegendSet && !filteredConditionsList.some(condition => condition.includes(OPERATOR_IN))) {\n      setSelectedLegendSet(null);\n    }\n  };\n\n  const setCondition = (conditionIndex, value) => setConditionsList(conditionsList.map((condition, index) => index === conditionIndex ? value : condition));\n\n  const storeConditions = () => setConditionsByDimension({\n    inputCondition: parseConditionsArrayToString(conditionsList.filter(cnd => cnd.length && cnd.slice(-1) !== ':')),\n    dimension: dimension.id,\n    legendSet: selectedLegendSet\n  });\n\n  const primaryOnClick = () => {\n    storeConditions();\n    onUpdate();\n    onClose();\n  };\n\n  const closeModal = () => {\n    storeConditions();\n    onClose();\n  };\n\n  const renderConditionsContent = () => {\n    const getDividerContent = index => conditionsList.length > 1 && index < conditionsList.length - 1 && /*#__PURE__*/React.createElement(\"span\", {\n      className: classes.separator\n    }, i18n.t('and'));\n\n    if (isOptionSetCondition) {\n      return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n        key: index\n      }, /*#__PURE__*/React.createElement(OptionSetCondition, {\n        condition: condition,\n        optionSetId: dimension.optionSet,\n        onChange: value => setCondition(index, value)\n      })));\n    }\n\n    const renderNumericCondition = () => {\n      const enableDecimalSteps = valueType === VALUE_TYPE_UNIT_INTERVAL;\n      return (conditionsList.length && conditionsList || selectedLegendSet && ['']).map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n        key: index\n      }, /*#__PURE__*/React.createElement(NumericCondition, {\n        condition: condition,\n        onChange: value => setCondition(index, value),\n        onRemove: () => removeCondition(index),\n        numberOfConditions: conditionsList.length || (selectedLegendSet ? 1 : 0),\n        legendSetId: selectedLegendSet,\n        onLegendSetChange: value => setSelectedLegendSet(value),\n        enableDecimalSteps: enableDecimalSteps,\n        dimension: dimension\n      }), getDividerContent(index)));\n    };\n\n    if (isProgramIndicator) {\n      return renderNumericCondition();\n    }\n\n    switch (valueType) {\n      case VALUE_TYPE_NUMBER:\n      case VALUE_TYPE_UNIT_INTERVAL:\n      case VALUE_TYPE_PERCENTAGE:\n      case VALUE_TYPE_INTEGER:\n      case VALUE_TYPE_INTEGER_POSITIVE:\n      case VALUE_TYPE_INTEGER_NEGATIVE:\n      case VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE:\n        {\n          return renderNumericCondition();\n        }\n\n      case VALUE_TYPE_PHONE_NUMBER:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(AlphanumericCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_TEXT:\n      case VALUE_TYPE_LONG_TEXT:\n      case VALUE_TYPE_LETTER:\n      case VALUE_TYPE_EMAIL:\n      case VALUE_TYPE_USERNAME:\n      case VALUE_TYPE_URL:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(CaseSensitiveAlphanumericCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_BOOLEAN:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(BooleanCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value)\n          })));\n        }\n\n      case VALUE_TYPE_TRUE_ONLY:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(TrueOnlyCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value)\n          })));\n        }\n\n      case VALUE_TYPE_DATE:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(DateCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_TIME:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(TimeCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_DATETIME:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(DateTimeCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_ORGANISATION_UNIT:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(OrgUnitCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value)\n          })));\n        }\n    }\n  };\n\n  const disableAddButton = canHaveLegendSets && (conditionsList.some(condition => condition.includes(OPERATOR_IN)) || selectedLegendSet);\n  return dimension ? /*#__PURE__*/React.createElement(DimensionModal, {\n    dataTest: 'dialog-manager-modal',\n    isInLayout: isInLayout,\n    onClose: closeModal,\n    onUpdate: primaryOnClick,\n    title: dimension.name + ` | valueType: ${valueType}, dimensionType: ${dimension.dimensionType}` // FIXME: For testing only\n\n  }, /*#__PURE__*/React.createElement(\"div\", null, isSupported ? /*#__PURE__*/React.createElement(\"p\", {\n    className: classes.paragraph\n  }, i18n.t('Show items that meet the following conditions for this data item:')) : /*#__PURE__*/React.createElement(\"p\", {\n    className: classes.paragraph\n  }, i18n.t(\"This dimension can't be filtered. All values will be shown.\"))), isSupported && /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.mainSection\n  }, !conditionsList.length && !selectedLegendSet && !(SINGLETON_TYPES.includes(valueType) || isOptionSetCondition) ? /*#__PURE__*/React.createElement(\"p\", {\n    className: classes.paragraph\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.infoIcon\n  }, /*#__PURE__*/React.createElement(IconInfo16, null)), i18n.t('No conditions yet, so all values will be included. Add a condition to filter results.')) : renderConditionsContent(), !(SINGLETON_TYPES.includes(valueType) || isOptionSetCondition) && /*#__PURE__*/React.createElement(Tooltip, {\n    content: i18n.t('Preset options can’t be combined with other conditions'),\n    placement: \"bottom\",\n    closeDelay: 200\n  }, ({\n    onMouseOver,\n    onMouseOut,\n    ref\n  }) => /*#__PURE__*/React.createElement(\"span\", {\n    ref: ref,\n    onMouseOver: () => disableAddButton && onMouseOver(),\n    onMouseOut: () => disableAddButton && onMouseOut(),\n    className: classes.tooltipReference\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    small: true,\n    onClick: addCondition,\n    dataTest: 'conditions-manager-add-condition',\n    className: classes.addConditionButton,\n    disabled: disableAddButton\n  }, conditionsList.length ? i18n.t('Add another condition') : i18n.t('Add a condition')))))) : null;\n};\n\nConditionsManager.propTypes = {\n  conditions: PropTypes.object.isRequired,\n  dimension: PropTypes.object.isRequired,\n\n  /* eslint-disable-next-line react/no-unused-prop-types */\n  dimensionId: PropTypes.string.isRequired,\n  isInLayout: PropTypes.bool.isRequired,\n  legendSet: PropTypes.string,\n  setConditionsByDimension: PropTypes.func,\n  onClose: PropTypes.func,\n  onUpdate: PropTypes.func\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  dimension: sGetMetadata(state)[ownProps.dimensionId],\n  isInLayout: sGetDimensionIdsFromLayout(state).includes(ownProps.dimensionId),\n  conditions: sGetUiConditionsByDimension(state, ownProps.dimensionId) || {},\n  dimensionIdsInLayout: sGetDimensionIdsFromLayout(state),\n  displayNameProp: sGetSettingsDisplayNameProperty(state)\n});\n\nconst mapDispatchToProps = {\n  onUpdate: tSetCurrentFromUi,\n  setConditionsByDimension: acSetUiConditions\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(ConditionsManager);","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { OrgUnitDimension, ouIdHelper, DIMENSION_ID_ORGUNIT } from '@dhis2/analytics';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { tSetCurrentFromUi } from '../../actions/current.js';\nimport { acAddMetadata } from '../../actions/metadata.js';\nimport { acSetUiItems, acAddParentGraphMap } from '../../actions/ui.js';\nimport { removeLastPathSegment, getOuPath } from '../../modules/orgUnit.js';\nimport { sGetMetadata } from '../../reducers/metadata.js';\nimport { sGetRootOrgUnits } from '../../reducers/settings.js';\nimport { sGetUiItemsByDimension, sGetUiParentGraphMap, sGetDimensionIdsFromLayout } from '../../reducers/ui.js';\nimport DimensionModal from './DimensionModal.js';\nexport const FixedDimension = ({\n  addMetadata,\n  addParentGraphMap,\n  onClose,\n  dimensionId,\n  isInLayout,\n  metadata,\n  onUpdate,\n  ouIds,\n  parentGraphMap,\n  rootOrgUnits,\n  setUiItems\n}) => {\n  const selectUiItems = ({\n    dimensionId,\n    items\n  }) => {\n    setUiItems({\n      dimensionId,\n      itemIds: items.map(item => item.id)\n    });\n\n    switch (dimensionId) {\n      case DIMENSION_ID_ORGUNIT:\n        {\n          const forMetadata = {};\n          const forParentGraphMap = {};\n          items.forEach(ou => {\n            const id = ouIdHelper.removePrefix(ou.id);\n            forMetadata[id] = {\n              id,\n              name: ou.name || ou.displayName,\n              displayName: ou.displayName\n            };\n\n            if (ou.path) {\n              const path = removeLastPathSegment(ou.path);\n              forParentGraphMap[ou.id] = path === `/${ou.id}` ? '' : path.replace(/^\\//, '');\n            }\n          });\n          addMetadata(forMetadata);\n          addParentGraphMap(forParentGraphMap);\n          break;\n        }\n      // TODO: case DIMENSION_ID_PERIOD:\n    }\n  };\n\n  const closeModal = () => onClose();\n\n  const renderModalContent = () => {\n    switch (dimensionId) {\n      case DIMENSION_ID_ORGUNIT:\n        {\n          const dimensionProps = {\n            onSelect: selectUiItems\n          };\n          const selected = ouIds // TODO: Refactor to not depend on the whole metadata object, but pass in full ouObjects (mapped with metadata) instead of just ids\n          .filter(id => metadata[ouIdHelper.removePrefix(id)] !== undefined).map(id => {\n            const ouUid = ouIdHelper.removePrefix(id);\n            return {\n              id,\n              name: metadata[ouUid].displayName || metadata[ouUid].name,\n              path: getOuPath(ouUid, metadata, parentGraphMap)\n            };\n          });\n          const display = DIMENSION_ID_ORGUNIT === dimensionId ? 'block' : 'none';\n          return /*#__PURE__*/React.createElement(\"div\", {\n            key: DIMENSION_ID_ORGUNIT,\n            style: {\n              display\n            }\n          }, /*#__PURE__*/React.createElement(OrgUnitDimension, _extends({\n            selected: selected,\n            roots: rootOrgUnits.map(rootOrgUnit => rootOrgUnit.id)\n          }, dimensionProps)));\n        }\n      // TODO: case DIMENSION_ID_PERIOD:\n    }\n  };\n\n  const primaryOnClick = () => {\n    onUpdate();\n    closeModal();\n  };\n\n  const dimension = metadata[dimensionId];\n  return dimension ? /*#__PURE__*/React.createElement(DimensionModal, {\n    dataTest: 'dialog-manager-modal',\n    isInLayout: isInLayout,\n    onClose: closeModal,\n    onUpdate: primaryOnClick,\n    title: dimension.name\n  }, renderModalContent()) : null;\n};\nFixedDimension.propTypes = {\n  dimensionId: PropTypes.string.isRequired,\n  isInLayout: PropTypes.array.isRequired,\n  ouIds: PropTypes.array.isRequired,\n  onClose: PropTypes.func.isRequired,\n  addMetadata: PropTypes.func,\n  addParentGraphMap: PropTypes.func,\n  metadata: PropTypes.object,\n  parentGraphMap: PropTypes.object,\n  rootOrgUnits: PropTypes.array,\n  setUiItems: PropTypes.func,\n  onUpdate: PropTypes.func\n};\nFixedDimension.defaultProps = {\n  rootOrgUnits: []\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  isInLayout: sGetDimensionIdsFromLayout(state).includes(ownProps.dimensionId),\n  metadata: sGetMetadata(state),\n  ouIds: sGetUiItemsByDimension(state, DIMENSION_ID_ORGUNIT),\n  parentGraphMap: sGetUiParentGraphMap(state),\n  rootOrgUnits: sGetRootOrgUnits(state)\n});\n\nexport default connect(mapStateToProps, {\n  setUiItems: acSetUiItems,\n  addMetadata: acAddMetadata,\n  addParentGraphMap: acAddParentGraphMap,\n  onUpdate: tSetCurrentFromUi\n})(FixedDimension);","import { DIMENSION_ID_ORGUNIT } from '@dhis2/analytics';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOpenDimensionModal } from '../../actions/ui.js';\nimport { sGetUiActiveModalDialog } from '../../reducers/ui.js';\nimport ConditionsManager from './Conditions/ConditionsManager.js';\nimport FixedDimension from './FixedDimension.js';\nexport const DialogManager = ({\n  dialogId,\n  changeDialog\n}) => {\n  switch (dialogId) {\n    case DIMENSION_ID_ORGUNIT:\n      {\n        return /*#__PURE__*/React.createElement(FixedDimension, {\n          dimensionId: dialogId,\n          onClose: () => changeDialog(null)\n        });\n      }\n    // TODO: case DIMENSION_ID_PERIOD:\n\n    default:\n      {\n        return dialogId && /*#__PURE__*/React.createElement(ConditionsManager, {\n          dimensionId: dialogId,\n          onClose: () => changeDialog(null)\n        });\n      }\n  }\n};\nDialogManager.propTypes = {\n  changeDialog: PropTypes.func.isRequired,\n  dialogId: PropTypes.string\n};\nDialogManager.defaultProps = {\n  dialogId: null,\n  rootOrgUnits: []\n};\n\nconst mapStateToProps = state => ({\n  dialogId: sGetUiActiveModalDialog(state)\n});\n\nexport default connect(mapStateToProps, {\n  changeDialog: acSetUiOpenDimensionModal\n})(DialogManager);","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { DragDropContext } from 'react-beautiful-dnd';\nimport { connect } from 'react-redux';\nimport { acAddUiLayoutDimensions, acSetUiLayout } from '../actions/ui.js';\nimport { SOURCE_DIMENSIONS } from '../modules/layout.js';\nimport { sGetUiLayout, sGetUiItems } from '../reducers/ui.js';\n\nconst DndContext = ({\n  children,\n  layout,\n  onAddDimensions,\n  onReorderDimensions\n}) => {\n  const rearrangeLayoutDimensions = ({\n    sourceAxisId,\n    sourceIndex,\n    destinationAxisId,\n    destinationIndex\n  }) => {\n    const sourceList = Array.from(layout[sourceAxisId]);\n    const [moved] = sourceList.splice(sourceIndex, 1);\n\n    if (sourceAxisId === destinationAxisId) {\n      sourceList.splice(destinationIndex, 0, moved);\n      onReorderDimensions({ ...layout,\n        [sourceAxisId]: sourceList\n      });\n    } else {\n      onAddDimensions({\n        [moved]: {\n          axisId: destinationAxisId,\n          index: destinationIndex\n        }\n      });\n    }\n  };\n\n  const addDimensionToLayout = ({\n    axisId,\n    index,\n    dimensionId\n  }) => {\n    onAddDimensions({\n      [dimensionId]: {\n        axisId,\n        index\n      }\n    }); //TODO: Add onDropWithoutItems\n  };\n\n  const onDragEnd = result => {\n    const {\n      source,\n      destination,\n      draggableId\n    } = result;\n\n    if (!destination) {\n      return;\n    }\n\n    if (source.droppableId === SOURCE_DIMENSIONS) {\n      addDimensionToLayout({\n        axisId: destination.droppableId,\n        index: destination.index,\n        dimensionId: draggableId\n      });\n    } else {\n      rearrangeLayoutDimensions({\n        sourceAxisId: source.droppableId,\n        sourceIndex: source.index,\n        destinationAxisId: destination.droppableId,\n        destinationIndex: destination.index\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(DragDropContext, {\n    onDragEnd: onDragEnd\n  }, children);\n};\n\nDndContext.propTypes = {\n  children: PropTypes.node,\n  layout: PropTypes.object,\n  onAddDimensions: PropTypes.func,\n  onReorderDimensions: PropTypes.func\n};\n\nconst mapStateToProps = state => ({\n  layout: sGetUiLayout(state),\n  itemsByDimension: sGetUiItems(state)\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onAddDimensions: map => dispatch(acAddUiLayoutDimensions(map)),\n  onReorderDimensions: layout => dispatch(acSetUiLayout(layout))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DndContext);","import PropTypes from 'prop-types';\nimport React, { forwardRef } from 'react';\nimport classes from './styles/MenuButton.module.css';\nconst MenuButton = /*#__PURE__*/forwardRef(({\n  children,\n  disabled,\n  onClick\n}, ref) => /*#__PURE__*/React.createElement(\"button\", {\n  ref: ref,\n  className: classes.menuButton,\n  disabled: disabled,\n  onClick: onClick\n}, children));\nMenuButton.displayName = 'MenuButton';\nMenuButton.propTypes = {\n  children: PropTypes.node,\n  disabled: PropTypes.bool,\n  onClick: PropTypes.func\n};\nexport default MenuButton;","export const DOWNLOAD_TYPE_PLAIN = 'plain';\nexport const DOWNLOAD_TYPE_TABLE = 'table';\nexport const FILE_FORMAT_CSV = 'csv';\nexport const FILE_FORMAT_HTML_CSS = 'html+css';\nexport const FILE_FORMAT_JSON = 'json';\nexport const FILE_FORMAT_XLS = 'xls';\nexport const FILE_FORMAT_XML = 'xml';\nexport const ID_SCHEME_UID = 'UID';\nexport const ID_SCHEME_CODE = 'CODE';\nexport const ID_SCHEME_NAME = 'NAME';","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { MenuItem, MenuSectionHeader } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { DOWNLOAD_TYPE_PLAIN, ID_SCHEME_UID, ID_SCHEME_CODE, ID_SCHEME_NAME } from './constants.js';\nexport const PlainDataSourceSubMenu = ({\n  download,\n  format,\n  label,\n  ...menuItemProps\n}) => /*#__PURE__*/React.createElement(MenuItem, _extends({\n  label: label\n}, menuItemProps), /*#__PURE__*/React.createElement(MenuSectionHeader, {\n  label: i18n.t('Metadata ID scheme')\n}), /*#__PURE__*/React.createElement(MenuItem, {\n  label: i18n.t('ID'),\n  onClick: () => download(DOWNLOAD_TYPE_PLAIN, format, ID_SCHEME_UID)\n}), /*#__PURE__*/React.createElement(MenuItem, {\n  label: i18n.t('Code'),\n  onClick: () => download(DOWNLOAD_TYPE_PLAIN, format, ID_SCHEME_CODE)\n}), /*#__PURE__*/React.createElement(MenuItem, {\n  label: i18n.t('Name'),\n  onClick: () => download(DOWNLOAD_TYPE_PLAIN, format, ID_SCHEME_NAME)\n}));\nPlainDataSourceSubMenu.propTypes = {\n  download: PropTypes.func.isRequired,\n  format: PropTypes.string.isRequired,\n  label: PropTypes.string.isRequired\n};","import i18n from '@dhis2/d2-i18n';\nimport { FlyoutMenu, MenuItem, MenuSectionHeader } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { DOWNLOAD_TYPE_TABLE, FILE_FORMAT_HTML_CSS, FILE_FORMAT_CSV, FILE_FORMAT_XLS, FILE_FORMAT_JSON, FILE_FORMAT_XML } from './constants.js';\nimport { PlainDataSourceSubMenu } from './PlainDataSourceSubMenu.js';\n\nconst DownloadMenu = ({\n  download\n}) => /*#__PURE__*/React.createElement(FlyoutMenu, null, /*#__PURE__*/React.createElement(MenuSectionHeader, {\n  label: \"HTML\"\n}), /*#__PURE__*/React.createElement(MenuItem, {\n  label: \"HTML+CSS (.html+css)\",\n  onClick: () => download(DOWNLOAD_TYPE_TABLE, FILE_FORMAT_HTML_CSS)\n}), /*#__PURE__*/React.createElement(MenuSectionHeader, {\n  label: i18n.t('Plain data source')\n}), /*#__PURE__*/React.createElement(PlainDataSourceSubMenu, {\n  download: download,\n  label: \"JSON\",\n  format: FILE_FORMAT_JSON\n}), /*#__PURE__*/React.createElement(PlainDataSourceSubMenu, {\n  download: download,\n  label: \"XML\",\n  format: FILE_FORMAT_XML\n}), /*#__PURE__*/React.createElement(PlainDataSourceSubMenu, {\n  download: download,\n  label: \"Microsoft Excel\",\n  format: FILE_FORMAT_XLS\n}), /*#__PURE__*/React.createElement(PlainDataSourceSubMenu, {\n  download: download,\n  label: \"CSV\",\n  format: FILE_FORMAT_CSV\n}));\n\nDownloadMenu.propTypes = {\n  download: PropTypes.func.isRequired\n};\nexport { DownloadMenu };","import { Analytics } from '@dhis2/analytics';\nimport { useConfig, useDataEngine } from '@dhis2/app-runtime';\nimport { useRef, useState, useCallback } from 'react';\nimport { useSelector } from 'react-redux';\nimport { sGetCurrent } from '../../reducers/current.js';\nimport { DOWNLOAD_TYPE_PLAIN, ID_SCHEME_NAME, DOWNLOAD_TYPE_TABLE, FILE_FORMAT_HTML_CSS, FILE_FORMAT_CSV, FILE_FORMAT_XLS } from './constants.js';\n\nconst useDownloadMenu = relativePeriodDate => {\n  const current = useSelector(sGetCurrent);\n  const {\n    baseUrl\n  } = useConfig();\n  const dataEngine = useDataEngine();\n  const analyticsEngine = Analytics.getAnalytics(dataEngine);\n  const buttonRef = useRef();\n  const [isOpen, setIsOpen] = useState(false);\n  const download = useCallback((type, format, idScheme) => {\n    if (!current) {\n      return false;\n    }\n\n    let req = new analyticsEngine.request();\n    let target = '_top';\n\n    switch (type) {\n      case DOWNLOAD_TYPE_TABLE:\n        req = req.fromVisualization(current).withProgram(current.program.id).withStage(current.programStage.id) // XXX might not always be present?\n        .withPath('events/query') // TODO depends on event/enrollment\n        .withFormat(format).withTableLayout().withColumns(current.columns.filter(column => column.dimension !== 'dy').map(column => column.dimension).join(';')).withRows(current.rows.filter(row => row.dimension !== 'dy').map(row => row.dimension).join(';')).withParameters({\n          dataIdScheme: ID_SCHEME_NAME,\n          paging: false\n        }); // only for LL\n        // not sorted (see old ER)\n        //TODO\n        //displayPropertyName\n        //completedOnly (from options)\n        //hideEmptyColumns (from options)\n        //hideEmptyRows (from options)\n        //showHierarchy (from options)\n        //startDate\n        //endDate\n\n        target = format === FILE_FORMAT_HTML_CSS ? '_blank' : '_top';\n        break;\n\n      case DOWNLOAD_TYPE_PLAIN:\n        req = req // Perhaps the 2nd arg `passFilterAsDimension` should be false for the advanced submenu?\n        .fromVisualization(current, true).withProgram(current.program.id).withStage(current.programStage.id) // XXX might not always be present?\n        .withPath('events/query') // TODO depends on event/enrollment\n        .withFormat(format).withOutputIdScheme(idScheme); // TODO options\n        // startDate\n        // endDate\n        // displayProperty\n        // completedOnly\n        // hierarchyMeta (from options)\n        // outputType\n        // programStatus\n        // eventStatus\n        // limit\n        // sortOrder\n        // value\n        // aggregationType\n        // timeField\n        // orgUnitField\n        // collapsedDataDimensions\n        // useOrgUnit (URL)\n        // relativePeriodDate\n        // TODO LL only\n        // need to reflect the page and pageSize and sorting shown in the Visualization component?\n        // NO!\n        // asc\n        // desc\n        // pageSize\n        // page\n\n        target = [FILE_FORMAT_CSV, FILE_FORMAT_XLS].includes(format) ? '_top' : '_blank';\n        break;\n    } // TODO add common parameters\n    // if there are for both event/enrollment and PT/LL\n\n\n    req = req.withParameters({\n      completedOnly: current.completedOnly\n    });\n\n    if (relativePeriodDate) {\n      req = req.withRelativePeriodDate(relativePeriodDate);\n    }\n\n    const url = new URL(`${baseUrl}/api/${req.buildUrl()}`, `${window.location.origin}${window.location.pathname}`);\n    Object.entries(req.buildQuery()).forEach(([key, value]) => url.searchParams.append(key, value));\n    window.open(url, target);\n    setIsOpen(false);\n  }, [current, relativePeriodDate]);\n  return {\n    isOpen,\n    toggleOpen: () => setIsOpen(!isOpen),\n    disabled: !current,\n    download,\n    buttonRef\n  };\n};\n\nexport { useDownloadMenu };","import i18n from '@dhis2/d2-i18n';\nimport { Layer, Popper } from '@dhis2/ui';\nimport React, { useRef } from 'react';\nimport { default as MenuButton } from '../Toolbar/MenuBar/MenuButton.js';\nimport { DownloadMenu } from './DownloadMenu.js';\nimport { useDownloadMenu } from './useDownloadMenu.js';\n\nconst ToolbarDownloadDropdown = () => {\n  const buttonRef = useRef();\n  const {\n    isOpen,\n    toggleOpen,\n    disabled,\n    download\n  } = useDownloadMenu();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(MenuButton, {\n    ref: buttonRef,\n    onClick: toggleOpen,\n    disabled: disabled\n  }, i18n.t('Download')), isOpen && /*#__PURE__*/React.createElement(Layer, {\n    onClick: toggleOpen\n  }, /*#__PURE__*/React.createElement(Popper, {\n    reference: buttonRef,\n    placement: \"bottom-start\"\n  }, /*#__PURE__*/React.createElement(DownloadMenu, {\n    download: download\n  }))));\n};\n\nexport { ToolbarDownloadDropdown };","import i18n from '@dhis2/d2-i18n';\nimport { DropdownButton } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { DownloadMenu } from './DownloadMenu.js';\nimport styles from './ModalDownloadDropdown.module.css';\nimport { useDownloadMenu } from './useDownloadMenu.js';\n\nconst ModalDownloadDropdown = ({\n  relativePeriodDate\n}) => {\n  const {\n    isOpen,\n    toggleOpen,\n    disabled,\n    download\n  } = useDownloadMenu(relativePeriodDate);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(DropdownButton, {\n    component: /*#__PURE__*/React.createElement(DownloadMenu, {\n      download: download\n    }),\n    disabled: disabled,\n    onClick: toggleOpen,\n    open: isOpen,\n    secondary: true,\n    small: true\n  }, i18n.t('Download data from this date')));\n};\n\nModalDownloadDropdown.propTypes = {\n  relativePeriodDate: PropTypes.string\n};\nexport { ModalDownloadDropdown };","import { Analytics } from '@dhis2/analytics';\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { useEffect, useState, useRef } from 'react';\nimport { OUTPUT_TYPE_ENROLLMENT, OUTPUT_TYPE_EVENT, TIME_DIMENSION_EVENT_DATE, TIME_DIMENSION_ENROLLMENT_DATE, TIME_DIMENSION_INCIDENT_DATE, TIME_DIMENSION_SCHEDULED_DATE, TIME_DIMENSION_LAST_UPDATED, headersMap } from '../../modules/visualization.js';\nconst VALUE_TYPE_BOOLEAN = 'BOOLEAN';\nconst VALUE_TYPE_TRUE_ONLY = 'TRUE_ONLY';\nconst booleanMap = {\n  0: i18n.t('No'),\n  1: i18n.t('Yes')\n};\nconst analyticsApiEndpointMap = {\n  [OUTPUT_TYPE_ENROLLMENT]: 'enrollments',\n  [OUTPUT_TYPE_EVENT]: 'events'\n};\n\nconst findOptionSetItem = (code, metaDataItems) => Object.values(metaDataItems).find(item => item.code === code);\n\nconst formatRowValue = (rowValue, header, metaDataItems) => {\n  var _findOptionSetItem, _metaDataItems$rowVal;\n\n  switch (header.valueType) {\n    case VALUE_TYPE_BOOLEAN:\n    case VALUE_TYPE_TRUE_ONLY:\n      return booleanMap[rowValue] || i18n.t('Not answered');\n\n    default:\n      return header.optionSet ? ((_findOptionSetItem = findOptionSetItem(rowValue, metaDataItems)) === null || _findOptionSetItem === void 0 ? void 0 : _findOptionSetItem.name) || rowValue : ((_metaDataItems$rowVal = metaDataItems[rowValue]) === null || _metaDataItems$rowVal === void 0 ? void 0 : _metaDataItems$rowVal.name) || rowValue;\n  }\n};\n\nconst isTimeDimension = dimensionId => [TIME_DIMENSION_EVENT_DATE, TIME_DIMENSION_ENROLLMENT_DATE, TIME_DIMENSION_INCIDENT_DATE, TIME_DIMENSION_SCHEDULED_DATE, TIME_DIMENSION_LAST_UPDATED].includes(dimensionId);\n\nconst getAdaptedVisualization = visualization => {\n  const adaptedColumns = [];\n  const adaptedFilters = [];\n  const headers = [];\n  const timeDimensionParameters = {};\n  visualization.columns.forEach(dimensionObj => {\n    var _dimensionObj$items;\n\n    const dimensionId = dimensionObj.dimension;\n    headers.push(headersMap[dimensionId] || dimensionId);\n    isTimeDimension(dimensionId) ? timeDimensionParameters[dimensionId] = (_dimensionObj$items = dimensionObj.items) === null || _dimensionObj$items === void 0 ? void 0 : _dimensionObj$items.map(item => item.id) : adaptedColumns.push(dimensionObj);\n  });\n  visualization.filters.forEach(dimensionObj => {\n    var _dimensionObj$items2;\n\n    const dimensionId = dimensionObj.dimension;\n    isTimeDimension(dimensionId) ? timeDimensionParameters[dimensionId] = (_dimensionObj$items2 = dimensionObj.items) === null || _dimensionObj$items2 === void 0 ? void 0 : _dimensionObj$items2.map(item => item.id) : adaptedFilters(dimensionObj);\n  });\n  return {\n    adaptedVisualization: {\n      columns: adaptedColumns,\n      filters: adaptedFilters\n    },\n    headers,\n    timeDimensionParameters\n  };\n};\n\nconst fetchAnalyticsData = async ({\n  analyticsEngine,\n  visualization,\n  pageSize,\n  page,\n  relativePeriodDate,\n  sortField,\n  sortDirection\n}) => {\n  const {\n    adaptedVisualization,\n    headers,\n    timeDimensionParameters\n  } = getAdaptedVisualization(visualization);\n  let req = new analyticsEngine.request().fromVisualization(adaptedVisualization).withParameters({\n    headers: headers,\n    ...timeDimensionParameters\n  }).withProgram(visualization.program.id).withStage(visualization.programStage.id).withDisplayProperty('NAME') // TODO from settings ?!\n  .withOutputType(visualization.outputType).withParameters({\n    completedOnly: visualization.completedOnly\n  }).withPageSize(pageSize).withPage(page);\n\n  if (relativePeriodDate) {\n    req = req.withRelativePeriodDate(relativePeriodDate);\n  }\n\n  if (sortField) {\n    switch (sortDirection) {\n      case 'asc':\n        req = req.withAsc(sortField);\n        break;\n\n      case 'desc':\n        req = req.withDesc(sortField);\n        break;\n    }\n  }\n\n  const analyticsApiEndpoint = analyticsApiEndpointMap[visualization.outputType]; // for 2.38 only /query is used (since only Line List is enabled)\n\n  const rawResponse = await analyticsEngine[analyticsApiEndpoint].getQuery(req);\n  return rawResponse;\n};\n\nconst extractHeaders = analyticsResponse => analyticsResponse.headers.map((header, index) => ({ ...header,\n  index\n}));\n\nconst extractRows = (analyticsResponse, headers) => {\n  const filteredRows = [];\n\n  for (let rowIndex = 0, rowsCount = analyticsResponse.rows.length; rowIndex < rowsCount; rowIndex++) {\n    const row = analyticsResponse.rows[rowIndex];\n    const filteredRow = [];\n\n    for (let headerIndex = 0, headersCount = headers.length; headerIndex < headersCount; headerIndex++) {\n      const header = headers[headerIndex];\n      const rowValue = row[header.index];\n      filteredRow.push(formatRowValue(rowValue, header, analyticsResponse.metaData.items));\n    }\n\n    filteredRows.push(filteredRow);\n  }\n\n  return filteredRows;\n};\n\nconst useAnalyticsData = ({\n  visualization,\n  relativePeriodDate,\n  onResponseReceived,\n  sortField,\n  sortDirection,\n  page,\n  pageSize\n}) => {\n  const dataEngine = useDataEngine();\n  const [analyticsEngine] = useState(() => Analytics.getAnalytics(dataEngine));\n  const mounted = useRef(false);\n  const [loading, setLoading] = useState(true);\n  const [fetching, setFetching] = useState(true);\n  const [error, setError] = useState(undefined);\n  const [data, setData] = useState(null);\n  useEffect(() => {\n    mounted.current = true;\n    setFetching(true);\n\n    const doFetch = async () => {\n      try {\n        const analyticsResponse = await fetchAnalyticsData({\n          analyticsEngine,\n          visualization,\n          pageSize,\n          page,\n          relativePeriodDate,\n          sortField,\n          sortDirection\n        });\n        const headers = extractHeaders(analyticsResponse);\n        const rows = extractRows(analyticsResponse, headers);\n        const pageCount = analyticsResponse.metaData.pager.pageCount;\n        const total = analyticsResponse.metaData.pager.total;\n        mounted.current && setError(undefined);\n        mounted.current && setData({\n          headers,\n          rows,\n          pageCount,\n          total\n        });\n        onResponseReceived(analyticsResponse);\n      } catch (error) {\n        mounted.current && setError(error);\n      } finally {\n        mounted.current && setLoading(false);\n        mounted.current && setFetching(false);\n      }\n    };\n\n    doFetch();\n    return () => {\n      // Hack to prevent state updates on unmounted components\n      // needed because the analytics engine cannot cancel requests\n      mounted.current = false;\n    };\n  }, [visualization, page, pageSize, sortField, sortDirection, relativePeriodDate]);\n  return {\n    loading,\n    fetching,\n    error,\n    data\n  };\n};\n\nexport { useAnalyticsData };","import { useState, useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useDebounce } from '../../modules/utils.js';\nimport { sGetUiShowDetailsPanel, sGetUiShowAccessoryPanel } from '../../reducers/ui.js';\nconst LEFT_SIDEBARS_WIDTH = 260;\nconst RIGHT_SIDEBAR_WIDTH = 380;\nconst PADDING = 2 * 4;\nconst BORDER = 2 * 1;\n\nconst computeAvailableWidth = (windowWidth, leftOpen, rightOpen) => {\n  let availableWidth = windowWidth - LEFT_SIDEBARS_WIDTH - PADDING - BORDER;\n\n  if (leftOpen) {\n    availableWidth -= LEFT_SIDEBARS_WIDTH;\n  }\n\n  if (rightOpen) {\n    availableWidth -= RIGHT_SIDEBAR_WIDTH;\n  }\n\n  return availableWidth;\n};\n\nexport const useAvailableWidth = () => {\n  const [windowWidth, setWindowWidth] = useState(window.innerWidth);\n  const debounceWindowWidth = useDebounce(windowWidth, 150);\n  const leftOpen = useSelector(sGetUiShowAccessoryPanel);\n  const rightOpen = useSelector(sGetUiShowDetailsPanel);\n  const [availableWidth, setAvailableWidth] = useState(computeAvailableWidth(windowWidth, leftOpen, rightOpen));\n  useEffect(() => {\n    const onResize = () => {\n      setWindowWidth(window.innerWidth);\n    };\n\n    window.addEventListener('resize', onResize);\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  }, []);\n  useEffect(() => {\n    setAvailableWidth(computeAvailableWidth(debounceWindowWidth, leftOpen, rightOpen));\n  }, [leftOpen, rightOpen, debounceWindowWidth]);\n  return `${availableWidth}px`;\n};","import { formatValue } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { DataTable, DataTableRow, DataTableCell, DataTableColumnHeader, DataTableHead, DataTableBody, DataTableFoot, Pagination, NoticeBox } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { DISPLAY_DENSITY_COMFORTABLE, DISPLAY_DENSITY_COMPACT, FONT_SIZE_LARGE, FONT_SIZE_NORMAL, FONT_SIZE_SMALL } from '../../modules/options.js';\nimport styles from './styles/Visualization.module.css';\nimport { useAnalyticsData } from './useAnalyticsData.js';\nimport { useAvailableWidth } from './useAvailableWidth.js';\n\nconst getFontSizeClass = fontSize => {\n  switch (fontSize) {\n    case FONT_SIZE_LARGE:\n      return styles.fontSizeLarge;\n\n    case FONT_SIZE_SMALL:\n      return styles.fontSizeSmall;\n\n    case FONT_SIZE_NORMAL:\n    default:\n      return styles.fontSizeNormal;\n  }\n};\n\nexport const Visualization = ({\n  visualization,\n  onResponseReceived,\n  relativePeriodDate\n}) => {\n  const maxWidth = useAvailableWidth();\n  const [{\n    sortField,\n    sortDirection\n  }, setSorting] = useState({\n    sortField: 'eventdate',\n    // TODO get field name corresponding to visualization.sortOrder ?!\n    sortDirection: 'desc'\n  });\n  const [page, setPage] = useState(1);\n  const [pageSize, setPageSize] = useState(100);\n  const {\n    fetching,\n    error,\n    data\n  } = useAnalyticsData({\n    visualization,\n    relativePeriodDate,\n    onResponseReceived,\n    sortField,\n    sortDirection,\n    page,\n    pageSize\n  });\n\n  if (error) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.error\n    }, /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: i18n.t('Could not load visualization')\n    }, (error === null || error === void 0 ? void 0 : error.message) || i18n.t(\"The visualization couldn't be displayed. Try again or contact your system administrator.\")));\n  }\n\n  if (!data) {\n    return null;\n  }\n\n  const large = visualization.displayDensity === DISPLAY_DENSITY_COMFORTABLE;\n  const small = visualization.displayDensity === DISPLAY_DENSITY_COMPACT;\n  const fontSizeClass = getFontSizeClass(visualization.fontSize);\n  const colSpan = String(Math.max(data.headers.length, 1));\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.wrapper\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.fetchIndicator, {\n      [styles.fetching]: fetching\n    })\n  }, /*#__PURE__*/React.createElement(DataTable, {\n    scrollHeight: \"500px\",\n    width: \"auto\",\n    scrollWidth: maxWidth\n  }, /*#__PURE__*/React.createElement(DataTableHead, null, /*#__PURE__*/React.createElement(DataTableRow, null, data.headers.map((header, index) => header ? /*#__PURE__*/React.createElement(DataTableColumnHeader, {\n    fixed: true,\n    top: \"0\",\n    key: header.name,\n    name: header.name,\n    onSortIconClick: ({\n      name,\n      direction\n    }) => setSorting({\n      sortField: name,\n      sortDirection: direction\n    }),\n    sortDirection: header.name === sortField ? sortDirection : 'default',\n    large: large,\n    small: small,\n    className: fontSizeClass\n  }, header.column) : /*#__PURE__*/React.createElement(DataTableColumnHeader, {\n    fixed: true,\n    top: \"0\",\n    key: `undefined_${index}` // FIXME this is due to pe not being present in headers, needs special handling\n    ,\n    large: large,\n    small: small,\n    className: fontSizeClass\n  })))), /*#__PURE__*/React.createElement(DataTableBody, null, data.rows.map((row, index) => /*#__PURE__*/React.createElement(DataTableRow, {\n    key: index\n  }, row.map((value, index) => {\n    var _data$headers$index;\n\n    return /*#__PURE__*/React.createElement(DataTableCell, {\n      key: index,\n      large: large,\n      small: small,\n      className: fontSizeClass\n    }, formatValue(value, ((_data$headers$index = data.headers[index]) === null || _data$headers$index === void 0 ? void 0 : _data$headers$index.valueType) || 'TEXT', {\n      digitGroupSeparator: visualization.digitGroupSeparator,\n      skipRounding: false // TODO should there be an option for this?\n\n    }));\n  })))), /*#__PURE__*/React.createElement(DataTableFoot, {\n    className: styles.stickyFooter\n  }, /*#__PURE__*/React.createElement(DataTableRow, null, /*#__PURE__*/React.createElement(DataTableCell, {\n    colSpan: colSpan,\n    staticStyle: true\n  }, /*#__PURE__*/React.createElement(Pagination, {\n    page: page,\n    pageCount: data.pageCount,\n    pageSize: pageSize,\n    total: data.total,\n    onPageChange: setPage,\n    onPageSizeChange: setPageSize,\n    pageSizeSelectText: i18n.t('Cases per page'),\n    pageSummaryText: ({\n      firstItem,\n      lastItem,\n      total\n    }) => i18n.t('{{firstCaseIndex}}-{{lastCaseIndex}} of {{count}} cases', {\n      firstCaseIndex: firstItem,\n      lastCaseIndex: lastItem,\n      count: total,\n      // FIXME does it make sense if there is only 1 case?! \"1 of 1 case\"\n      // not sure is possible to have empty string for singular with i18n\n      // TODO also, this string for some reason is not extracted\n      defaultValue: '{{firstCaseIndex}} of {{count}} case',\n      defaultValue_plural: '{{firstCaseIndex}}-{{lastCaseIndex}} of {{count}} cases'\n    })\n  })))))));\n};\nVisualization.defaultProps = {\n  onResponseReceived: Function.prototype\n};\nVisualization.propTypes = {\n  visualization: PropTypes.object.isRequired,\n  onResponseReceived: PropTypes.func.isRequired,\n  relativePeriodDate: PropTypes.string\n};","import { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { IconDelete16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { MessageIconButton } from '../common/index.js';\nconst mutation = {\n  resource: 'interpretations',\n  id: ({\n    interpretationId,\n    commentId\n  }) => `${interpretationId}/comments/${commentId}`,\n  type: 'delete'\n};\n\nconst CommentDeleteButton = ({\n  commentId,\n  interpretationId,\n  onComplete\n}) => {\n  const [remove, {\n    loading\n  }] = useDataMutation(mutation, {\n    onComplete,\n    variables: {\n      commentId,\n      interpretationId\n    }\n  });\n  return /*#__PURE__*/React.createElement(MessageIconButton, {\n    tooltipContent: i18n.t('Delete'),\n    iconComponent: IconDelete16,\n    onClick: remove,\n    disabled: loading\n  });\n};\n\nCommentDeleteButton.propTypes = {\n  commentId: PropTypes.string.isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  onComplete: PropTypes.func.isRequired\n};\nexport { CommentDeleteButton };","import _JSXStyle from \"styled-jsx/style\";\nimport { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button, spacers, colors } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState, useRef } from 'react';\nimport { MessageEditorContainer, RichTextEditor, MessageButtonStrip } from '../common/index.js';\nexport const CommentUpdateForm = ({\n  interpretationId,\n  commentId,\n  currentUser,\n  text,\n  close,\n  onComplete\n}) => {\n  const [commentText, setCommentText] = useState(text || '');\n  const updateMutationRef = useRef({\n    resource: `interpretations/${interpretationId}/comments/${commentId}`,\n    type: 'update',\n    partial: false,\n    data: ({\n      commentText\n    }) => commentText\n  });\n  const [update, {\n    loading,\n    error\n  }] = useDataMutation(updateMutationRef.current, {\n    onComplete: () => {\n      onComplete();\n      close();\n    }\n  });\n  const errorText = error ? error.message || i18n.t('Could not update comment') : '';\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"2690082310\", [spacers.dp8, spacers.dp8, colors.grey100]]]) + \" \" + \"message\"\n  }, /*#__PURE__*/React.createElement(MessageEditorContainer, {\n    currentUser: currentUser\n  }, /*#__PURE__*/React.createElement(RichTextEditor, {\n    inputPlaceholder: i18n.t('Enter comment text'),\n    onChange: setCommentText,\n    value: commentText,\n    disabled: loading,\n    errorText: errorText\n  }), /*#__PURE__*/React.createElement(MessageButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    loading: loading,\n    primary: true,\n    small: true,\n    onClick: () => update({\n      commentText\n    })\n  }, i18n.t('Update')), /*#__PURE__*/React.createElement(Button, {\n    disabled: loading,\n    secondary: true,\n    small: true,\n    onClick: close\n  }, i18n.t('Cancel')))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2690082310\",\n    dynamic: [spacers.dp8, spacers.dp8, colors.grey100]\n  }, [`.message.__jsx-style-dynamic-selector{padding:0 ${spacers.dp8} ${spacers.dp8};background-color:${colors.grey100};border-radius:5px;}`]));\n};\nCommentUpdateForm.propTypes = {\n  close: PropTypes.func.isRequired,\n  commentId: PropTypes.string.isRequired,\n  currentUser: PropTypes.object.isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  onComplete: PropTypes.func.isRequired,\n  text: PropTypes.string\n};","import i18n from '@dhis2/d2-i18n';\nimport { IconEdit16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { Message, MessageIconButton, MessageStatsBar } from '../common/index.js';\nimport { CommentDeleteButton } from './CommentDeleteButton.js';\nimport { CommentUpdateForm } from './CommentUpdateForm.js';\n\nconst Comment = ({\n  comment,\n  currentUser,\n  interpretationId,\n  onThreadUpdated\n}) => {\n  const [isUpdateMode, setIsUpdateMode] = useState(false);\n  return isUpdateMode ? /*#__PURE__*/React.createElement(CommentUpdateForm, {\n    close: () => setIsUpdateMode(false),\n    commentId: comment.id,\n    interpretationId: interpretationId,\n    onComplete: () => onThreadUpdated(false),\n    text: comment.text,\n    currentUser: currentUser\n  }) : /*#__PURE__*/React.createElement(Message, {\n    id: comment.id,\n    text: comment.text,\n    created: comment.created,\n    username: comment.createdBy.displayName\n  }, /*#__PURE__*/React.createElement(MessageStatsBar, null, comment.access.update && /*#__PURE__*/React.createElement(MessageIconButton, {\n    iconComponent: IconEdit16,\n    tooltipContent: i18n.t('Edit'),\n    onClick: () => setIsUpdateMode(true)\n  }), comment.access.delete && /*#__PURE__*/React.createElement(CommentDeleteButton, {\n    commentId: comment.id,\n    interpretationId: interpretationId,\n    onComplete: () => onThreadUpdated(true)\n  })));\n};\n\nComment.propTypes = {\n  comment: PropTypes.object.isRequired,\n  currentUser: PropTypes.object.isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  onThreadUpdated: PropTypes.func.isRequired\n};\nexport { Comment };","import { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useRef, useState } from 'react';\nimport { RichTextEditor, MessageEditorContainer, MessageButtonStrip, MessageInput } from '../common/index.js';\nexport const CommentAddForm = ({\n  interpretationId,\n  currentUser,\n  onSave,\n  focusRef\n}) => {\n  const [showRichTextEditor, setShowRichTextEditor] = useState(false);\n  const [commentText, setCommentText] = useState('');\n  const saveMutationRef = useRef({\n    resource: `interpretations/${interpretationId}/comments`,\n    type: 'create',\n    data: ({\n      commentText\n    }) => commentText\n  });\n  const [save, {\n    loading\n  }] = useDataMutation(saveMutationRef.current, {\n    onComplete: () => {\n      setShowRichTextEditor(false);\n      setCommentText('');\n      onSave();\n    }\n  });\n  const inputPlaceholder = i18n.t('Add a comment');\n  return /*#__PURE__*/React.createElement(MessageEditorContainer, {\n    currentUser: currentUser\n  }, showRichTextEditor ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(RichTextEditor, {\n    inputPlaceholder: inputPlaceholder,\n    onChange: setCommentText,\n    value: commentText,\n    ref: focusRef,\n    disabled: loading\n  }), /*#__PURE__*/React.createElement(MessageButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    small: true,\n    onClick: () => save({\n      commentText\n    }),\n    loading: loading\n  }, i18n.t('Save comment')), /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: loading,\n    onClick: () => {\n      setCommentText('');\n      setShowRichTextEditor(false);\n    }\n  }, i18n.t('Cancel')))) : /*#__PURE__*/React.createElement(MessageInput, {\n    onFocus: () => setShowRichTextEditor(true),\n    placeholder: inputPlaceholder,\n    ref: focusRef\n  }));\n};\nCommentAddForm.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  focusRef: PropTypes.object.isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  onSave: PropTypes.func\n};","import _JSXStyle from \"styled-jsx/style\";\nimport { IconClock16, colors } from '@dhis2/ui';\nimport cx from 'classnames';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React, { useRef, useEffect } from 'react';\nimport { Interpretation } from '../common/index.js';\nimport { Comment } from './Comment.js';\nimport { CommentAddForm } from './CommentAddForm.js';\n\nconst InterpretationThread = ({\n  currentUser,\n  fetching,\n  interpretation,\n  onInterpretationDeleted,\n  initialFocus,\n  onThreadUpdated,\n  downloadMenuComponent: DownloadMenu\n}) => {\n  const focusRef = useRef();\n  useEffect(() => {\n    if (initialFocus && focusRef.current) {\n      window.requestAnimationFrame(() => {\n        focusRef.current.focus();\n      });\n    }\n  }, [initialFocus, focusRef.current]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2924001448\" + \" \" + (cx('container', {\n      fetching\n    }) || \"\")\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2924001448\" + \" \" + 'scrollbox'\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2924001448\" + \" \" + 'title'\n  }, /*#__PURE__*/React.createElement(IconClock16, {\n    color: colors.grey700\n  }), moment(interpretation.created).format('LLL')), /*#__PURE__*/React.createElement(DownloadMenu, {\n    relativePeriodDate: interpretation.created,\n    className: \"jsx-2924001448\"\n  }), /*#__PURE__*/React.createElement(Interpretation, {\n    currentUser: currentUser,\n    interpretation: interpretation,\n    onReplyIconClick: () => {\n      var _focusRef$current;\n\n      return (_focusRef$current = focusRef.current) === null || _focusRef$current === void 0 ? void 0 : _focusRef$current.focus();\n    },\n    onUpdated: () => onThreadUpdated(true),\n    onDeleted: onInterpretationDeleted\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2924001448\" + \" \" + 'comments'\n  }, interpretation.comments.map(comment => /*#__PURE__*/React.createElement(Comment, {\n    key: comment.id,\n    comment: comment,\n    currentUser: currentUser,\n    interpretationId: interpretation.id,\n    onThreadUpdated: onThreadUpdated\n  }))), /*#__PURE__*/React.createElement(CommentAddForm, {\n    currentUser: currentUser,\n    interpretationId: interpretation.id,\n    onSave: () => onThreadUpdated(true),\n    focusRef: focusRef\n  })), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2924001448\"\n  }, [\".container.jsx-2924001448{position:relative;overflow:hidden;max-height:calc(100vh - 285px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\", \".container.fetching.jsx-2924001448::before{content:'';position:absolute;inset:0px;background-color:rgba(255,255,255,0.8);}\", \".container.fetching.jsx-2924001448::after{content:'';position:absolute;top:calc(50% - 12px);left:calc(50% - 12px);width:24px;height:24px;border-width:4px;border-style:solid;border-color:rgba(110,122,138,0.15) rgba(110,122,138,0.15) rgb(20,124,215);border-image:initial;border-radius:50%;-webkit-animation:1s linear 0s infinite normal none running rotation-jsx-2924001448;animation:1s linear 0s infinite normal none running rotation-jsx-2924001448;}\", \".scrollbox.jsx-2924001448{overflow-y:auto;-webkit-scroll-behavior:smooth;-moz-scroll-behavior:smooth;-ms-scroll-behavior:smooth;scroll-behavior:smooth;}\", \".title.jsx-2924001448{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:var(--spacers-dp8);color:var(--colors-grey900);font-size:14px;line-height:18px;}\", \".comments.jsx-2924001448{padding-left:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding-top:var(--spacers-dp4);gap:var(--spacers-dp4);}\", \"@-webkit-keyframes rotation-jsx-2924001448{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}\", \"@keyframes rotation-jsx-2924001448{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}\"]));\n};\n\nInterpretationThread.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  downloadMenuComponent: PropTypes.oneOfType([PropTypes.object, PropTypes.func]).isRequired,\n  fetching: PropTypes.bool.isRequired,\n  interpretation: PropTypes.object.isRequired,\n  onInterpretationDeleted: PropTypes.func.isRequired,\n  initialFocus: PropTypes.bool,\n  onThreadUpdated: PropTypes.func\n};\nexport { InterpretationThread };","import _JSXStyle from \"styled-jsx/style\";\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Modal, ModalActions, ModalContent, NoticeBox, Button, spacers, colors, Layer, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport { Visualization } from '../../Visualization/Visualization.js';\nimport { InterpretationThread } from './InterpretationThread.js';\nconst modalCSS = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3128514153\"\n  }, [\"aside.jsx-3128514153{min-width:600px;min-height:600px;max-width:90vw !important;max-height:90vh !important;width:auto !important;height:auto !important;}\", \"aside.hidden.jsx-3128514153{display:none;}\"]),\n  className: \"jsx-3128514153\"\n};\nconst query = {\n  interpretation: {\n    resource: 'interpretations',\n    id: ({\n      id\n    }) => id,\n    params: {\n      fields: ['access', 'id', 'text', 'created', 'user[id,displayName]', 'likes', 'likedBy', 'comments[access,id,text,created,createdBy[id,displayName]]']\n    }\n  }\n};\n\nconst InterpretationModal = ({\n  currentUser,\n  isVisualizationLoading,\n  visualization,\n  onResponseReceived,\n  downloadMenuComponent,\n  onClose,\n  onInterpretationUpdate,\n  interpretationId,\n  initialFocus\n}) => {\n  const [isDirty, setIsDirty] = useState(false);\n  const {\n    data,\n    error,\n    loading,\n    fetching,\n    refetch\n  } = useDataQuery(query, {\n    lazy: true\n  });\n  const interpretation = data === null || data === void 0 ? void 0 : data.interpretation;\n  const shouldRenderModalContent = !error && interpretation;\n  const shouldCssHideModal = loading || isVisualizationLoading;\n\n  const handleClose = () => {\n    if (isDirty) {\n      onInterpretationUpdate();\n      setIsDirty(false);\n    }\n\n    onClose();\n  };\n\n  const onThreadUpdated = affectsInterpretation => {\n    if (affectsInterpretation) {\n      setIsDirty(true);\n    }\n\n    refetch({\n      id: interpretationId\n    });\n  };\n\n  const onInterpretationDeleted = () => {\n    setIsDirty(false);\n    onInterpretationUpdate();\n    onClose();\n  };\n\n  useEffect(() => {\n    if (interpretationId) {\n      refetch({\n        id: interpretationId\n      });\n    }\n  }, [interpretationId]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, shouldCssHideModal && /*#__PURE__*/React.createElement(Layer, null, /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, null))), /*#__PURE__*/React.createElement(Modal, {\n    onClose: handleClose,\n    className: cx(modalCSS.className, {\n      hidden: shouldCssHideModal\n    })\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: _JSXStyle.dynamic([[\"3797932359\", [colors.grey900, spacers.dp24, spacers.dp24]]]) + \" \" + \"title\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: _JSXStyle.dynamic([[\"3797932359\", [colors.grey900, spacers.dp24, spacers.dp24]]]) + \" \" + \"ellipsis\"\n  }, i18n.t('Viewing interpretation: {{visualisationName}}', {\n    visualisationName: visualization.displayName,\n    nsSeparator: '^^'\n  }))), /*#__PURE__*/React.createElement(ModalContent, {\n    className: \"modalContent\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3797932359\", [colors.grey900, spacers.dp24, spacers.dp24]]]) + \" \" + \"container\"\n  }, error && /*#__PURE__*/React.createElement(NoticeBox, {\n    error: true,\n    title: i18n.t('Could not load interpretation')\n  }, error.message || i18n.t('The interpretation couldn’t be displayed. Try again or contact your system administrator.')), shouldRenderModalContent && /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3797932359\", [colors.grey900, spacers.dp24, spacers.dp24]]]) + \" \" + \"row\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3797932359\", [colors.grey900, spacers.dp24, spacers.dp24]]]) + \" \" + \"visualisation-wrap\"\n  }, /*#__PURE__*/React.createElement(Visualization, {\n    relativePeriodDate: interpretation.created,\n    visualization: visualization,\n    onResponseReceived: onResponseReceived\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3797932359\", [colors.grey900, spacers.dp24, spacers.dp24]]]) + \" \" + \"thread-wrap\"\n  }, /*#__PURE__*/React.createElement(InterpretationThread, {\n    currentUser: currentUser,\n    fetching: fetching,\n    interpretation: interpretation,\n    onInterpretationDeleted: onInterpretationDeleted,\n    onThreadUpdated: onThreadUpdated,\n    initialFocus: initialFocus,\n    downloadMenuComponent: downloadMenuComponent\n  }))))), /*#__PURE__*/React.createElement(ModalActions, null, /*#__PURE__*/React.createElement(Button, {\n    disabled: fetching,\n    onClick: handleClose\n  }, i18n.t('Hide interpretation'))), modalCSS.styles, /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3797932359\",\n    dynamic: [colors.grey900, spacers.dp24, spacers.dp24]\n  }, [`.title.__jsx-style-dynamic-selector{color:${colors.grey900};font-size:20px;font-weight:500;line-height:24px;margin:0px;padding:${spacers.dp24} ${spacers.dp24} 0;}`, \".ellipsis.__jsx-style-dynamic-selector{display:inline-block;line-height:20px;white-space:nowrap;width:100%;overflow:hidden;text-overflow:ellipsis;}\", \".container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\", \".row.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:16px;}\", \".visualisation-wrap.__jsx-style-dynamic-selector{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}\", \".thread-wrap.__jsx-style-dynamic-selector{-webkit-flex-basis:300px;-ms-flex-preferred-size:300px;flex-basis:300px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow-y:auto;}\"])));\n};\n\nInterpretationModal.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  downloadMenuComponent: PropTypes.oneOfType([PropTypes.object, PropTypes.func]).isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  isVisualizationLoading: PropTypes.bool.isRequired,\n  visualization: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onResponseReceived: PropTypes.func.isRequired,\n  initialFocus: PropTypes.bool,\n  onInterpretationUpdate: PropTypes.func\n};\nexport { InterpretationModal };","import { parse, stringify } from 'query-string';\nimport { useState, useEffect } from 'react';\nimport history from '../../modules/history.js';\nconst options = {\n  parseBooleans: true\n};\n\nconst useInterpretationQueryParams = () => {\n  const [params, setParams] = useState(parse(history.location.search, options));\n  useEffect(() => {\n    const unlisten = history.listen(({\n      location\n    }) => {\n      var _location$state, _location$state2;\n\n      if ((_location$state = location.state) !== null && _location$state !== void 0 && _location$state.isModalOpening) {\n        setParams(parse(history.location.search, options));\n      }\n\n      if ((_location$state2 = location.state) !== null && _location$state2 !== void 0 && _location$state2.isModalClosing) {\n        setParams(parse(history.location.search, options));\n      }\n    });\n    return unlisten;\n  }, []);\n  return params;\n};\n\nconst removeInterpretationQueryParams = () => {\n  const parsed = parse(history.location.search, options); // Keep all other query params in tact\n\n  const parsedWithoutInterpretationId = Object.entries(parsed).reduce((acc, [key, value]) => {\n    if (key !== 'interpretationId' && key !== 'initialFocus') {\n      acc[key] = value;\n    }\n\n    return acc;\n  }, {});\n  const search = stringify(parsedWithoutInterpretationId);\n  history.push({ ...history.location,\n    search\n  }, {\n    isModalClosing: true\n  });\n};\n\nexport { useInterpretationQueryParams, removeInterpretationQueryParams };","import PropTypes from 'prop-types';\nimport React, { useState, useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport { sGetCurrent } from '../../reducers/current.js';\nimport { sGetUser } from '../../reducers/user.js';\nimport { ModalDownloadDropdown } from '../DownloadMenu/index.js';\nimport { InterpretationModal as AnalyticsInterpretationModal } from '../Interpretations/InterpretationModal/index.js';\nimport { useInterpretationQueryParams, removeInterpretationQueryParams } from './interpretationIdQueryParam.js';\n\nconst InterpretationModal = ({\n  onInterpretationUpdate\n}) => {\n  const {\n    interpretationId,\n    initialFocus\n  } = useInterpretationQueryParams();\n  const [isVisualizationLoading, setIsVisualizationLoading] = useState(false);\n  const visualization = useSelector(sGetCurrent);\n  const currentUser = useSelector(sGetUser);\n  useEffect(() => {\n    setIsVisualizationLoading(!!interpretationId);\n  }, [interpretationId]);\n  return interpretationId ? /*#__PURE__*/React.createElement(AnalyticsInterpretationModal, {\n    currentUser: currentUser,\n    onInterpretationUpdate: onInterpretationUpdate,\n    initialFocus: initialFocus,\n    interpretationId: interpretationId,\n    isVisualizationLoading: isVisualizationLoading,\n    onClose: removeInterpretationQueryParams,\n    onResponseReceived: () => setIsVisualizationLoading(false),\n    visualization: visualization,\n    downloadMenuComponent: ModalDownloadDropdown\n  }) : null;\n};\n\nInterpretationModal.propTypes = {\n  onInterpretationUpdate: PropTypes.func.isRequired\n};\nexport { InterpretationModal };","import { AXIS_ID_COLUMNS, AXIS_ID_FILTERS, AXIS_ID_ROWS } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\n\nconst getAxisNames = () => ({\n  [AXIS_ID_COLUMNS]: i18n.t('Columns'),\n  [AXIS_ID_ROWS]: i18n.t('Rows'),\n  [AXIS_ID_FILTERS]: i18n.t('Filter')\n});\n\nexport const getAxisName = axisId => {\n  const name = getAxisNames()[axisId];\n\n  if (!name) {\n    throw new Error(`${axisId} is not a valid axis id`);\n  }\n\n  return name;\n};","import React from 'react';\n\nconst DynamicDimensionIcon = () => {\n  return /*#__PURE__*/React.createElement(\"svg\", {\n    width: \"16px\",\n    height: \"16px\",\n    viewBox: \"0 0 16 16\",\n    version: \"1.1\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    stroke: \"none\",\n    strokeWidth: \"1\",\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"translate(-80.000000, -9.000000)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"translate(80.000000, 9.000000)\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    x: \"0\",\n    y: \"0\",\n    width: \"16\",\n    height: \"16\"\n  }), /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"translate(4.000000, 4.000000)\",\n    stroke: \"#000000\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M0.33209728,1.1742111 L3.16308174,0.0641666694 C3.37911767,-0.0213888898 3.61963794,-0.0213888898 3.83567387,0.0641666694 L6.66665833,1.1742111 C6.87300668,1.26220739 7.00497003,1.467 6.99984343,1.69127776 L6.99984343,5.30887771 C7.00517859,5.53285411 6.87376309,5.73756106 6.66790272,5.82594437 L3.83691826,6.93629991 C3.62076407,7.02123336 3.38048032,7.02123336 3.16432613,6.93629991 L0.333341668,5.82594437 C0.126993317,5.73794808 -0.00497002591,5.53315547 0.000156574133,5.30887771 L0.000156574133,1.69127776 C-0.00517858533,1.46730136 0.126236906,1.26259441 0.33209728,1.1742111 Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.5,2.72795833 L0.322,1.48195833\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.5,2.72795833 L6.678,1.48195833\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.5,6.78125 L3.5,2.72795833\"\n  }))))));\n};\n\nexport default DynamicDimensionIcon;","import { ouIdHelper } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { IconWarningFilled16, IconLock16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { sGetMetadata } from '../../reducers/metadata.js';\nimport styles from './styles/Tooltip.module.css';\nconst labels = {\n  noneSelected: () => i18n.t('None selected'),\n  onlyOneInUse: name => i18n.t(\"Only '{{- name}}' in use\", {\n    name\n  }),\n  onlyLimitedNumberInUse: number => i18n.t(\"Only '{{number}}' in use\", {\n    number\n  }),\n  allItems: () => i18n.t('All items are selected')\n};\nexport const TooltipContent = ({\n  dimensionId,\n  itemIds,\n  metadata,\n  displayLimitedAmount,\n  lockedLabel\n}) => {\n  const getWarningLabel = () => {\n    const warningLabel = itemIds.length === 1 ? labels.onlyOneInUse(metadata[itemIds[0]] ? metadata[itemIds[0]].name : itemIds[0]) : labels.onlyLimitedNumberInUse(itemIds.length);\n    return displayLimitedAmount ? warningLabel : null;\n  };\n\n  const getNameList = (idList, label, metadata) => idList.reduce((levelString, levelId, index) => `${levelString}${index > 0 ? `, ` : ``}${metadata[levelId] ? metadata[levelId].name : levelId}`, `${label}: `);\n\n  const getItemDisplayNames = () => {\n    const levelIds = [];\n    const groupIds = [];\n    const itemDisplayNames = [];\n\n    if (!displayLimitedAmount) {\n      itemIds.forEach(id => {\n        if (ouIdHelper.hasLevelPrefix(id)) {\n          levelIds.push(ouIdHelper.removePrefix(id));\n        } else if (ouIdHelper.hasGroupPrefix(id)) {\n          groupIds.push(ouIdHelper.removePrefix(id));\n        } else {\n          itemDisplayNames.push(metadata[id] ? metadata[id].name : id);\n        }\n      });\n      levelIds.length && itemDisplayNames.push(getNameList(levelIds, i18n.t('Levels'), metadata));\n      groupIds.length && itemDisplayNames.push(getNameList(groupIds, i18n.t('Groups'), metadata));\n    }\n\n    return itemDisplayNames;\n  };\n\n  const renderWarningLabel = warningLabel => /*#__PURE__*/React.createElement(\"li\", {\n    className: styles.item\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.iconWrapper\n  }, /*#__PURE__*/React.createElement(IconWarningFilled16, null), /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.label\n  }, warningLabel)));\n\n  const renderItems = itemDisplayNames => {\n    const renderLimit = 5;\n    const itemsToRender = itemDisplayNames.slice(0, renderLimit).map(name => /*#__PURE__*/React.createElement(\"li\", {\n      key: `${dimensionId}-${name}`,\n      className: styles.item\n    }, name));\n\n    if (itemDisplayNames.length > renderLimit) {\n      itemsToRender.push( /*#__PURE__*/React.createElement(\"li\", {\n        key: `${dimensionId}-render-limit`,\n        className: styles.item\n      }, itemDisplayNames.length - renderLimit === 1 ? i18n.t('And 1 other...') : i18n.t('And {{numberOfItems}} others...', {\n        numberOfItems: itemDisplayNames.length - renderLimit\n      })));\n    }\n\n    return itemsToRender;\n  };\n\n  const renderLockedLabel = () => /*#__PURE__*/React.createElement(\"li\", {\n    className: styles.item\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.iconWrapper\n  }, /*#__PURE__*/React.createElement(IconLock16, null), /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.label\n  }, lockedLabel)));\n\n  const renderNoItemsLabel = () => /*#__PURE__*/React.createElement(\"li\", {\n    key: `${dimensionId}-${labels.noneSelected()}`,\n    className: styles.item\n  }, labels.noneSelected());\n\n  const itemDisplayNames = getItemDisplayNames();\n  const warningLabel = getWarningLabel();\n  const hasNoItemsLabel = !itemDisplayNames.length && !warningLabel;\n  return /*#__PURE__*/React.createElement(\"ul\", {\n    className: styles.list\n  }, warningLabel && renderWarningLabel(warningLabel), lockedLabel && renderLockedLabel(), itemDisplayNames && renderItems(itemDisplayNames), hasNoItemsLabel && renderNoItemsLabel());\n};\nTooltipContent.propTypes = {\n  dimensionId: PropTypes.string.isRequired,\n  metadata: PropTypes.object.isRequired,\n  displayLimitedAmount: PropTypes.bool,\n  itemIds: PropTypes.array,\n  lockedLabel: PropTypes.string\n};\n\nconst mapStateToProps = state => ({\n  metadata: sGetMetadata(state)\n});\n\nexport default connect(mapStateToProps)(TooltipContent);","import i18n from '@dhis2/d2-i18n';\nimport { Tooltip } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport DynamicDimensionIcon from '../../assets/DynamicDimensionIcon.js';\nimport { setDataTransfer } from '../../modules/dnd.js';\nimport { sGetMetadataById } from '../../reducers/metadata.js';\nimport styles from './styles/Chip.module.css';\nimport { default as TooltipContent } from './TooltipContent.js';\n\nconst Chip = ({\n  numberOfConditions,\n  dimensionId,\n  dimensionName,\n  axisId,\n  items,\n  onClick,\n  contextMenu\n}) => {\n  const id = Math.random().toString(36);\n  const dataTest = `layout-chip-${dimensionId}`;\n\n  const getDragStartHandler = () => event => {\n    setDataTransfer(event, axisId);\n  };\n\n  const renderChipLabelSuffix = () => {\n    let itemsLabel = '';\n\n    if (items.length) {\n      itemsLabel = i18n.t('{{count}} selected', {\n        count: items.length\n      });\n    } else if (numberOfConditions) {\n      itemsLabel = i18n.t('{{count}} conditions', {\n        count: numberOfConditions,\n        defaultValue: '{{count}} condition',\n        defaultValue_plural: '{{count}} conditions'\n      });\n    }\n\n    return itemsLabel ? `: ${itemsLabel}` : '';\n  };\n\n  const renderChipIcon = () => {\n    // TODO: Add the chip icons once they've been spec'ed properly\n    return /*#__PURE__*/React.createElement(DynamicDimensionIcon, null);\n  };\n\n  const renderTooltipContent = () => /*#__PURE__*/React.createElement(TooltipContent, {\n    dimensionId: dimensionId,\n    itemIds: items\n  });\n\n  const renderChipContent = () => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.leftIconWrapper\n  }, renderChipIcon()), /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.label\n  }, dimensionName), /*#__PURE__*/React.createElement(\"span\", null, renderChipLabelSuffix()));\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.chipWrapper, {\n      [styles.chipEmpty]: !items.length && !numberOfConditions\n    }),\n    \"data-dimensionid\": dimensionId,\n    onDragStart: getDragStartHandler()\n  }, /*#__PURE__*/React.createElement(Tooltip, {\n    content: renderTooltipContent(),\n    placement: \"bottom\"\n  }, ({\n    ref,\n    onMouseOver,\n    onMouseOut\n  }) => /*#__PURE__*/React.createElement(\"div\", {\n    \"data-test\": dataTest,\n    id: id,\n    className: cx(styles.chip, styles.chipLeft),\n    onClick: onClick,\n    ref: ref,\n    onMouseOver: onMouseOver,\n    onMouseOut: onMouseOut\n  }, renderChipContent())), contextMenu && /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.chip, styles.chipRight)\n  }, contextMenu));\n};\n\nChip.propTypes = {\n  axisId: PropTypes.string.isRequired,\n  dimensionId: PropTypes.string.isRequired,\n  dimensionName: PropTypes.string.isRequired,\n  onClick: PropTypes.func.isRequired,\n  contextMenu: PropTypes.object,\n  items: PropTypes.array,\n  numberOfConditions: PropTypes.number\n};\nChip.defaultProps = {\n  conditions: [],\n  items: []\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  dimensionName: (sGetMetadataById(state, ownProps.dimensionId) || {}).name\n});\n\nexport default connect(mapStateToProps)(Chip);","const DATA_TYPE_TEXT = 'text';\nexport const setDataTransfer = (e, source) => {\n  e.dataTransfer.setData(DATA_TYPE_TEXT, JSON.stringify({\n    dimensionId: e.target.dataset.dimensionid,\n    source\n  }));\n};","import { AXIS_ID_COLUMNS, AXIS_ID_FILTERS, AXIS_ID_ROWS } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { MenuDivider, FlyoutMenu, MenuItem } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { getAxisName } from '../../modules/axis.js';\nimport { VIS_TYPE_LINE_LIST } from '../../modules/visualization.js';\n\nconst getAxisItemLabel = (axisName, isDimensionInLayout) => isDimensionInLayout ? i18n.t('Move to {{axisName}}', {\n  axisName\n}) : i18n.t('Add to {{axisName}}', {\n  axisName\n});\n\nconst getDividerItem = key => /*#__PURE__*/React.createElement(MenuDivider, {\n  dense: true,\n  key: key\n});\n\nconst DimensionMenu = ({\n  dimensionId,\n  currentAxisId,\n  visType,\n  axisItemHandler,\n  removeItemHandler,\n  onClose,\n  dataTest\n}) => {\n  const menuItems = [];\n  const isDimensionInLayout = !!currentAxisId; // add/move to axis item\n\n  const availableAxisIds = visType === VIS_TYPE_LINE_LIST ? [AXIS_ID_COLUMNS, AXIS_ID_FILTERS] : [AXIS_ID_COLUMNS, AXIS_ID_ROWS, AXIS_ID_FILTERS];\n  const applicableAxisIds = availableAxisIds.filter(axisId => axisId !== currentAxisId);\n\n  const getRemoveMenuItem = onClick => /*#__PURE__*/React.createElement(MenuItem, {\n    key: \"remove-menu-item\",\n    onClick: onClick,\n    label: i18n.t('Remove'),\n    dataTest: `${dataTest}-item-remove-${dimensionId}`\n  });\n\n  menuItems.push(...applicableAxisIds.map(axisId => /*#__PURE__*/React.createElement(MenuItem, {\n    key: `${dimensionId}-to-${axisId}`,\n    onClick: () => {\n      axisItemHandler({\n        dimensionId,\n        axisId\n      });\n      onClose();\n    },\n    label: getAxisItemLabel(getAxisName(axisId), isDimensionInLayout),\n    dataTest: `${dataTest}-item-action-${dimensionId}-to-${axisId}`\n  }))); // remove item\n\n  if (isDimensionInLayout) {\n    // divider\n    if (applicableAxisIds.length) {\n      menuItems.push(getDividerItem('remove-item-divider'));\n    }\n\n    menuItems.push(getRemoveMenuItem(() => {\n      removeItemHandler(dimensionId);\n      onClose();\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(FlyoutMenu, {\n    dense: true,\n    dataTest: dataTest\n  }, menuItems);\n};\n\nDimensionMenu.propTypes = {\n  axisItemHandler: PropTypes.func.isRequired,\n  removeItemHandler: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  currentAxisId: PropTypes.string,\n  dataTest: PropTypes.string,\n  dimensionId: PropTypes.string,\n  visType: PropTypes.string\n};\nexport default DimensionMenu;","import PropTypes from '@dhis2/prop-types';\nimport React from 'react';\nimport styles from './styles/IconButton.module.css';\n\nconst IconButton = ({\n  children,\n  dataTest,\n  disabled,\n  name,\n  onBlur,\n  onClick,\n  onFocus,\n  ariaOwns,\n  ariaHaspopup\n}) => /*#__PURE__*/React.createElement(\"button\", {\n  className: styles.iconButton,\n  \"data-test\": dataTest,\n  disabled: disabled,\n  name: name,\n  onBlur: onBlur,\n  onClick: onClick,\n  onFocus: onFocus,\n  \"aria-owns\": ariaOwns,\n  \"aria-haspopup\": ariaHaspopup\n}, children);\n\nIconButton.propTypes = {\n  ariaHaspopup: PropTypes.bool,\n  ariaOwns: PropTypes.string,\n  children: PropTypes.node,\n  dataTest: PropTypes.string,\n  disabled: PropTypes.bool,\n  name: PropTypes.string,\n  onBlur: PropTypes.func,\n  onClick: PropTypes.func,\n  onFocus: PropTypes.func\n};\nexport default IconButton;","import { Layer, Popper, IconMore16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { acAddUiLayoutDimensions, acRemoveUiLayoutDimensions } from '../../actions/ui.js';\nimport DimensionMenu from '../DimensionMenu/DimensionMenu.js';\nimport IconButton from '../IconButton/IconButton.js';\n\nconst ChipMenu = ({\n  axisItemHandler,\n  currentAxisId,\n  dimensionId,\n  removeItemHandler,\n  visType\n}) => {\n  const buttonRef = useRef();\n  const [menuIsOpen, setMenuIsOpen] = useState(false);\n\n  const toggleMenu = () => setMenuIsOpen(!menuIsOpen);\n\n  const getMenuId = () => `menu-for-${dimensionId}`;\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    ref: buttonRef\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    ariaOwns: menuIsOpen ? getMenuId() : null,\n    ariaHaspopup: true,\n    onClick: toggleMenu,\n    dataTest: `layout-chip-menu-button-${dimensionId}`\n  }, /*#__PURE__*/React.createElement(IconMore16, null))), menuIsOpen && /*#__PURE__*/React.createElement(Layer, {\n    onClick: toggleMenu\n  }, /*#__PURE__*/React.createElement(Popper, {\n    reference: buttonRef,\n    placement: \"bottom-start\"\n  }, /*#__PURE__*/React.createElement(DimensionMenu, {\n    dimensionId: dimensionId,\n    currentAxisId: currentAxisId,\n    visType: visType,\n    axisItemHandler: axisItemHandler,\n    removeItemHandler: removeItemHandler,\n    onClose: toggleMenu,\n    dataTest: 'layout-chip-menu-dimension-menu'\n  }))));\n};\n\nChipMenu.propTypes = {\n  axisItemHandler: PropTypes.func,\n  currentAxisId: PropTypes.string,\n  dimensionId: PropTypes.string,\n  removeItemHandler: PropTypes.func,\n  visType: PropTypes.string\n};\n\nconst mapDispatchToProps = dispatch => ({\n  axisItemHandler: ({\n    dimensionId,\n    axisId\n  }) => {\n    dispatch(acAddUiLayoutDimensions({\n      [dimensionId]: {\n        axisId\n      }\n    }));\n  },\n  removeItemHandler: dimensionId => {\n    dispatch(acRemoveUiLayoutDimensions(dimensionId));\n  }\n});\n\nexport default connect(null, mapDispatchToProps)(ChipMenu);","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\nimport { connect } from 'react-redux';\nimport { createSelector } from 'reselect';\nimport { acSetUiOpenDimensionModal } from '../../../actions/ui.js';\nimport { getAxisName } from '../../../modules/axis.js';\nimport { parseConditionsStringToArray } from '../../../modules/conditions.js';\nimport { sGetMetadata } from '../../../reducers/metadata.js';\nimport { sGetUiItemsByDimension, sGetUiLayout, sGetUiConditionsByDimension } from '../../../reducers/ui.js';\nimport Chip from '../Chip.js';\nimport ChipMenu from '../ChipMenu.js';\nimport styles from './styles/DefaultAxis.module.css';\n\nconst DefaultAxis = ({\n  axis,\n  axisId,\n  getConditionsByDimension,\n  getItemsByDimension,\n  getOpenHandler,\n  className,\n  renderChips,\n  visType\n}) => {\n  const onDragOver = e => {\n    e.preventDefault();\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: axisId,\n    \"data-test\": `${axisId}-axis`,\n    className: cx(styles.axisContainer, className),\n    onDragOver: onDragOver\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.label\n  }, getAxisName(axisId)), /*#__PURE__*/React.createElement(Droppable, {\n    droppableId: axisId,\n    direction: \"horizontal\"\n  }, provided => /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: styles.content,\n    ref: provided.innerRef\n  }, provided.droppableProps), renderChips && axis.map((dimensionId, index) => {\n    const key = `${axisId}-${dimensionId}`;\n    const items = getItemsByDimension(dimensionId);\n    const conditions = getConditionsByDimension(dimensionId);\n    const numberOfConditions = parseConditionsStringToArray(conditions.condition).length || conditions.legendSet ? 1 : 0;\n    return /*#__PURE__*/React.createElement(Draggable, {\n      key: key,\n      draggableId: key,\n      index: index\n    }, provided => /*#__PURE__*/React.createElement(\"div\", _extends({\n      ref: provided.innerRef\n    }, provided.draggableProps, provided.dragHandleProps), /*#__PURE__*/React.createElement(Chip, {\n      onClick: getOpenHandler(dimensionId),\n      axisId: axisId,\n      dimensionId: dimensionId,\n      items: items,\n      numberOfConditions: numberOfConditions,\n      contextMenu: /*#__PURE__*/React.createElement(ChipMenu, {\n        dimensionId: dimensionId,\n        currentAxisId: axisId,\n        visType: visType\n      })\n    })));\n  }), provided.placeholder)));\n};\n\nDefaultAxis.propTypes = {\n  axis: PropTypes.array,\n  axisId: PropTypes.string,\n  className: PropTypes.string,\n  getConditionsByDimension: PropTypes.func,\n  getItemsByDimension: PropTypes.func,\n  getOpenHandler: PropTypes.func,\n  layout: PropTypes.object,\n  renderChips: PropTypes.bool,\n  visType: PropTypes.string\n};\nexport const renderChipsSelector = createSelector( // only render chips when all have names (from metadata) available\n[sGetUiLayout, sGetMetadata], (layout, metadata) => {\n  const layoutItems = Object.values(layout || {}).flat();\n  const dataObjects = [...Object.values(metadata || {})]; // TODO: Refactor to not use the whole metadata list\n\n  return layoutItems.every(item => dataObjects.some(data => data.id === item));\n});\n\nconst mapStateToProps = state => ({\n  layout: sGetUiLayout(state),\n  getConditionsByDimension: dimensionId => sGetUiConditionsByDimension(state, dimensionId) || {},\n  getItemsByDimension: dimensionId => sGetUiItemsByDimension(state, dimensionId) || [],\n  renderChips: renderChipsSelector(state)\n});\n\nconst mapDispatchToProps = dispatch => ({\n  getOpenHandler: dimensionId => () => dispatch(acSetUiOpenDimensionModal(dimensionId))\n});\n\nconst mergeProps = (stateProps, dispatchProps, ownProps) => ({ ...stateProps,\n  ...dispatchProps,\n  ...ownProps,\n  axis: stateProps.layout[ownProps.axisId]\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps, mergeProps)(DefaultAxis);","import { AXIS_ID_COLUMNS, AXIS_ID_FILTERS } from '@dhis2/analytics';\nimport cx from 'classnames';\nimport React from 'react';\nimport { VIS_TYPE_LINE_LIST } from '../../../modules/visualization.js';\nimport DefaultAxis from '../DefaultLayout/DefaultAxis.js';\nimport defaultAxisStyles from '../DefaultLayout/styles/DefaultAxis.module.css';\nimport defaultLayoutStyles from '../DefaultLayout/styles/DefaultLayout.module.css';\nimport lineListLayoutStyles from './styles/LineListLayout.module.css';\n\nconst Layout = () => /*#__PURE__*/React.createElement(\"div\", {\n  id: \"layout-ct\",\n  className: defaultLayoutStyles.ct\n}, /*#__PURE__*/React.createElement(\"div\", {\n  id: \"axis-group-1\",\n  className: cx(defaultLayoutStyles.axisGroup, lineListLayoutStyles.axisGroupLeft)\n}, /*#__PURE__*/React.createElement(DefaultAxis, {\n  axisId: AXIS_ID_COLUMNS,\n  className: cx(defaultLayoutStyles.filters, defaultAxisStyles.axisContainerLeft),\n  visType: VIS_TYPE_LINE_LIST\n})), /*#__PURE__*/React.createElement(\"div\", {\n  id: \"axis-group-2\",\n  className: cx(defaultLayoutStyles.axisGroup, lineListLayoutStyles.axisGroupRight)\n}, /*#__PURE__*/React.createElement(DefaultAxis, {\n  axisId: AXIS_ID_FILTERS,\n  className: defaultLayoutStyles.filters,\n  visType: VIS_TYPE_LINE_LIST\n})));\n\nexport default Layout;","import { IconChevronUp16, IconChevronDown16, colors } from '@dhis2/ui';\nimport cx from 'classnames';\nimport React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { acSetShowExpandedLayoutPanel } from '../../actions/ui.js';\nimport { LAYOUT_TYPE_LINE_LIST } from '../../modules/layout.js';\nimport { sGetUiShowExpandedLayoutPanel } from '../../reducers/ui.js';\nimport LineListLayout from './LineListLayout/LineListLayout.js';\nimport classes from './styles/Layout.module.css';\nconst componentMap = {\n  [LAYOUT_TYPE_LINE_LIST]: LineListLayout\n};\n\nconst Layout = () => {\n  const isExpanded = useSelector(state => sGetUiShowExpandedLayoutPanel(state));\n  const dispatch = useDispatch();\n\n  const toggleExpanded = () => dispatch(acSetShowExpandedLayoutPanel(!isExpanded));\n\n  const layoutType = LAYOUT_TYPE_LINE_LIST;\n  const LayoutComponent = componentMap[layoutType];\n  const ButtonIcon = isExpanded ? IconChevronUp16 : IconChevronDown16;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.overflowContainer, {\n      [classes.expanded]: isExpanded\n    })\n  }, /*#__PURE__*/React.createElement(LayoutComponent, null)), /*#__PURE__*/React.createElement(\"button\", {\n    className: classes.button,\n    onClick: toggleExpanded\n  }, /*#__PURE__*/React.createElement(ButtonIcon, {\n    color: colors.grey700\n  })));\n};\n\nexport default Layout;","import { CircularLoader } from '@dhis2/ui';\nimport React from 'react';\nimport styles from './styles/LoadingMask.module.css';\n\nfunction LoadingMask() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.outer\n  }, /*#__PURE__*/React.createElement(CircularLoader, {\n    className: styles.progress\n  }));\n}\n\nexport default LoadingMask;","import { Radio } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport styles from './InputOption.module.css';\n\nconst InputOption = ({\n  header,\n  description,\n  onClick,\n  selected\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: cx(styles.container, {\n    [styles.selected]: selected\n  }),\n  onClick: onClick\n}, /*#__PURE__*/React.createElement(Radio, {\n  checked: selected\n}), /*#__PURE__*/React.createElement(\"div\", {\n  className: styles.label\n}, /*#__PURE__*/React.createElement(\"div\", {\n  className: styles.header\n}, header), /*#__PURE__*/React.createElement(\"div\", {\n  className: styles.description\n}, description)));\n\nInputOption.propTypes = {\n  description: PropTypes.string.isRequired,\n  header: PropTypes.string.isRequired,\n  selected: PropTypes.bool.isRequired,\n  onClick: PropTypes.func.isRequired\n};\nexport { InputOption };","import i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { acSetUiInput } from '../../../actions/ui.js';\nimport { OUTPUT_TYPE_EVENT, OUTPUT_TYPE_ENROLLMENT } from '../../../modules/visualization.js';\nimport { sGetUiInput } from '../../../reducers/ui.js';\nimport { InputOption } from './InputOption.js';\nimport styles from './InputPanel.module.css';\n\nconst getLabelForInputType = type => {\n  switch (type) {\n    case OUTPUT_TYPE_EVENT:\n      return i18n.t('Event');\n\n    case OUTPUT_TYPE_ENROLLMENT:\n      return i18n.t('Enrollment');\n\n    default:\n      throw new Error('No input type specified');\n  }\n};\n\nconst InputPanel = ({\n  visible\n}) => {\n  if (!visible) {\n    return null;\n  }\n\n  const selectedInput = useSelector(sGetUiInput);\n  const dispatch = useDispatch();\n\n  const setSelectedInput = input => dispatch(acSetUiInput(input));\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(InputOption, {\n    header: getLabelForInputType(OUTPUT_TYPE_EVENT),\n    description: i18n.t('Events are single registrations or incidents in a program.'),\n    onClick: () => setSelectedInput({\n      type: OUTPUT_TYPE_EVENT\n    }),\n    selected: selectedInput.type === OUTPUT_TYPE_EVENT\n  }), /*#__PURE__*/React.createElement(InputOption, {\n    header: getLabelForInputType(OUTPUT_TYPE_ENROLLMENT),\n    description: i18n.t('Programs track enrollments across time.'),\n    onClick: () => setSelectedInput({\n      type: OUTPUT_TYPE_ENROLLMENT\n    }),\n    selected: selectedInput.type === OUTPUT_TYPE_ENROLLMENT\n  }));\n};\n\nInputPanel.propTypes = {\n  visible: PropTypes.bool.isRequired\n};\nexport { InputPanel, getLabelForInputType };","import { IconChevronRight16 } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport styles from './MenuItem.module.css';\n\nconst MenuItem = ({\n  icon,\n  label,\n  count,\n  onClick,\n  selected\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: cx(styles.container, {\n    [styles.selected]: selected\n  }),\n  onClick: onClick,\n  tabIndex: \"0\"\n}, /*#__PURE__*/React.createElement(\"div\", {\n  className: styles.icon\n}, icon), /*#__PURE__*/React.createElement(\"div\", {\n  className: styles.label\n}, label), typeof count === 'number' && /*#__PURE__*/React.createElement(\"div\", {\n  className: styles.count\n}, count), /*#__PURE__*/React.createElement(IconChevronRight16, null));\n\nMenuItem.propTypes = {\n  icon: PropTypes.node.isRequired,\n  label: PropTypes.string.isRequired,\n  onClick: PropTypes.func.isRequired,\n  count: PropTypes.number,\n  selected: PropTypes.bool\n};\nexport { MenuItem };","import i18n from '@dhis2/d2-i18n';\nimport { SingleSelect, SingleSelectOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { acUpdateUiProgramStage } from '../../../actions/ui.js';\nimport { sGetUiProgramStage } from '../../../reducers/ui.js';\nconst STAGE_ALL = 'STAGE_ALL';\n\nconst StageSelect = ({\n  optional,\n  stages\n}) => {\n  const dispatch = useDispatch();\n  const selectedStageId = useSelector(sGetUiProgramStage);\n\n  const onChange = ({\n    selected: stageId\n  }) => {\n    dispatch(acUpdateUiProgramStage(stageId, {\n      [stageId]: stages.find(({\n        id\n      }) => id === stageId)\n    }));\n  };\n\n  return /*#__PURE__*/React.createElement(SingleSelect, {\n    prefix: i18n.t('Stage'),\n    dense: true,\n    selected: selectedStageId,\n    onChange: onChange\n  }, optional && /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('All'),\n    value: STAGE_ALL\n  }), stages.map(({\n    id,\n    name\n  }) => /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: name,\n    key: id,\n    value: id\n  })));\n};\n\nStageSelect.propTypes = {\n  stages: PropTypes.arrayOf(PropTypes.object).isRequired,\n  optional: PropTypes.bool\n};\nexport { StageSelect };","import i18n from '@dhis2/d2-i18n';\nimport { SingleSelect, SingleSelectOption, Input } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useSelector } from 'react-redux';\nimport { DIMENSION_TYPE_ALL, DIMENSION_TYPE_DATA_ELEMENT, DIMENSION_TYPE_PROGRAM_ATTRIBUTE, DIMENSION_TYPE_PROGRAM_INDICATOR, OUTPUT_TYPE_ENROLLMENT } from '../../../modules/visualization.js';\nimport { sGetUiInputType } from '../../../reducers/ui.js';\nimport styles from './ProgramDimensionsFilter.module.css';\nimport { StageSelect } from './StageSelect.js';\n\nconst ProgramDimensionsFilter = ({\n  program,\n  searchTerm,\n  setSearchTerm,\n  dimensionType,\n  setDimensionType\n}) => {\n  const inputType = useSelector(sGetUiInputType);\n  const showStageSelect = inputType === OUTPUT_TYPE_ENROLLMENT && dimensionType === DIMENSION_TYPE_DATA_ELEMENT;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(Input, {\n    value: searchTerm,\n    onChange: ({\n      value\n    }) => setSearchTerm(value),\n    dense: true,\n    placeholder: i18n.t('Search in program')\n  }), /*#__PURE__*/React.createElement(SingleSelect, {\n    prefix: i18n.t('Type'),\n    selected: dimensionType,\n    onChange: ({\n      selected\n    }) => setDimensionType(selected),\n    dense: true\n  }, /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('All'),\n    value: DIMENSION_TYPE_ALL\n  }), /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('Data element'),\n    value: DIMENSION_TYPE_DATA_ELEMENT\n  }), /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('Program attribute'),\n    value: DIMENSION_TYPE_PROGRAM_ATTRIBUTE\n  }), /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('Program indicator'),\n    value: DIMENSION_TYPE_PROGRAM_INDICATOR\n  })), showStageSelect && /*#__PURE__*/React.createElement(StageSelect, {\n    stages: program.programStages,\n    optional: true\n  }));\n};\n\nProgramDimensionsFilter.propTypes = {\n  program: PropTypes.object.isRequired,\n  dimensionType: PropTypes.string,\n  searchTerm: PropTypes.string,\n  setDimensionType: PropTypes.func,\n  setSearchTerm: PropTypes.func\n};\nexport { ProgramDimensionsFilter };","export const DIMENSION_LIST_FIELDS = ['id', 'displayName~rename(name)', 'dimensionType', 'valueType', 'optionSet'];","import { IconClock16, IconDimensionIndicator16, IconDimensionOrgUnit16, IconDimensionProgramIndicator16, IconLock16, IconMore16, IconWarningFilled16 } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { acSetUiOpenDimensionModal } from '../../../actions/ui.js';\nimport styles from './DimensionListItem.module.css'; // TODO: get correct icon for each dimension type\n// Currently using IconFilter16 as placeholder\n\nconst DIMENSION_TYPE_ICONS = {\n  DATA_ELEMENT: undefined,\n  DATA_ELEMENT_OPERAND: undefined,\n  INDICATOR: IconDimensionIndicator16,\n  REPORTING_RATE: undefined,\n  PROGRAM_DATA_ELEMENT: undefined,\n  PROGRAM_ATTRIBUTE: undefined,\n  PROGRAM_INDICATOR: IconDimensionProgramIndicator16,\n  PERIOD: IconClock16,\n  ORGANISATION_UNIT: IconDimensionOrgUnit16,\n  CATEGORY_OPTION: undefined,\n  OPTION_GROUP: undefined,\n  DATA_ELEMENT_GROUP: undefined,\n  ORGANISATION_UNIT_GROUP: undefined,\n  CATEGORY_OPTION_GROUP: undefined\n};\n\nconst getIconForDimensionType = dimensionType => {\n  const Icon = DIMENSION_TYPE_ICONS[dimensionType];\n\n  if (!Icon) {\n    console.warn(`No icon found for dimension type ${dimensionType}, using fallback warning icon instead`);\n  }\n\n  return Icon || IconWarningFilled16;\n};\n\nconst DimensionListItem = ({\n  dimensionType,\n  name,\n  id,\n  optionSet,\n  valueType\n}) => {\n  const dispatch = useDispatch();\n\n  const onClick = () => dispatch(acSetUiOpenDimensionModal(id, {\n    [id]: {\n      id,\n      name,\n      dimensionType,\n      valueType,\n      optionSet\n    }\n  }));\n\n  const Icon = getIconForDimensionType(dimensionType); // TODO: populate with proper values\n\n  const picked = false;\n  const disabled = false;\n  const recommended = false;\n  const dragOnly = false;\n  const locked = false;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.dimensionItem, {\n      [styles.picked]: picked,\n      [styles.disabled]: disabled,\n      [styles.recommended]: recommended,\n      [styles.dragOnly]: dragOnly\n    }),\n    onClick: onClick\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.icon\n  }, /*#__PURE__*/React.createElement(Icon, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.label\n  }, name), locked && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.lock\n  }, /*#__PURE__*/React.createElement(IconLock16, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.menuTrigger\n  }, /*#__PURE__*/React.createElement(IconMore16, null)));\n};\n\nDimensionListItem.propTypes = {\n  dimensionType: PropTypes.string.isRequired,\n  id: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  optionSet: PropTypes.string,\n  valueType: PropTypes.string\n};\nexport { DimensionListItem };","import i18n from '@dhis2/d2-i18n';\nimport { CircularLoader, NoticeBox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useRef, useEffect } from 'react';\nimport { DimensionListItem } from './DimensionListItem.js';\nimport styles from './DimensionsList.module.css';\n\nconst getNoResultsMessage = (searchTerm, programName) => {\n  if (searchTerm) {\n    return i18n.t(\"No dimensions found for '{{searchTerm}}'\", {\n      searchTerm\n    });\n  }\n\n  if (programName) {\n    return i18n.t('No dimensions found in the {{programName}} program', {\n      programName\n    });\n  }\n\n  return i18n.t('No dimensions found');\n};\n\nconst isEndReached = el => el.scrollHeight - el.scrollTop - el.clientHeight < 5;\n\nconst DimensionsList = ({\n  loading,\n  fetching,\n  error,\n  dimensions,\n  programName,\n  searchTerm,\n  setIsListEndVisible\n}) => {\n  const scrollBoxRef = useRef();\n  useEffect(() => {\n    if (dimensions && scrollBoxRef.current && !loading && !fetching) {\n      setIsListEndVisible(isEndReached(scrollBoxRef.current));\n    }\n  }, [dimensions, scrollBoxRef.current]);\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.loaderWrap\n    }, /*#__PURE__*/React.createElement(CircularLoader, {\n      small: true\n    }));\n  }\n\n  if (error) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.errorWrap\n    }, /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: i18n.t(\"Couldn't load dimensions\")\n    }, (error === null || error === void 0 ? void 0 : error.message) || i18n.t('There was a problem loading the dimensions. Try again, or contact your system administrator.')));\n  }\n\n  if (!(dimensions !== null && dimensions !== void 0 && dimensions.length)) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.noResults\n    }, getNoResultsMessage(searchTerm, programName));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.scrollbox,\n    onScroll: event => setIsListEndVisible(isEndReached(event.target)),\n    ref: scrollBoxRef\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.list\n  }, dimensions.map(dimension => /*#__PURE__*/React.createElement(DimensionListItem, {\n    key: dimension.id,\n    dimensionType: dimension.dimensionType,\n    name: dimension.name,\n    id: dimension.id,\n    optionSet: dimension.optionSet,\n    valueType: dimension.valueType\n  })), fetching && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.loadMoreWrap\n  }, /*#__PURE__*/React.createElement(CircularLoader, {\n    small: true\n  }))));\n};\n\nDimensionsList.propTypes = {\n  setIsListEndVisible: PropTypes.func.isRequired,\n  dimensions: PropTypes.array,\n  error: PropTypes.object,\n  fetching: PropTypes.bool,\n  loading: PropTypes.bool,\n  programName: PropTypes.string,\n  searchTerm: PropTypes.string\n};\nexport { DimensionsList };","import { useDataEngine } from '@dhis2/app-runtime';\nimport { useEffect, useReducer, useCallback } from 'react';\nimport { DIMENSION_TYPE_ALL, DIMENSION_TYPE_DATA_ELEMENT, OUTPUT_TYPE_EVENT, OUTPUT_TYPE_ENROLLMENT } from '../../../modules/visualization.js';\nimport { DIMENSION_LIST_FIELDS } from '../DimensionsList/index.js';\nconst ACTIONS_RESET = 'RESET';\nconst ACTIONS_INIT = 'INIT';\nconst ACTIONS_SUCCESS = 'SUCCESS';\nconst ACTIONS_ERROR = 'ERROR';\nconst ACTIONS_SET_LIST_END_VISIBLE = 'SET_LIST_END_VISIBLE';\nconst initialState = {\n  loading: true,\n  fetching: true,\n  error: null,\n  dimensions: null,\n  nextPage: 1,\n  isLastPage: false,\n  isListEndVisible: false\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case ACTIONS_RESET:\n      return { ...initialState\n      };\n\n    case ACTIONS_INIT:\n      return { ...state,\n        loading: !state.dimensions,\n        fetching: true,\n        error: null\n      };\n\n    case ACTIONS_SUCCESS:\n      return { ...state,\n        loading: false,\n        fetching: false,\n        error: null,\n        dimensions: state.dimensions ? [...state.dimensions, ...action.payload.dimensions] : action.payload.dimensions,\n        nextPage: action.payload.pager.page + 1,\n        isLastPage: action.payload.pager.pageSize * action.payload.pager.page >= action.payload.pager.total\n      };\n\n    case ACTIONS_ERROR:\n      return { ...state,\n        loading: false,\n        fetching: false,\n        error: action.payload,\n        dimensions: null\n      };\n\n    case ACTIONS_SET_LIST_END_VISIBLE:\n      return { ...state,\n        isListEndVisible: action.payload\n      };\n\n    default:\n      throw new Error('Invalid action passed to useProgramDimensions reducer function');\n  }\n};\n\nconst createDimensionsQuery = ({\n  inputType,\n  page,\n  programId,\n  stageId,\n  searchTerm,\n  dimensionType\n}) => {\n  const resource = inputType === OUTPUT_TYPE_EVENT ? 'analytics/events/query/dimensions' : 'analytics/enrollments/query/dimensions';\n  const params = {\n    pageSize: 50,\n    page,\n    fields: DIMENSION_LIST_FIELDS,\n    filter: []\n  };\n\n  if (programId && inputType === OUTPUT_TYPE_ENROLLMENT) {\n    params.programId = programId;\n  }\n\n  if (stageId && inputType === OUTPUT_TYPE_EVENT) {\n    params.programStageId = stageId;\n  }\n\n  if (stageId && inputType === OUTPUT_TYPE_ENROLLMENT && dimensionType === DIMENSION_TYPE_DATA_ELEMENT) {\n    // This works because data element IDs have the following notation:\n    // `${programStageId}.${dataElementId}`\n    params.filter.push(`id:like:${stageId}`);\n  }\n  /*\n   * TODO: currently no matches on shortname are captured\n   * if this is required we would need the backend add support for this, because\n   * we can't have a request with a mixed `rootJunction` (use both AND and OR)\n   * so we need to keep using the AND rootJunction and if we want to match a\n   * searchTerm against several fields, we need a specific query param for that,\n   * i.e. `filter=identifiable:token:${searchTerm}` or `query=${searchTerm}`\n   */\n\n\n  if (searchTerm) {\n    params.filter.push(`name:ilike:${searchTerm}`);\n  }\n\n  if (dimensionType && dimensionType !== DIMENSION_TYPE_ALL) {\n    params.filter.push(`dimensionType:eq:${dimensionType}`);\n  }\n\n  return {\n    resource,\n    params\n  };\n};\n\nconst useProgramDimensions = ({\n  inputType,\n  programId,\n  stageId,\n  searchTerm,\n  dimensionType\n}) => {\n  const engine = useDataEngine();\n  const [{\n    loading,\n    fetching,\n    error,\n    dimensions,\n    nextPage,\n    isLastPage,\n    isListEndVisible\n  }, dispatch] = useReducer(reducer, initialState);\n\n  const setIsListEndVisible = isVisible => {\n    if (isVisible !== isListEndVisible) {\n      dispatch({\n        type: ACTIONS_SET_LIST_END_VISIBLE,\n        payload: isVisible\n      });\n    }\n  };\n\n  const fetchDimensions = useCallback(async shouldReset => {\n    if (shouldReset) {\n      dispatch({\n        type: ACTIONS_RESET\n      });\n    } else {\n      dispatch({\n        type: ACTIONS_INIT\n      });\n    }\n\n    try {\n      const page = shouldReset ? 1 : nextPage;\n      const data = await engine.query({\n        dimensions: createDimensionsQuery({\n          inputType,\n          page,\n          programId,\n          stageId,\n          searchTerm,\n          dimensionType\n        })\n      });\n      dispatch({\n        type: ACTIONS_SUCCESS,\n        payload: data.dimensions\n      });\n    } catch (error) {\n      dispatch({\n        type: ACTIONS_ERROR,\n        payload: error\n      });\n    }\n  }, [inputType, nextPage, programId, stageId, searchTerm, dimensionType, isListEndVisible]);\n  useEffect(() => {\n    fetchDimensions(true);\n  }, [inputType, programId, stageId, searchTerm, dimensionType]);\n  useEffect(() => {\n    if (isListEndVisible && !isLastPage && !fetching) {\n      fetchDimensions(false);\n    }\n  }, [isListEndVisible, isLastPage]);\n  return {\n    loading,\n    error,\n    dimensions,\n    setIsListEndVisible\n  };\n};\n\nexport { useProgramDimensions, createDimensionsQuery };","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { DimensionsList } from '../DimensionsList/index.js';\nimport { useProgramDimensions } from './useProgramDimensions.js';\n\nconst ProgramDimensionsList = ({\n  inputType,\n  programId,\n  programName,\n  stageId,\n  searchTerm,\n  dimensionType\n}) => {\n  const {\n    dimensions,\n    loading,\n    fetching,\n    error,\n    setIsListEndVisible\n  } = useProgramDimensions({\n    inputType,\n    programId,\n    stageId,\n    searchTerm,\n    dimensionType\n  });\n  return /*#__PURE__*/React.createElement(DimensionsList, {\n    setIsListEndVisible: setIsListEndVisible,\n    dimensions: dimensions,\n    error: error,\n    fetching: fetching,\n    loading: loading,\n    programName: programName,\n    searchTerm: searchTerm\n  });\n};\n\nProgramDimensionsList.propTypes = {\n  inputType: PropTypes.string.isRequired,\n  programId: PropTypes.string.isRequired,\n  programName: PropTypes.string.isRequired,\n  dimensionType: PropTypes.string,\n  searchTerm: PropTypes.string,\n  stageId: PropTypes.string\n};\nexport { ProgramDimensionsList };","import i18n from '@dhis2/d2-i18n';\nimport { SingleSelect, SingleSelectOption, Button, Tooltip } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport styles from './ProgramSelect.module.css';\nimport { StageSelect } from './StageSelect.js';\n\nconst ProgramSelect = ({\n  programs,\n  setSelectedProgramId,\n  requiredStageSelection,\n  selectedProgram\n}) => {\n  /*\n   * TODO: the logic for disabling the select and showing the clear\n   * button needs to be changed later on. Currently this happens when\n   * programId is present but it should actually happen once at least one\n   * dimension item is selected\n   */\n  const showStageSelect = selectedProgram && requiredStageSelection;\n  const select = /*#__PURE__*/React.createElement(SingleSelect, {\n    dense: true,\n    selected: selectedProgram === null || selectedProgram === void 0 ? void 0 : selectedProgram.id,\n    disabled: !!selectedProgram,\n    onChange: ({\n      selected\n    }) => setSelectedProgramId(selected),\n    placeholder: i18n.t('Choose a program')\n  }, programs.map(({\n    id,\n    name\n  }) => /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: id,\n    label: name,\n    value: id\n  })));\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.rows\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.columns\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.stretch\n  }, !selectedProgram ? select : /*#__PURE__*/React.createElement(Tooltip, {\n    content: i18n.t('Clear program first to choose another')\n  }, select)), selectedProgram && /*#__PURE__*/React.createElement(Button, {\n    onClick: () => setSelectedProgramId(undefined)\n  }, i18n.t('Clear'))), showStageSelect && /*#__PURE__*/React.createElement(StageSelect, {\n    stages: selectedProgram.programStages\n  }));\n};\n\nProgramSelect.propTypes = {\n  programs: PropTypes.array.isRequired,\n  setSelectedProgramId: PropTypes.func.isRequired,\n  requiredStageSelection: PropTypes.bool,\n  selectedProgram: PropTypes.object\n};\nexport { ProgramSelect };","import { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { tSetUiProgram, acUpdateUiProgramStage, acClearUiProgram } from '../../../actions/ui.js';\nimport { useDebounce } from '../../../modules/utils.js';\nimport { DIMENSION_TYPE_ALL, OUTPUT_TYPE_EVENT } from '../../../modules/visualization.js';\nimport { sGetUiInputType, sGetUiProgramId, sGetUiProgramStage } from '../../../reducers/ui.js';\nimport { ProgramDimensionsFilter } from './ProgramDimensionsFilter.js';\nimport { ProgramDimensionsList } from './ProgramDimensionsList.js';\nimport styles from './ProgramDimensionsPanel.module.css';\nimport { ProgramSelect } from './ProgramSelect.js';\nconst PROGRAM_TYPE_WITHOUT_REGISTRATION = 'WITHOUT_REGISTRATION';\nconst PROGRAM_TYPE_WITH_REGISTRATION = 'WITH_REGISTRATION';\nconst query = {\n  programs: {\n    resource: 'programs',\n    params: {\n      fields: ['id', 'displayName~rename(name)', 'enrollmentDateLabel', 'incidentDateLabel', 'programType', 'programStages[id,displayName~rename(name),displayExecutionDateLabel,hideDueDate,displayDueDateLabel]', 'displayIncidentDate', 'displayIncidentDateLabel', 'displayEnrollmentDateLabel'],\n      paging: false\n    }\n  }\n};\n\nconst ProgramDimensionsPanel = ({\n  visible\n}) => {\n  const dispatch = useDispatch();\n  const inputType = useSelector(sGetUiInputType);\n  const selectedProgramId = useSelector(sGetUiProgramId);\n  const selectedStageId = useSelector(sGetUiProgramStage);\n\n  const setSelectedProgramId = programId => dispatch(tSetUiProgram({\n    programId,\n    metadata: {\n      [programId]: filteredPrograms.find(({\n        id\n      }) => id === programId)\n    }\n  }));\n\n  const {\n    fetching,\n    error,\n    data,\n    refetch,\n    called\n  } = useDataQuery(query, {\n    lazy: true\n  });\n  const [searchTerm, setSearchTerm] = useState('');\n  const [dimensionType, setDimensionType] = useState(DIMENSION_TYPE_ALL);\n  const debouncedSearchTerm = useDebounce(searchTerm);\n  const filteredPrograms = data === null || data === void 0 ? void 0 : data.programs.programs.filter(({\n    programType\n  }) => inputType === OUTPUT_TYPE_EVENT || programType === PROGRAM_TYPE_WITHOUT_REGISTRATION);\n  const selectedProgram = selectedProgramId && (filteredPrograms === null || filteredPrograms === void 0 ? void 0 : filteredPrograms.find(({\n    id\n  }) => id === selectedProgramId));\n  const programType = selectedProgram === null || selectedProgram === void 0 ? void 0 : selectedProgram.programType;\n  const requiredStageSelection = inputType === OUTPUT_TYPE_EVENT && programType === PROGRAM_TYPE_WITH_REGISTRATION;\n  const isProgramSelectionComplete = inputType === OUTPUT_TYPE_EVENT ? selectedProgram && selectedStageId : !!selectedProgram;\n  useEffect(() => {\n    if (visible && !called) {\n      refetch();\n    }\n  }, [visible, called]);\n  useEffect(() => {\n    // Clear everything when user changes input type\n    dispatch(acClearUiProgram());\n    setSearchTerm('');\n    setDimensionType(DIMENSION_TYPE_ALL);\n  }, [inputType]);\n  useEffect(() => {\n    if ( // These only have a single artificial stage\n    inputType === OUTPUT_TYPE_EVENT && programType === PROGRAM_TYPE_WITHOUT_REGISTRATION) {\n      const artificialStageId = selectedProgram.programStages[0].id;\n      dispatch(acUpdateUiProgramStage(artificialStageId));\n    }\n  }, [inputType, programType]);\n\n  if (!visible || !called) {\n    return null;\n  }\n\n  if (error && !fetching) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.section\n    }, /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: i18n.t('Could not load programs')\n    }, (error === null || error === void 0 ? void 0 : error.message) || i18n.t(\"The programs couldn't be retrieved. Try again or contact your system administrator.\")));\n  }\n\n  if (fetching) {\n    return /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, null));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.section, styles.bordered)\n  }, /*#__PURE__*/React.createElement(ProgramSelect, {\n    programs: filteredPrograms,\n    selectedProgram: selectedProgram,\n    setSelectedProgramId: setSelectedProgramId,\n    requiredStageSelection: requiredStageSelection\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.section, {\n      [styles.bordered]: !!selectedProgramId\n    })\n  }, isProgramSelectionComplete ? /*#__PURE__*/React.createElement(ProgramDimensionsFilter, {\n    program: selectedProgram,\n    searchTerm: searchTerm,\n    setSearchTerm: setSearchTerm,\n    dimensionType: dimensionType,\n    setDimensionType: setDimensionType\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.helptext\n  }, requiredStageSelection ? i18n.t('Choose a program and stage above to add program dimensions.') : i18n.t('Choose a program above to add program dimensions.'))), isProgramSelectionComplete && /*#__PURE__*/React.createElement(ProgramDimensionsList, {\n    inputType: inputType,\n    programId: selectedProgramId,\n    programName: selectedProgram.name,\n    dimensionType: dimensionType,\n    searchTerm: debouncedSearchTerm,\n    stageId: selectedStageId\n  }));\n};\n\nProgramDimensionsPanel.propTypes = {\n  visible: PropTypes.bool.isRequired\n};\nexport { ProgramDimensionsPanel };","import { useDataQuery } from '@dhis2/app-runtime';\nimport { useEffect, useState } from 'react';\nimport { DIMENSION_LIST_FIELDS } from '../DimensionsList/index.js';\nconst query = {\n  dimensions: {\n    resource: 'dimensions',\n    params: ({\n      page,\n      searchTerm\n    }) => {\n      // Fixed filer on org units for 2.38 ?\n      const filter = ['dimensionType:eq:ORGANISATION_UNIT_GROUP_SET'];\n\n      if (searchTerm) {\n        filter.push(`name:ilike:${searchTerm}`);\n      }\n\n      return {\n        pageSize: 50,\n        page,\n        fields: DIMENSION_LIST_FIELDS,\n        filter\n      };\n    }\n  }\n};\n\nconst useYourDimensions = ({\n  visible,\n  searchTerm\n}) => {\n  const [isListEndVisible, setIsListEndVisible] = useState(false);\n  const [dimensions, setDimensions] = useState([]);\n  const {\n    data,\n    error,\n    loading,\n    fetching,\n    called,\n    refetch\n  } = useDataQuery(query, {\n    lazy: true\n  });\n  useEffect(() => {\n    // Delay initial fetch until component comes into view\n    if (visible && !called) {\n      refetch({\n        page: 1\n      });\n    }\n  }, [visible, called]);\n  useEffect(() => {\n    if (visible) {\n      refetch({\n        page: 1,\n        searchTerm\n      });\n    } // Reset when filter changes\n\n\n    setDimensions([]);\n  }, [searchTerm]);\n  useEffect(() => {\n    if (data) {\n      const {\n        pager\n      } = data.dimensions;\n      const isLastPage = pager.pageSize * pager.page >= pager.total;\n\n      if (isListEndVisible && !isLastPage && !fetching) {\n        refetch({\n          page: data.page + 1,\n          searchTerm\n        });\n      }\n    }\n  }, [isListEndVisible]);\n  useEffect(() => {\n    if (data) {\n      setDimensions(currDimensions => [...currDimensions, ...data.dimensions.dimensions]);\n    }\n  }, [data]);\n  return {\n    loading,\n    fetching,\n    error,\n    dimensions,\n    setIsListEndVisible\n  };\n};\n\nexport { useYourDimensions };","import i18n from '@dhis2/d2-i18n';\nimport { Input } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { useDebounce } from '../../../modules/utils.js';\nimport { DimensionsList } from '../DimensionsList/index.js';\nimport { useYourDimensions } from './useYourDimensions.js';\nimport styles from './YourDimensionsPanel.module.css';\n\nconst YourDimensionsPanel = ({\n  visible\n}) => {\n  const [searchTerm, setSearchTerm] = useState('');\n  const debouncedSearchTerm = useDebounce(searchTerm);\n  const {\n    loading,\n    fetching,\n    error,\n    dimensions,\n    setIsListEndVisible\n  } = useYourDimensions({\n    visible,\n    searchTerm: debouncedSearchTerm\n  });\n\n  if (!visible) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.search\n  }, /*#__PURE__*/React.createElement(Input, {\n    value: searchTerm,\n    onChange: ({\n      value\n    }) => setSearchTerm(value),\n    dense: true,\n    placeholder: i18n.t('Search your dimensions')\n  })), /*#__PURE__*/React.createElement(DimensionsList, {\n    setIsListEndVisible: setIsListEndVisible,\n    dimensions: dimensions,\n    error: error,\n    fetching: fetching,\n    loading: loading,\n    searchTerm: debouncedSearchTerm\n  }));\n};\n\nYourDimensionsPanel.propTypes = {\n  visible: PropTypes.bool\n};\nexport { YourDimensionsPanel };","import i18n from '@dhis2/d2-i18n';\nimport { IconArrowRight16, IconFolder16 } from '@dhis2/ui';\nimport cx from 'classnames';\nimport React, { useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { acSetUiAccessoryPanelOpen, acSetUiDetailsPanelOpen } from '../../actions/ui.js';\nimport { sGetUiInputType, sGetUiShowAccessoryPanel } from '../../reducers/ui.js';\nimport { InputPanel, getLabelForInputType } from './InputPanel/index.js';\nimport styles from './MainSidebar.module.css';\nimport { MenuItem } from './MenuItem/index.js';\nimport { ProgramDimensionsPanel } from './ProgramDimensionsPanel/index.js';\nimport { YourDimensionsPanel } from './YourDimensionsPanel/index.js';\nconst TAB_INPUT = 'INPUT';\nconst TAB_PROGRAM = 'PROGRAM';\nconst TAB_YOUR = 'YOUR';\n\nconst MainSidebar = () => {\n  const dispatch = useDispatch();\n  const open = useSelector(sGetUiShowAccessoryPanel);\n  const selectedInputType = useSelector(sGetUiInputType);\n  const [selectedTabId, setSelectedTabId] = useState(null);\n\n  const setOpen = newOpen => dispatch(acSetUiAccessoryPanelOpen(newOpen));\n\n  const closeDetailsPanel = () => dispatch(acSetUiDetailsPanelOpen(false));\n\n  const onClick = id => {\n    if (open && id === selectedTabId) {\n      setSelectedTabId(null);\n      setOpen(false);\n    } else {\n      setSelectedTabId(id);\n      setOpen(true);\n      closeDetailsPanel();\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.main\n  }, /*#__PURE__*/React.createElement(MenuItem, {\n    icon: /*#__PURE__*/React.createElement(IconArrowRight16, null),\n    label: i18n.t('Input: {{type}}', {\n      type: getLabelForInputType(selectedInputType),\n      nsSeparator: '^^'\n    }),\n    onClick: () => onClick(TAB_INPUT),\n    selected: open && selectedTabId === TAB_INPUT\n  }), /*#__PURE__*/React.createElement(MenuItem, {\n    icon: /*#__PURE__*/React.createElement(IconFolder16, null),\n    label: i18n.t('Program dimensions'),\n    onClick: () => onClick(TAB_PROGRAM),\n    selected: open && selectedTabId === TAB_PROGRAM\n  }), /*#__PURE__*/React.createElement(MenuItem, {\n    icon: /*#__PURE__*/React.createElement(IconFolder16, null),\n    label: i18n.t('Your dimensions'),\n    onClick: () => onClick(TAB_YOUR),\n    selected: open && selectedTabId === TAB_YOUR,\n    count: 5\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.accessory, {\n      [styles.hidden]: !open,\n      [styles.padded]: selectedTabId === TAB_INPUT\n    })\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.accessoryInner\n  }, /*#__PURE__*/React.createElement(InputPanel, {\n    visible: selectedTabId === TAB_INPUT\n  }), /*#__PURE__*/React.createElement(ProgramDimensionsPanel, {\n    visible: selectedTabId === TAB_PROGRAM\n  }), /*#__PURE__*/React.createElement(YourDimensionsPanel, {\n    visible: selectedTabId === TAB_YOUR\n  }))));\n};\n\nexport { MainSidebar };","import i18n from '@dhis2/d2-i18n';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { STATE_UNSAVED, STATE_SAVED, STATE_DIRTY, getVisualizationState } from '../../modules/visualization.js';\nimport { sGetCurrent } from '../../reducers/current.js';\nimport { sGetVisualization } from '../../reducers/visualization.js';\nimport classes from './styles/TitleBar.module.css';\nexport const getTitleUnsaved = () => i18n.t('Unsaved visualization');\nexport const getTitleDirty = () => i18n.t('Edited');\nconst defaultTitleClasses = `${classes.cell} ${classes.title}`;\n\nconst getTitleText = (titleState, visualization) => {\n  switch (titleState) {\n    case STATE_UNSAVED:\n      return getTitleUnsaved();\n\n    case STATE_SAVED:\n    case STATE_DIRTY:\n      return visualization.name;\n\n    default:\n      return '';\n  }\n};\n\nconst getCustomTitleClasses = titleState => titleState === STATE_UNSAVED ? classes.titleUnsaved : '';\n\nconst getSuffix = titleState => titleState === STATE_DIRTY ? /*#__PURE__*/React.createElement(\"div\", {\n  className: cx(classes.titleDirty, classes.suffix),\n  \"data-test\": \"AO-title-dirty\"\n}, `- ${getTitleDirty()}`) : '';\n\nexport const TitleBar = ({\n  titleState,\n  titleText\n}) => {\n  const titleClasses = `${defaultTitleClasses} ${getCustomTitleClasses(titleState)}`;\n  return titleText ? /*#__PURE__*/React.createElement(\"div\", {\n    \"data-test\": \"AO-title\",\n    className: classes.titleBar\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: titleClasses\n  }, titleText, getSuffix(titleState))) : null;\n};\nTitleBar.propTypes = {\n  titleState: PropTypes.string,\n  titleText: PropTypes.string\n};\n\nconst mapStateToProps = state => ({\n  current: sGetCurrent(state),\n  visualization: sGetVisualization(state)\n});\n\nconst mergeProps = (stateProps, dispatchProps, ownProps) => {\n  const {\n    visualization,\n    current\n  } = stateProps;\n  const titleState = getVisualizationState(visualization, current);\n  return { ...dispatchProps,\n    ...ownProps,\n    titleState: titleState,\n    titleText: getTitleText(titleState, visualization)\n  };\n};\n\nexport default connect(mapStateToProps, null, mergeProps)(TitleBar);","import React from 'react';\nexport const GenericError = () => /*#__PURE__*/React.createElement(\"svg\", {\n  height: \"96\",\n  viewBox: \"0 0 96 96\",\n  width: \"96\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  fill: \"#a0adba\",\n  transform: \"translate(3 3)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m40.5 73.5000001c0 2.4852813 2.0147186 4.5 4.5 4.5s4.5-2.0147187 4.5-4.5c0-2.4142734-1.9012365-4.3844892-4.2881643-4.4951021l-.2128322-.0048979c-2.4848234.0005384-4.4990035 2.0150507-4.4990035 4.5z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m48 60v-30c0-1.6568542-1.3431458-3-3-3s-3 1.3431458-3 3v30c0 1.6568542 1.3431458 3 3 3s3-1.3431458 3-3z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m45-2.99904788c3.8985931 0 7.4578604 2.21715778 9.1770339 5.71709169l37.8912554 77.19048409c1.3845546 2.8165473 1.2171646 6.1482722-.4427191 8.811863-1.6598833 2.6635901-4.5771005 4.2816904-7.7135702 4.2796124h-77.82201115c-3.13845856.002078-6.05567574-1.6160223-7.71555901-4.2796124-1.65988369-2.6635908-1.82727377-5.9953157-.44346379-8.8103471l37.89234295-77.19269833c1.7188306-3.49923557 5.2780979-5.71639335 9.176691-5.71639335zm0 6c-1.6106864 0-3.0811818.91600885-3.7909661 2.36100407l-37.89274459 77.19351591c-.47005356.9562122-.41322496 2.0873262.15030227 2.99161.56352731.9042839 1.5539177 1.4529206 2.62140842 1.4529206h77.8259889c1.0655018 0 2.0558922-.5486367 2.6194195-1.4529206.5635272-.9042838.6203558-2.0353978.1495577-2.9931259l-37.8916571-77.19130167c-.7101272-1.44569356-2.1806226-2.36170241-3.791309-2.36170241z\"\n})));\nexport const EmptyBox = () => /*#__PURE__*/React.createElement(\"svg\", {\n  width: \"100\",\n  height: \"100\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M96.4184693 4.6480742l-2.9759268 2.6728C91.5558812 5.2202435 88.8786031 4 86 4V0c4.0260387 0 7.7809122 1.7113874 10.4184693 4.6480742zM100 19.269042h-4l-.0000544-5.3024514c-.0043849-1.346405-.2739964-2.6517927-.7866406-3.8623659l3.6833463-1.559795c.7189815 1.6978243 1.0971493 3.5288134 1.1032837 5.4156229L100 19.269042zm0 13.9999755h-4v-10h4v10zm0 14h-4v-10h4v10zm0 14h-4v-10h4v10zm0 13.9999995h-4v-9.9999995h4v9.9999995zm-.516108 14.50858l-3.8521996-1.077292C95.8751624 87.829701 96 86.924153 96 86v-6.730983h4V86c0 1.289184-.1747984 2.557136-.516108 3.777597zM87.7213345 99.895024l-.4874961-3.970182c2.8302961-.34753 5.3578432-1.892491 6.9762006-4.213767l3.2812621 2.287645c-2.2629208 3.245799-5.802045 5.409086-9.7699666 5.896304zM73.461965 100v-4h10v4h-10zm-14 0v-4h10v4h-10zm-14 0v-4h10v4h-10zm-14 0v-4h10v4h-10zm-14 0v-4h10v4h-10zM3.17264828 94.875717l3.09219912-2.537382c1.79303608 2.185097 4.4211055 3.525451 7.2855127 3.651773l-.176231 3.996116c-4.01094422-.176885-7.69477669-2.055693-10.20148082-5.110507zM0 80.192922h4l.00006331 5.84312c.00418159 1.190127.21554574 2.348454.61951638 3.438567L.86883696 90.864547C.3022517 89.335619.0059261 87.711683.00007566 86.043095L0 80.192922zm0-13.999974h4v10H0v-10zm0-14.0000005h4v10H0v-10zm0-14h4v10H0v-10zm0-14h4v10H0v-10zM.701349 9.6140131l3.79891292 1.2523021C4.17021443 11.8675286 4 12.9209553 4 14v6.1929475H0V14c0-1.5058511.2385093-2.9819426.701349-4.3859869zM12.9113947.0417954l.3073341 3.9881757c-2.8514503.2197365-5.43930476 1.6474003-7.16021518 3.8917822l-3.1742768-2.4339201C5.29022999 2.3499781 8.91606935.3496804 12.9113947.0417954zM27.07607 0v4h-10V0h10zm14 0v4h-10V0h10zm14 0v4h-10V0h10zm14 0v4h-10V0h10zm14 0v4h-10V0h10z\",\n  fill: \"#A0ADBA\",\n  fillRule: \"nonzero\"\n}));","import i18n from '@dhis2/d2-i18n';\nimport { EmptyBox, GenericError } from '../assets/ErrorIcons.js';\nexport class VisualizationError {\n  constructor(icon, title, description) {\n    this.icon = icon;\n    this.title = title;\n    this.description = description;\n  }\n\n}\nexport class GenericClientError extends VisualizationError {\n  constructor() {\n    super(GenericError, genericErrorTitle, i18n.t('There is a problem with this visualization.'));\n  }\n\n}\nexport class GenericServerError extends VisualizationError {\n  constructor() {\n    super(GenericError, genericErrorTitle, i18n.t('There was a problem getting the data from the server.'));\n  }\n\n}\nexport class EmptyResponseError extends VisualizationError {\n  constructor() {\n    super(EmptyBox, i18n.t('No data available'), i18n.t('The selected dimensions didn’t return any data. There may be no data, or you may not have access to it.'));\n  }\n\n}\nexport class VisualizationNotFoundError extends VisualizationError {\n  constructor() {\n    super(GenericError, i18n.t('Visualization not found'), i18n.t('The visualization you are trying to view could not be found, the ID could be incorrect or it could have been deleted.'));\n  }\n\n}\nexport const getAlertTypeByStatusCode = statusCode => String(statusCode).match(/50\\d/) ? 'error' : 'warning';\nexport const genericErrorTitle = i18n.t('Something went wrong');","import _JSXStyle from \"styled-jsx/style\";\nimport { colors, spacers } from '@dhis2/ui';\nimport React from 'react';\n/* eslint-disable-line no-unused-vars */\n\nexport const tabBar = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3103009923\"\n  }, [`div.jsx-3103009923{padding-right:${spacers.dp24};}`]),\n  className: \"jsx-3103009923\"\n};\nexport const tabContent = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2208787536\"\n  }, [`div.jsx-2208787536{overflow:auto;padding-right:${spacers.dp24};}`]),\n  className: \"jsx-2208787536\"\n};\nexport const tabSection = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"1427514941\"\n  }, [`div.jsx-1427514941{padding:${spacers.dp16} 0;}`, `div.jsx-1427514941:not(:last-child){border-bottom:1px solid ${colors.grey300};margin-bottom:${spacers.dp8};}`]),\n  className: \"jsx-1427514941\"\n};\nexport const tabSectionContent = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"1655721637\"\n  }, [\"div.jsx-1655721637{overflow-y:auto;}\"]),\n  className: \"jsx-1655721637\"\n};\nexport const tabSectionTitle = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3115295887\"\n  }, [`span.jsx-3115295887{display:inline-block;padding-bottom:${spacers.dp12};font-size:15px;color:${colors.grey900};font-weight:500;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;}`]),\n  className: \"jsx-3115295887\"\n};\nexport const tabSectionTitleMargin = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"642558349\"\n  }, [`span.jsx-642558349{margin-top:${spacers.dp8};}`]),\n  className: \"jsx-642558349\"\n};\nexport const tabSectionOption = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"1665807213\"\n  }, [`div.jsx-1665807213:not(:last-child):not(.inline){padding-bottom:${spacers.dp16};}`]),\n  className: \"jsx-1665807213\"\n};\nexport const tabSectionOptionItem = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2983019948\"\n  }, [`div.jsx-2983019948:not(:last-child){padding-bottom:${spacers.dp8};}`]),\n  className: \"jsx-2983019948\"\n};\nexport const tabSectionOptionText = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3330936769\"\n  }, [`p.jsx-3330936769{margin:0;padding-bottom:${spacers.dp8};font-size:14px;line-height:19px;color:${colors.grey700};}`]),\n  className: \"jsx-3330936769\"\n};\nexport const tabSectionOptionToggleable = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"684239008\"\n  }, [`div.jsx-684239008{margin:${spacers.dp4} 0 0 23px;}`]),\n  className: \"jsx-684239008\"\n};\nexport const tabSectionToggleableSubsection = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"1383096027\"\n  }, [\"div.jsx-1383096027{margin-left:23px;}\"]),\n  className: \"jsx-1383096027\"\n};\nexport const tabSectionOptionComplexInline = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"1912734430\"\n  }, [\"div.jsx-1912734430{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}\"]),\n  className: \"jsx-1912734430\"\n};\nexport const tabSectionOptionIcon = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"112181591\"\n  }, [`span.jsx-112181591{vertical-align:top;margin-right:${spacers.dp4};color:${colors.grey600};}`]),\n  className: \"jsx-112181591\"\n};","import { Checkbox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOptions } from '../../../reducers/ui.js';\nimport { tabSectionOption } from '../styles/VisualizationOptions.style.js';\nexport const CheckboxBaseOption = ({\n  option,\n  label,\n  value,\n  onChange,\n  inverted,\n  dataTest\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: tabSectionOption.className\n}, /*#__PURE__*/React.createElement(Checkbox, {\n  checked: inverted ? !value : value,\n  label: label,\n  name: option.name,\n  onChange: ({\n    checked\n  }) => onChange(inverted ? !checked : checked),\n  dense: true,\n  dataTest: dataTest\n}));\nCheckboxBaseOption.propTypes = {\n  dataTest: PropTypes.string,\n  inverted: PropTypes.bool,\n  label: PropTypes.string,\n  option: PropTypes.object,\n  value: PropTypes.bool,\n  onChange: PropTypes.func\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  value: sGetUiOptions(state)[ownProps.option.name]\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onChange: value => dispatch(acSetUiOptions({\n    [ownProps.option.name]: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CheckboxBaseOption);","import i18n from '@dhis2/d2-i18n';\nimport { Label } from '@dhis2/ui';\nimport React from 'react';\nimport { tabSectionOption } from '../styles/VisualizationOptions.style.js';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst CompletedOnly = () => /*#__PURE__*/React.createElement(\"div\", {\n  className: tabSectionOption.className\n}, /*#__PURE__*/React.createElement(Label, null, i18n.t('Event data')), /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Only include completed events'),\n  option: {\n    name: 'completedOnly'\n  }\n}));\n\nexport default CompletedOnly;","import { SingleSelectField, SingleSelectOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOptions } from '../../../reducers/ui.js';\nimport { tabSectionOption } from '../styles/VisualizationOptions.style.js';\nexport const SelectBaseOption = ({\n  option,\n  label,\n  value,\n  onChange,\n  dataTest\n}) => {\n  var _option$items$find;\n\n  const selected = (_option$items$find = option.items.find(item => item.value === value)) === null || _option$items$find === void 0 ? void 0 : _option$items$find.value;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: tabSectionOption.className\n  }, /*#__PURE__*/React.createElement(SingleSelectField, {\n    name: `${option.name}-select`,\n    label: label,\n    onChange: ({\n      selected\n    }) => onChange(selected),\n    selected: selected,\n    inputWidth: \"280px\",\n    dense: true,\n    dataTest: `${dataTest}-select`\n  }, option.items.map(({\n    value,\n    label\n  }) => /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: value,\n    value: value,\n    label: label,\n    dataTest: `${dataTest}-option`\n  }))));\n};\nSelectBaseOption.propTypes = {\n  option: PropTypes.object.isRequired,\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  onChange: PropTypes.func.isRequired,\n  dataTest: PropTypes.string,\n  label: PropTypes.string\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  value: sGetUiOptions(state)[ownProps.option.name]\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onChange: value => dispatch(acSetUiOptions({\n    [ownProps.option.name]: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SelectBaseOption);","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport SelectBaseOption from './SelectBaseOption.js';\n\nconst DigitGroupSeparator = () => /*#__PURE__*/React.createElement(SelectBaseOption, {\n  label: i18n.t('Digit group separator'),\n  option: {\n    name: 'digitGroupSeparator',\n    items: [{\n      value: 'NONE',\n      label: i18n.t('None')\n    }, {\n      value: 'SPACE',\n      label: i18n.t('Space')\n    }, {\n      value: 'COMMA',\n      label: i18n.t('Comma')\n    }]\n  }\n});\n\nexport default DigitGroupSeparator;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { DISPLAY_DENSITY_COMFORTABLE, DISPLAY_DENSITY_NORMAL, DISPLAY_DENSITY_COMPACT } from '../../../modules/options.js';\nimport { default as SelectBaseOption } from './SelectBaseOption.js';\n\nconst DisplayDensity = () => /*#__PURE__*/React.createElement(SelectBaseOption, {\n  label: i18n.t('Display density'),\n  option: {\n    name: 'displayDensity',\n    items: [{\n      value: DISPLAY_DENSITY_COMFORTABLE,\n      label: i18n.t('Comfortable')\n    }, {\n      value: DISPLAY_DENSITY_NORMAL,\n      label: i18n.t('Normal')\n    }, {\n      value: DISPLAY_DENSITY_COMPACT,\n      label: i18n.t('Compact')\n    }]\n  }\n});\n\nexport default DisplayDensity;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport SelectBaseOption from './SelectBaseOption.js';\n\nconst FontSize = () => /*#__PURE__*/React.createElement(SelectBaseOption, {\n  label: i18n.t('Font size'),\n  option: {\n    name: 'fontSize',\n    items: [{\n      value: 'LARGE',\n      label: i18n.t('Large')\n    }, {\n      value: 'NORMAL',\n      label: i18n.t('Normal')\n    }, {\n      value: 'SMALL',\n      label: i18n.t('Small')\n    }]\n  }\n});\n\nexport default FontSize;","import i18n from '@dhis2/d2-i18n';\nexport default (({\n  content\n}) => ({\n  key: 'data-display',\n  label: i18n.t('Display'),\n  content\n}));","import i18n from '@dhis2/d2-i18n';\nexport default (content => ({\n  key: 'data-tab',\n  label: i18n.t('Data'),\n  content\n}));","import i18n from '@dhis2/d2-i18n';\nexport default (content => ({\n  key: 'style-tab',\n  label: i18n.t('Style'),\n  content\n}));","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ColSubTotals = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Column sub-totals'),\n  option: {\n    name: 'colSubTotals'\n  }\n});\n\nexport default ColSubTotals;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ColTotals = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Columns totals'),\n  option: {\n    name: 'colTotals'\n  }\n});\n\nexport default ColTotals;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst HideEmptyRows = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Hide empty rows'),\n  option: {\n    name: 'hideEmptyRows'\n  }\n});\n\nexport default HideEmptyRows;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst RowSubTotals = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Row sub-totals'),\n  option: {\n    name: 'rowSubTotals'\n  }\n});\n\nexport default RowSubTotals;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst RowTotals = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Row totals'),\n  option: {\n    name: 'rowTotals'\n  }\n});\n\nexport default RowTotals;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ShowDimensionLabels = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Dimension labels'),\n  option: {\n    name: 'showDimensionLabels'\n  }\n});\n\nexport default ShowDimensionLabels;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ShowHierarchy = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Display organisation unit hierarchy'),\n  option: {\n    name: 'showHierarchy'\n  }\n});\n\nexport default ShowHierarchy;","import { InputField } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOptions } from '../../../reducers/ui.js';\nimport { tabSectionOption } from '../styles/VisualizationOptions.style.js';\nexport const TextBaseOption = ({\n  type,\n  label,\n  placeholder,\n  width,\n  option,\n  value,\n  onChange,\n  disabled,\n  dataTest\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: tabSectionOption.className\n}, /*#__PURE__*/React.createElement(InputField, {\n  type: type,\n  label: label,\n  onChange: ({\n    value\n  }) => onChange(value),\n  name: option.name,\n  value: value,\n  placeholder: placeholder,\n  inputWidth: width,\n  dense: true,\n  disabled: disabled,\n  dataTest: `${dataTest}-input`\n}));\nTextBaseOption.defaultProps = {\n  option: {}\n};\nTextBaseOption.propTypes = {\n  dataTest: PropTypes.string,\n  disabled: PropTypes.bool,\n  label: PropTypes.string,\n  option: PropTypes.object,\n  placeholder: PropTypes.string,\n  type: PropTypes.string,\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  width: PropTypes.string,\n  onChange: PropTypes.func\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  value: sGetUiOptions(state)[ownProps.option.name]\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onChange: value => dispatch(acSetUiOptions({\n    [ownProps.option.name]: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TextBaseOption);","import i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport TextBaseOption from './TextBaseOption.js';\n\nconst Title = ({\n  label\n}) => /*#__PURE__*/React.createElement(TextBaseOption, {\n  type: \"text\",\n  width: \"280px\",\n  label: label,\n  placeholder: i18n.t('Add a title'),\n  option: {\n    name: 'title'\n  }\n});\n\nTitle.propTypes = {\n  label: PropTypes.string\n};\nexport default Title;","import i18n from '@dhis2/d2-i18n';\nexport default (({\n  content\n}) => ({\n  key: 'data-empty-data',\n  label: i18n.t('Empty data'),\n  content\n}));","import i18n from '@dhis2/d2-i18n';\nexport default (({\n  content\n}) => ({\n  key: 'data-totals',\n  label: i18n.t('Totals'),\n  content\n}));","import { useDataEngine } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { SingleSelectField, SingleSelectOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOption } from '../../../actions/ui.js';\nimport { OPTION_LEGEND_SET } from '../../../modules/options.js';\nimport { sGetUiOption } from '../../../reducers/ui.js';\nconst query = {\n  legendSets: {\n    resource: 'legendSets',\n    params: {\n      fields: ['id', 'displayName~rename(name)', 'legends[id,displayName~rename(name),startValue,endValue,color]'],\n      paging: 'false'\n    }\n  }\n};\n\nconst LegendSetSelect = ({\n  value,\n  loading,\n  options,\n  onFocus,\n  onChange,\n  dataTest\n}) => /*#__PURE__*/React.createElement(SingleSelectField, {\n  name: \"legendSetSelect\",\n  label: i18n.t('Legend'),\n  selected: value === null || value === void 0 ? void 0 : value.id,\n  inputWidth: \"280px\",\n  placeholder: i18n.t('Select from legends'),\n  loadingText: i18n.t('Loading legends'),\n  loading: loading,\n  dense: true,\n  onFocus: onFocus,\n  onChange: ({\n    selected\n  }) => onChange({\n    id: selected,\n    displayName: options.find(option => option.value === selected).label\n  }),\n  dataTest: `${dataTest}-select`\n}, options.map(({\n  value,\n  label\n}) => /*#__PURE__*/React.createElement(SingleSelectOption, {\n  key: value,\n  value: value,\n  label: label,\n  dataTest: `${dataTest}-option`\n})));\n\nLegendSetSelect.propTypes = {\n  dataTest: PropTypes.string,\n  loading: PropTypes.bool,\n  options: PropTypes.array,\n  value: PropTypes.object,\n  onChange: PropTypes.func,\n  onFocus: PropTypes.func\n};\n\nconst LegendSet = ({\n  value,\n  onChange,\n  dataTest\n}) => {\n  const engine = useDataEngine();\n  const [options, setOptions] = useState([]);\n  const [isLoaded, setIsLoaded] = useState(false);\n\n  if (value && value.id) {\n    if (!options.find(option => option.value === value.id)) {\n      setOptions([...options, {\n        value: value.id,\n        label: value.displayName\n      }]);\n    }\n  }\n\n  const onSelectFocus = async () => {\n    if (!isLoaded) {\n      const {\n        legendSets\n      } = await engine.query(query);\n\n      if (legendSets) {\n        const options = legendSets.legendSets.map(legendSet => ({\n          value: legendSet.id,\n          label: legendSet.name\n        }));\n        setOptions(options);\n      }\n\n      setIsLoaded(true);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(LegendSetSelect, {\n    loading: !isLoaded,\n    value: value,\n    options: options,\n    onChange: onChange,\n    onFocus: onSelectFocus,\n    dataTest: dataTest\n  });\n};\n\nLegendSet.propTypes = {\n  onChange: PropTypes.func.isRequired,\n  dataTest: PropTypes.string,\n  value: PropTypes.object\n};\n\nconst mapStateToProps = state => ({\n  value: sGetUiOption(state, {\n    id: OPTION_LEGEND_SET\n  })\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onChange: ({\n    id,\n    displayName\n  }) => dispatch(acSetUiOption({\n    value: {\n      id,\n      displayName\n    },\n    optionId: OPTION_LEGEND_SET\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LegendSet);","import { LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM, LEGEND_DISPLAY_STRATEGY_FIXED } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { Radio, Field } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOption } from '../../../actions/ui.js';\nimport { OPTION_LEGEND_DISPLAY_STRATEGY } from '../../../modules/options.js';\nimport { sGetUiOption } from '../../../reducers/ui.js';\nimport { tabSectionOptionToggleable } from '../styles/VisualizationOptions.style.js';\nimport LegendSet from './LegendSet.js';\n\nconst LegendDisplayStrategy = ({\n  value,\n  onChange\n}) => /*#__PURE__*/React.createElement(Fragment, null, /*#__PURE__*/React.createElement(Field, {\n  name: OPTION_LEGEND_DISPLAY_STRATEGY,\n  dense: true\n}, /*#__PURE__*/React.createElement(Radio, {\n  key: LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM,\n  label: i18n.t('Use pre-defined legend per data item'),\n  value: LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM,\n  checked: value === LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM,\n  onChange: onChange,\n  dense: true,\n  dataTest: `legend-display-strategy-${LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM}`\n}), /*#__PURE__*/React.createElement(Radio, {\n  key: LEGEND_DISPLAY_STRATEGY_FIXED,\n  label: i18n.t('Select a single legend for the entire visualization'),\n  value: LEGEND_DISPLAY_STRATEGY_FIXED,\n  checked: value === LEGEND_DISPLAY_STRATEGY_FIXED,\n  onChange: onChange,\n  dense: true,\n  dataTest: `legend-display-strategy-${LEGEND_DISPLAY_STRATEGY_FIXED}`\n})), value === LEGEND_DISPLAY_STRATEGY_FIXED ? /*#__PURE__*/React.createElement(\"div\", {\n  className: tabSectionOptionToggleable.className\n}, /*#__PURE__*/React.createElement(LegendSet, {\n  dataTest: \"fixed-legend-set\"\n})) : null);\n\nLegendDisplayStrategy.propTypes = {\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = state => ({\n  value: sGetUiOption(state, {\n    id: OPTION_LEGEND_DISPLAY_STRATEGY\n  })\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onChange: ({\n    value\n  }) => dispatch(acSetUiOption({\n    optionId: OPTION_LEGEND_DISPLAY_STRATEGY,\n    value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LegendDisplayStrategy);","import { Field, Radio } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOption, acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOption, sGetUiOptions } from '../../../reducers/ui.js';\nexport const RadioBaseOption = ({\n  option,\n  label,\n  value,\n  onChange,\n  disabled,\n  dataTest\n}) => /*#__PURE__*/React.createElement(Field, {\n  name: option.name,\n  label: label,\n  dense: true\n}, option.items.map(({\n  id,\n  label\n}) => /*#__PURE__*/React.createElement(Radio, {\n  key: id,\n  label: label,\n  value: id,\n  checked: value === id,\n  onChange: ({\n    value\n  }) => onChange(value),\n  disabled: disabled,\n  dense: true,\n  dataTest: `${dataTest}-option-${id}`\n})));\nRadioBaseOption.propTypes = {\n  option: PropTypes.object.isRequired,\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  onChange: PropTypes.func.isRequired,\n  dataTest: PropTypes.string,\n  disabled: PropTypes.bool,\n  label: PropTypes.string\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  value: ownProps.option.id ? sGetUiOption(state, {\n    id: ownProps.option.id\n  }) : sGetUiOptions(state)[ownProps.option.name]\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onChange: value => ownProps.option.id ? dispatch(acSetUiOption({\n    optionId: ownProps.option.id,\n    value\n  })) : dispatch(acSetUiOptions({\n    [ownProps.option.name]: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RadioBaseOption);","import { LEGEND_DISPLAY_STYLE_FILL, LEGEND_DISPLAY_STYLE_TEXT } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { OPTION_LEGEND_DISPLAY_STYLE } from '../../../modules/options.js';\nimport RadioBaseOption from './RadioBaseOption.js';\n\nconst LegendDisplayStyle = () => /*#__PURE__*/React.createElement(RadioBaseOption, {\n  option: {\n    id: OPTION_LEGEND_DISPLAY_STYLE,\n    items: [{\n      id: LEGEND_DISPLAY_STYLE_FILL,\n      label: i18n.t('Legend changes background color')\n    }, {\n      id: LEGEND_DISPLAY_STYLE_TEXT,\n      label: i18n.t('Legend changes text color')\n    }]\n  },\n  dataTest: 'legend-display-style'\n});\n\nexport default LegendDisplayStyle;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { OPTION_SHOW_LEGEND_KEY } from '../../../modules/options.js';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ShowLegendKey = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Show legend key'),\n  option: {\n    id: OPTION_SHOW_LEGEND_KEY\n  },\n  dataTest: 'option-legend-key'\n});\n\nexport default ShowLegendKey;","import { LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM, LEGEND_DISPLAY_STRATEGY_FIXED, LEGEND_DISPLAY_STYLE_FILL } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { Checkbox, FieldSet, Legend as UiCoreLegend } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOption } from '../../../actions/ui.js';\nimport { OPTION_LEGEND_DISPLAY_STRATEGY, OPTION_LEGEND_DISPLAY_STYLE, OPTION_LEGEND_SET } from '../../../modules/options.js';\nimport { sGetUiOption } from '../../../reducers/ui.js';\nimport { tabSectionOptionToggleable, tabSectionOption, tabSectionTitle, tabSectionTitleMargin } from '../styles/VisualizationOptions.style.js';\nimport LegendDisplayStrategy from './LegendDisplayStrategy.js';\nimport LegendDisplayStyle from './LegendDisplayStyle.js';\nimport ShowLegendKey from './ShowLegendKey.js';\n\nconst Legend = ({\n  legendSet,\n  legendDisplayStrategy,\n  onChange,\n  hideStyleOptions\n}) => {\n  const [legendEnabled, setLegendEnabled] = useState(!((!legendDisplayStrategy || legendDisplayStrategy === LEGEND_DISPLAY_STRATEGY_FIXED) && !legendSet));\n\n  const onCheckboxChange = ({\n    checked\n  }) => {\n    setLegendEnabled(checked);\n\n    if (checked) {\n      onChange({\n        optionId: OPTION_LEGEND_DISPLAY_STRATEGY,\n        value: LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM\n      });\n      onChange({\n        optionId: OPTION_LEGEND_DISPLAY_STYLE,\n        value: LEGEND_DISPLAY_STYLE_FILL\n      });\n    } else {\n      onChange({\n        optionId: OPTION_LEGEND_DISPLAY_STRATEGY,\n        value: LEGEND_DISPLAY_STRATEGY_FIXED\n      });\n      onChange({\n        optionId: OPTION_LEGEND_SET,\n        value: undefined\n      });\n      onChange({\n        optionId: OPTION_LEGEND_DISPLAY_STYLE,\n        value: undefined\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: tabSectionOption.className\n  }, /*#__PURE__*/React.createElement(Checkbox, {\n    checked: legendEnabled,\n    label: i18n.t('Use legend for chart colors'),\n    onChange: onCheckboxChange,\n    dense: true\n  }), legendEnabled ? /*#__PURE__*/React.createElement(\"div\", {\n    className: tabSectionOptionToggleable.className\n  }, !hideStyleOptions ? /*#__PURE__*/React.createElement(\"div\", {\n    className: tabSectionOption.className\n  }, /*#__PURE__*/React.createElement(FieldSet, null, /*#__PURE__*/React.createElement(UiCoreLegend, null, /*#__PURE__*/React.createElement(\"span\", {\n    className: cx(tabSectionTitle.className, tabSectionTitleMargin.className)\n  }, i18n.t('Legend style'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: tabSectionOption.className\n  }, /*#__PURE__*/React.createElement(LegendDisplayStyle, null)))) : null, /*#__PURE__*/React.createElement(\"div\", {\n    className: tabSectionOption.className\n  }, /*#__PURE__*/React.createElement(FieldSet, null, /*#__PURE__*/React.createElement(UiCoreLegend, null, /*#__PURE__*/React.createElement(\"span\", {\n    className: cx(tabSectionTitle.className, {\n      [tabSectionTitleMargin.className]: hideStyleOptions\n    })\n  }, i18n.t('Legend type'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: tabSectionOption.className\n  }, /*#__PURE__*/React.createElement(LegendDisplayStrategy, null)))), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(ShowLegendKey, null))) : null);\n};\n\nLegend.propTypes = {\n  onChange: PropTypes.func.isRequired,\n  hideStyleOptions: PropTypes.bool,\n  legendDisplayStrategy: PropTypes.string,\n  legendSet: PropTypes.object\n};\n\nconst mapStateToProps = state => ({\n  legendSet: sGetUiOption(state, {\n    id: OPTION_LEGEND_SET\n  }),\n  legendDisplayStrategy: sGetUiOption(state, {\n    id: OPTION_LEGEND_DISPLAY_STRATEGY\n  })\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onChange: params => dispatch(acSetUiOption(params))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Legend);","function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { Button, Input, Label, SingleSelect, SingleSelectOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOptions } from '../../../reducers/ui.js';\nimport { tabSectionOption, tabSectionOptionText, tabSectionOptionComplexInline } from '../styles/VisualizationOptions.style.js';\n\nconst OperatorSelect = ({\n  name,\n  value,\n  onChange\n}) => {\n  const options = [{\n    id: 'EQ',\n    label: '='\n  }, {\n    id: 'GT',\n    label: '>'\n  }, {\n    id: 'GE',\n    label: '>='\n  }, {\n    id: 'LT',\n    label: '<'\n  }, {\n    id: 'LE',\n    label: '<='\n  }];\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '112px'\n    }\n  }, /*#__PURE__*/React.createElement(SingleSelect, {\n    name: name,\n    onChange: ({\n      selected\n    }) => {\n      onChange(selected);\n    },\n    selected: value,\n    tabIndex: \"0\",\n    inputMaxWidth: \"106px\",\n    dense: true\n  }, options.map(({\n    id,\n    label\n  }) => /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: id,\n    value: id,\n    label: label\n  }))));\n};\n\nOperatorSelect.propTypes = {\n  name: PropTypes.string.isRequired,\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nconst ValueInput = ({\n  name,\n  value,\n  onChange\n}) => /*#__PURE__*/React.createElement(Input, {\n  name: name,\n  value: value,\n  type: \"number\",\n  onChange: ({\n    value\n  }) => onChange(value),\n  width: \"72px\",\n  dense: true\n});\n\nValueInput.propTypes = {\n  name: PropTypes.string.isRequired,\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nclass MeasureCriteria extends Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"onClear\", () => this.setState(this.defaultState, this.props.onChange('')));\n\n    _defineProperty(this, \"onChange\", name => value => {\n      this.setState({\n        [name]: value\n      }, () => {\n        const {\n          op1,\n          v1,\n          op2,\n          v2\n        } = this.state;\n        const value = [];\n\n        if (op1 && v1) {\n          value.push(`${op1}:${v1}`);\n        }\n\n        if (op2 && v2) {\n          value.push(`${op2}:${v2}`);\n        }\n\n        this.props.onChange(value.length > 0 ? value.join(';') : '');\n      });\n    });\n\n    this.defaultState = {\n      op1: '',\n      v1: '',\n      op2: '',\n      v2: ''\n    };\n    const [_op = '', _v = '', _op2 = '', _v2 = ''] = props.value.split(/[;:]/);\n    this.state = {\n      op1: _op,\n      v1: _v,\n      op2: _op2,\n      v2: _v2\n    };\n  }\n\n  render() {\n    const {\n      op1,\n      v1,\n      op2,\n      v2\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: tabSectionOption.className\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: tabSectionOptionText.className\n    }, i18n.t('You can set a minimum or maximum value. This will apply to the entire visualization, all values outside of the minimum/maximum range will not be displayed')), /*#__PURE__*/React.createElement(\"div\", {\n      className: tabSectionOptionComplexInline.className\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: '250px'\n      }\n    }, /*#__PURE__*/React.createElement(Label, null, i18n.t('Minimum data value')), /*#__PURE__*/React.createElement(\"div\", {\n      className: tabSectionOptionComplexInline.className\n    }, /*#__PURE__*/React.createElement(OperatorSelect, {\n      name: \"op1\",\n      value: op1,\n      onChange: this.onChange('op1')\n    }), /*#__PURE__*/React.createElement(ValueInput, {\n      name: \"v1\",\n      value: v1,\n      onChange: this.onChange('v1')\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: '250px'\n      }\n    }, /*#__PURE__*/React.createElement(Label, null, i18n.t('Maximum data value')), /*#__PURE__*/React.createElement(\"div\", {\n      className: tabSectionOptionComplexInline.className\n    }, /*#__PURE__*/React.createElement(OperatorSelect, {\n      name: \"op2\",\n      value: op2,\n      onChange: this.onChange('op2')\n    }), /*#__PURE__*/React.createElement(ValueInput, {\n      name: \"v2\",\n      value: v2,\n      onChange: this.onChange('v2')\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        paddingTop: '16px'\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      onClick: this.onClear\n    }, i18n.t('Clear min/max limits'))));\n  }\n\n}\n\nMeasureCriteria.propTypes = {\n  value: PropTypes.string,\n  onChange: PropTypes.func\n};\n\nconst mapStateToProps = state => ({\n  value: sGetUiOptions(state).measureCriteria || ''\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onChange: value => dispatch(acSetUiOptions({\n    measureCriteria: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MeasureCriteria);","import { VIS_TYPE_PIVOT_TABLE } from '@dhis2/analytics';\nimport lineListConfig from './lineListConfig.js';\nimport pivotTableConfig from './pivotTableConfig.js';\nexport const getOptionsByType = type => {\n  switch (type) {\n    case VIS_TYPE_PIVOT_TABLE:\n      return pivotTableConfig();\n\n    default:\n      return lineListConfig();\n  }\n};","/* eslint-disable react/jsx-key */\nimport i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport ColSubTotals from '../../components/VisualizationOptions/Options/ColSubTotals.js';\nimport ColTotals from '../../components/VisualizationOptions/Options/ColTotals.js';\nimport DigitGroupSeparator from '../../components/VisualizationOptions/Options/DigitGroupSeparator.js';\nimport DisplayDensity from '../../components/VisualizationOptions/Options/DisplayDensity.js';\nimport FontSize from '../../components/VisualizationOptions/Options/FontSize.js';\nimport HideEmptyRows from '../../components/VisualizationOptions/Options/HideEmptyRows.js';\nimport RowSubTotals from '../../components/VisualizationOptions/Options/RowSubTotals.js';\nimport RowTotals from '../../components/VisualizationOptions/Options/RowTotals.js';\nimport ShowDimensionLabels from '../../components/VisualizationOptions/Options/ShowDimensionLabels.js';\nimport ShowHierarchy from '../../components/VisualizationOptions/Options/ShowHierarchy.js';\nimport Title from '../../components/VisualizationOptions/Options/Title.js';\nimport getDisplayTemplate from './sections/templates/display.js';\nimport getEmptyDataTemplate from './sections/templates/emptyData.js';\nimport getTotalsTemplate from './sections/templates/totals.js';\nimport getDataTab from './tabs/data.js';\nimport getLegendTab from './tabs/legend.js';\nimport getLimitValuesTab from './tabs/limitValues.js';\nimport getStyleTab from './tabs/style.js';\nexport default (() => [getDataTab([getDisplayTemplate({\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(ShowHierarchy, null), /*#__PURE__*/React.createElement(ShowDimensionLabels, null)])\n}), getTotalsTemplate({\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(ColTotals, null), /*#__PURE__*/React.createElement(ColSubTotals, null), /*#__PURE__*/React.createElement(RowTotals, null), /*#__PURE__*/React.createElement(RowSubTotals, null)])\n}), getEmptyDataTemplate({\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(HideEmptyRows, null) //TODO: hide n/a data\n  ])\n})]), getLegendTab(), getStyleTab([{\n  key: 'style-section-1',\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(Title, {\n    label: i18n.t('Table title')\n  }), /*#__PURE__*/React.createElement(DisplayDensity, null), /*#__PURE__*/React.createElement(FontSize, null), /*#__PURE__*/React.createElement(DigitGroupSeparator, null)])\n}]), getLimitValuesTab() // TODO: include these two options instead\n//Limit the number of rows shown in the table\n//Only show the [top/bottom] x rows\n]);","/* eslint-disable react/jsx-key */\nimport i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport Legend from '../../../components/VisualizationOptions/Options/Legend.js';\nexport default (() => ({\n  key: 'legend-tab',\n  label: i18n.t('Legend'),\n  content: [{\n    key: 'legend-section-1',\n    content: React.Children.toArray([/*#__PURE__*/React.createElement(Legend, null)])\n  }]\n}));","/* eslint-disable react/jsx-key */\nimport i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport MeasureCriteria from '../../../components/VisualizationOptions/Options/MeasureCriteria.js';\nexport default (() => ({\n  key: 'limitValues-tab',\n  label: i18n.t('Limit values'),\n  content: [\n  /*\n  {\n      key: 'limitValues-limit-numbers',\n      label: i18n.t('Limit number of values'),\n      content: [<TopLimit />],\n  },*/\n  {\n    key: 'limitValues-limit-min-max',\n    label: i18n.t('Limit minimum/maximum values'),\n    content: React.Children.toArray([/*#__PURE__*/React.createElement(MeasureCriteria, null)])\n  }]\n}));","/* eslint-disable react/jsx-key */\nimport React from 'react';\nimport CompletedOnly from '../../components/VisualizationOptions/Options/CompletedOnly.js';\nimport DigitGroupSeparator from '../../components/VisualizationOptions/Options/DigitGroupSeparator.js';\nimport DisplayDensity from '../../components/VisualizationOptions/Options/DisplayDensity.js';\nimport FontSize from '../../components/VisualizationOptions/Options/FontSize.js';\nimport getDisplayTemplate from './sections/templates/display.js';\nimport getDataTab from './tabs/data.js';\nimport getStyleTab from './tabs/style.js';\nexport default (() => [getDataTab([getDisplayTemplate({\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(CompletedOnly, null)])\n})]), getStyleTab([{\n  key: 'style-section-1',\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(DisplayDensity, null), /*#__PURE__*/React.createElement(FontSize, null), /*#__PURE__*/React.createElement(DigitGroupSeparator, null)])\n}])]);","import { VisualizationOptions } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect, useDispatch } from 'react-redux';\nimport { tSetCurrentFromUi } from '../../actions/current.js';\nimport { acSetShowExpandedLayoutPanel } from '../../actions/ui.js';\nimport { getOptionsByType } from '../../modules/options/config.js';\nimport MenuButton from '../Toolbar/MenuBar/MenuButton.js'; //import UpdateVisualizationContainer from '../UpdateButton/UpdateVisualizationContainer.js'\n\nconst VisualizationOptionsManager = ({\n  onUpdate\n}) => {\n  const [dialogIsOpen, setDialogIsOpen] = useState(false);\n  const dispatch = useDispatch();\n\n  const onClick = () => {\n    setDialogIsOpen(false); // try {\n    //     validateLayout(getCurrentFromUi())\n    //     acClearLoadError()\n    // } catch (error) {\n    //     acSetLoadError(error || new GenericClientError())\n    // }\n    //onLoadingStart()\n\n    onUpdate();\n    dispatch(acSetShowExpandedLayoutPanel(false));\n  };\n\n  const optionsConfig = getOptionsByType();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(MenuButton, {\n    \"data-test\": 'app-menubar-options-button',\n    onClick: () => setDialogIsOpen(true)\n  }, i18n.t('Options')), dialogIsOpen && /*#__PURE__*/React.createElement(VisualizationOptions, {\n    optionsConfig: optionsConfig,\n    onUpdate: onClick,\n    onClose: () => setDialogIsOpen(false)\n  }));\n};\n\nVisualizationOptionsManager.propTypes = {\n  onUpdate: PropTypes.func\n};\n\nconst mapStateToProps = () => ({});\n\nconst mapDispatchToProps = {\n  onUpdate: tSetCurrentFromUi\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(VisualizationOptionsManager);","import i18n from '@dhis2/d2-i18n';\nimport { IconChevronRight24, IconChevronLeft24 } from '@dhis2/ui';\nimport React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { acSetUiDetailsPanelOpen } from '../../../actions/ui.js';\nimport { sGetCurrentId } from '../../../reducers/current.js';\nimport { sGetUiShowDetailsPanel } from '../../../reducers/ui.js';\nimport MenuButton from './MenuButton.js';\nimport styles from './styles/InterpretationsButton.module.css';\nexport const InterpretationsButton = () => {\n  const showDetailsPanel = useSelector(sGetUiShowDetailsPanel);\n  const id = useSelector(sGetCurrentId);\n  const dispatch = useDispatch();\n\n  const onClick = () => {\n    dispatch(acSetUiDetailsPanelOpen(!showDetailsPanel));\n  };\n\n  return /*#__PURE__*/React.createElement(MenuButton, {\n    disabled: !id,\n    onClick: onClick\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.iconWrapper\n  }, showDetailsPanel ? /*#__PURE__*/React.createElement(IconChevronRight24, null) : /*#__PURE__*/React.createElement(IconChevronLeft24, null)), i18n.t('Interpretations'));\n};","import { FileMenu } from '@dhis2/analytics';\nimport { useDataMutation, useAlert } from '@dhis2/app-runtime';\nimport { useD2 } from '@dhis2/app-runtime-adapter-d2';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect, useDispatch } from 'react-redux';\nimport { acSetCurrent, tSetCurrentFromUi } from '../../../actions/current.js';\nimport { acSetShowExpandedLayoutPanel } from '../../../actions/ui.js';\nimport { acSetVisualization } from '../../../actions/visualization.js';\nimport { getAlertTypeByStatusCode } from '../../../modules/error.js';\nimport history from '../../../modules/history.js';\nimport { sGetCurrent } from '../../../reducers/current.js';\nimport { sGetVisualization } from '../../../reducers/visualization.js';\nimport { ToolbarDownloadDropdown } from '../../DownloadMenu/index.js';\nimport VisualizationOptionsManager from '../../VisualizationOptions/VisualizationOptionsManager.js';\nimport { InterpretationsButton } from './InterpretationsButton.js';\nimport classes from './styles/MenuBar.module.css';\nconst visualizationSaveMutation = {\n  type: 'create',\n  resource: 'eventVisualizations',\n  data: ({\n    visualization\n  }) => visualization,\n  params: {\n    skipTranslations: true,\n    skipSharing: true\n  }\n};\nconst visualizationSaveAsMutation = {\n  type: 'update',\n  resource: 'eventVisualizations',\n  id: ({\n    visualization\n  }) => visualization.id,\n  data: ({\n    visualization\n  }) => visualization,\n  params: {\n    skipTranslations: true,\n    skipSharing: true\n  }\n};\nexport const MenuBar = ({\n  dataTest,\n  current,\n  visualization,\n  apiObjectName,\n  setCurrent,\n  setVisualization,\n  onUpdate\n}) => {\n  const {\n    d2\n  } = useD2();\n  const {\n    show: showAlert\n  } = useAlert(({\n    message\n  }) => message, ({\n    options\n  }) => options);\n  const dispatch = useDispatch();\n\n  const onOpen = id => {\n    const path = `/${id}`;\n\n    if (history.location.pathname === path) {\n      history.replace({\n        pathname: path,\n        state: {\n          isOpening: true\n        }\n      });\n    } else {\n      history.push(path);\n    }\n  };\n\n  const onNew = () => {\n    if (history.location.pathname === '/') {\n      history.replace({\n        pathname: '/',\n        state: {\n          isResetting: true\n        }\n      });\n    } else {\n      history.push('/');\n    }\n  };\n\n  const onDelete = () => {\n    const deletedVisualization = current.name;\n    history.push('/');\n    showAlert({\n      message: i18n.t('\"{{deletedObject}}\" successfully deleted.', {\n        deletedObject: deletedVisualization\n      }),\n      options: {\n        success: true,\n        duration: 2000\n      }\n    });\n  };\n\n  const onRename = ({\n    name,\n    description\n  }) => {\n    const updatedVisualization = { ...visualization\n    };\n    const updatedCurrent = { ...current\n    };\n\n    if (name) {\n      updatedVisualization.name = updatedCurrent.name = name;\n    }\n\n    if (description) {\n      updatedVisualization.description = updatedCurrent.description = description;\n    } else {\n      delete updatedVisualization.description;\n      delete updatedCurrent.description;\n    }\n\n    setVisualization(updatedVisualization);\n\n    if (visualization === current) {\n      setCurrent(updatedVisualization);\n    } else {\n      setCurrent(updatedCurrent);\n    }\n\n    showAlert({\n      message: i18n.t('Rename successful'),\n      options: {\n        success: true,\n        duration: 2000\n      }\n    });\n  };\n\n  const onSave = (details = {}, copy = false) => {\n    const visualization = current; // TODO getVisualizationFromCurrent\n\n    visualization.name = // name provided in Save dialog\n    details.name || // existing name when saving the same modified visualization\n    visualization.name || // new visualization with no name provided in Save dialog\n    i18n.t('Untitled {{visualizationType}} visualization, {{date}}', {\n      visualizationType: 'TEXT',\n      // TODO Line list/PT?\n      date: new Date().toLocaleDateString(undefined, {\n        year: 'numeric',\n        month: 'short',\n        day: '2-digit'\n      })\n    });\n\n    if (details.description) {\n      visualization.description = details.description;\n    }\n\n    if (copy) {\n      delete visualization.id;\n      postVisualization({\n        visualization\n      });\n    } else {\n      putVisualization({\n        visualization\n      });\n    }\n  };\n\n  const onSaveComplete = (res, copy = false) => {\n    if (res.response.uid) {\n      const historyEntry = {\n        pathname: `/${res.response.uid}`,\n        state: {\n          isSaving: true\n        }\n      }; // Save As\n\n      if (copy) {\n        history.push(historyEntry);\n      } // Save\n      else {\n        history.replace(historyEntry);\n      }\n    }\n  };\n\n  const onError = error => {\n    // TODO remove once tested\n    console.log('Error:', error);\n    const message = error.errorCode === 'E4030' ? i18n.t(\"This visualization can't be deleted because it is used on one or more dashboards\") : error.message;\n    showAlert({\n      message,\n      options: {\n        [getAlertTypeByStatusCode(error.httpStatusCode)]: true\n      }\n    });\n  };\n\n  const [postVisualization] = useDataMutation(visualizationSaveMutation, {\n    onComplete: onSaveComplete,\n    onError\n  });\n  const [putVisualization] = useDataMutation(visualizationSaveAsMutation, {\n    onComplete: () => res => onSaveComplete(res, true),\n    onError\n  });\n\n  const onUpdateClick = () => {\n    // TODO: More things to be added here later (validation, error handling etc).\n    // Should be in line with the onClick in VisualizationsOptionsManager\n    onUpdate();\n    dispatch(acSetShowExpandedLayoutPanel(false));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.menuBar,\n    \"data-test\": dataTest\n  }, /*#__PURE__*/React.createElement(Button, {\n    className: classes.updateButton,\n    onClick: onUpdateClick,\n    type: \"button\",\n    primary: true,\n    small: true\n  }, i18n.t('Update')), /*#__PURE__*/React.createElement(FileMenu, {\n    d2: d2,\n    fileType: apiObjectName,\n    fileObject: current,\n    onOpen: onOpen,\n    onNew: onNew,\n    onRename: onRename,\n    onSave: onSave,\n    onSaveAs: details => onSave(details, true),\n    onDelete: onDelete,\n    onError: onError\n  }), /*#__PURE__*/React.createElement(VisualizationOptionsManager, null), /*#__PURE__*/React.createElement(ToolbarDownloadDropdown, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.flexGrow\n  }), /*#__PURE__*/React.createElement(InterpretationsButton, null));\n};\nMenuBar.propTypes = {\n  apiObjectName: PropTypes.string,\n  current: PropTypes.object,\n  dataTest: PropTypes.string,\n  setCurrent: PropTypes.func,\n  setVisualization: PropTypes.func,\n  visualization: PropTypes.object,\n  onUpdate: PropTypes.func\n};\n\nconst mapStateToProps = state => ({\n  current: sGetCurrent(state),\n  visualization: sGetVisualization(state)\n});\n\nconst mapDispatchToProps = {\n  setCurrent: acSetCurrent,\n  setVisualization: acSetVisualization,\n  onUpdate: tSetCurrentFromUi\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(MenuBar);","import PropTypes from 'prop-types';\nimport React from 'react';\n\nconst ArrowDown = ({\n  style = {\n    width: 16,\n    height: 16\n  }\n}) => /*#__PURE__*/React.createElement(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  viewBox: \"0 0 16 16\",\n  version: \"1.1\",\n  style: style\n}, /*#__PURE__*/React.createElement(\"g\", {\n  stroke: \"none\",\n  strokeWidth: \"1\",\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M7.29289,11.7071 C7.68342,12.0976 8.31658,12.0976 8.70711,11.7071 L13.7071,6.70711 C14.0976,6.31658 14.0976,5.68342 13.7071,5.29289 C13.3166,4.90237 12.6834,4.90237 12.2929,5.29289 L8,9.58579 L3.70711,5.29289 C3.31658,4.90237 2.68342,4.90237 2.29289,5.29289 C1.90237,5.68342 1.90237,6.31658 2.29289,6.70711 L7.29289,11.7071 Z\",\n  fill: \"#4A5768\"\n})));\n\nArrowDown.propTypes = {\n  style: PropTypes.object\n};\nexport default ArrowDown;","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { visTypeMap } from '../../../modules/visualization.js';\n\nconst ListItemIcon = ({\n  visType,\n  style\n}) => {\n  const Icon = visTypeMap[visType].icon;\n  return /*#__PURE__*/React.createElement(Icon, {\n    style: style\n  });\n};\n\nListItemIcon.propTypes = {\n  style: PropTypes.object,\n  visType: PropTypes.string\n};\nexport default ListItemIcon;","import cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ListItemIcon from './ListItemIcon.js';\nimport classes from './styles/VisualizationTypeSelector.module.css';\n\nconst VisualizationTypeListItem = ({\n  visType,\n  label,\n  description,\n  disabled,\n  isSelected,\n  onClick\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: cx(classes.listItem, {\n    [classes.listItemActive]: isSelected,\n    [classes.listItemDisabled]: disabled\n  }),\n  onClick: onClick\n}, /*#__PURE__*/React.createElement(\"div\", {\n  className: classes.listItemIcon\n}, /*#__PURE__*/React.createElement(ListItemIcon, {\n  visType: visType,\n  style: {\n    width: 48,\n    height: 48\n  }\n})), /*#__PURE__*/React.createElement(\"div\", {\n  className: classes.listItemText\n}, /*#__PURE__*/React.createElement(\"p\", {\n  className: classes.listItemName\n}, label), /*#__PURE__*/React.createElement(\"p\", {\n  className: classes.listItemDescription\n}, description)));\n\nVisualizationTypeListItem.propTypes = {\n  description: PropTypes.string,\n  disabled: PropTypes.bool,\n  isSelected: PropTypes.bool,\n  label: PropTypes.string,\n  visType: PropTypes.string,\n  onClick: PropTypes.func\n};\nexport default VisualizationTypeListItem;","import { Card, Popper, Layer, Tooltip } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState, createRef } from 'react';\nimport { connect } from 'react-redux';\nimport ArrowDown from '../../../assets/ArrowDown.js';\nimport { visTypeMap } from '../../../modules/visualization.js';\nimport { sGetUi, sGetUiType } from '../../../reducers/ui.js';\nimport ListItemIcon from './ListItemIcon.js';\nimport classes from './styles/VisualizationTypeSelector.module.css';\nimport VisualizationTypeListItem from './VisualizationTypeListItem.js';\nexport const VisualizationTypeSelector = ({\n  visualizationType\n}) => {\n  const [listIsOpen, setListIsOpen] = useState(false);\n\n  const handleListItemClick = () => () => {\n    // TODO add set UI when PT is available\n    setListIsOpen(false);\n  };\n\n  const getVisTypes = () => Object.keys(visTypeMap).sort();\n\n  const renderVisualizationTypeListItem = type => {\n    const isDisabled = visTypeMap[type].disabled;\n    return /*#__PURE__*/React.createElement(VisualizationTypeListItem, {\n      key: type,\n      visType: type,\n      label: visTypeMap[type].name,\n      description: visTypeMap[type].description,\n      isSelected: type === visualizationType,\n      onClick: isDisabled ? null : handleListItemClick(type),\n      disabled: isDisabled\n    });\n  };\n\n  const VisTypesList = /*#__PURE__*/React.createElement(Card, {\n    dataTest: 'visualization-type-selector-card'\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.listContainer\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.listSection\n  }, getVisTypes().map(type => visTypeMap[type].disabled ? /*#__PURE__*/React.createElement(Tooltip, {\n    key: `${type}-tooltip`,\n    placement: \"bottom\",\n    content: visTypeMap[type].disabledText\n  }, renderVisualizationTypeListItem(type)) : renderVisualizationTypeListItem(type)))));\n  const buttonRef = /*#__PURE__*/createRef();\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    onClick: () => setListIsOpen(true),\n    ref: buttonRef,\n    className: classes.button,\n    \"data-test\": 'visualization-type-selector-button'\n  }, /*#__PURE__*/React.createElement(ListItemIcon, {\n    visType: visualizationType\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    \"data-test\": \"visualization-type-selector-currently-selected-text\"\n  }, visTypeMap[visualizationType].name), /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.arrowIcon\n  }, /*#__PURE__*/React.createElement(ArrowDown, null))), listIsOpen && /*#__PURE__*/React.createElement(Layer, {\n    onClick: () => setListIsOpen(false)\n  }, /*#__PURE__*/React.createElement(Popper, {\n    reference: buttonRef,\n    placement: \"bottom-start\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.cardContainer\n  }, VisTypesList))));\n};\nVisualizationTypeSelector.propTypes = {\n  visualizationType: PropTypes.oneOf(Object.keys(visTypeMap))\n};\n\nconst mapStateToProps = state => ({\n  visualizationType: sGetUiType(state),\n  ui: sGetUi(state)\n});\n\nexport default connect(mapStateToProps)(VisualizationTypeSelector);","import cx from 'classnames';\nimport React from 'react';\nimport classes from '../App.module.css';\nimport { default as MenuBar } from './MenuBar/MenuBar.js';\nimport { default as VisualizationTypeSelector } from './VisualizationTypeSelector/VisualizationTypeSelector.js';\nconst apiObjectName = 'eventVisualization'; // TODO move to App?\n\nexport const Toolbar = () => {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.sectionToolbar, classes.flexCt)\n  }, /*#__PURE__*/React.createElement(VisualizationTypeSelector, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.toolbarMenubar, classes.flexGrow1)\n  }, /*#__PURE__*/React.createElement(MenuBar, {\n    apiObjectName: apiObjectName,\n    dataTest: 'app-menubar'\n  })));\n};","import { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { GenericError } from '../../assets/ErrorIcons.js';\nimport { EVENT_TYPE } from '../../modules/dataStatistics.js';\nimport { VisualizationError, genericErrorTitle } from '../../modules/error.js';\nimport history from '../../modules/history.js';\nimport { sGetUsername } from '../../reducers/user.js';\nimport styles from './styles/StartScreen.module.css';\nconst mostViewedVisualizationsQuery = {\n  mostViewedVisualizations: {\n    resource: 'dataStatistics/favorites',\n    params: ({\n      pageSize,\n      username\n    }) => ({\n      eventType: EVENT_TYPE,\n      pageSize: pageSize || 10,\n      ...(username ? {\n        username\n      } : {})\n    })\n  }\n};\n\nconst StartScreen = ({\n  error,\n  username\n}) => {\n  const {\n    data\n  } = useDataQuery(mostViewedVisualizationsQuery, {\n    variables: {\n      pageSize: 6,\n      username\n    }\n  });\n\n  const getContent = () => error ? getErrorContent() : /*#__PURE__*/React.createElement(\"div\", {\n    \"data-test\": \"start-screen\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.section\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: styles.title,\n    \"data-test\": \"start-screen-primary-section-title\"\n  }, i18n.t('Getting started')), /*#__PURE__*/React.createElement(\"ul\", {\n    className: styles.guide\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    className: styles.guideItem\n  }, i18n.t('TEXT')), /*#__PURE__*/React.createElement(\"li\", {\n    className: styles.guideItem\n  }, i18n.t('TEXT')), /*#__PURE__*/React.createElement(\"li\", {\n    className: styles.guideItem\n  }, i18n.t('TEXT')))), (data === null || data === void 0 ? void 0 : data.mostViewedVisualizations.length) > 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.section\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: styles.title,\n    \"data-test\": \"start-screen-secondary-section-title\"\n  }, i18n.t('Your most viewed TEXT')), data.mostViewedVisualizations.map((visualization, index) => {\n    return /*#__PURE__*/React.createElement(\"p\", {\n      key: index,\n      className: styles.visualization,\n      onClick: () => history.push(`/${visualization.id}`),\n      \"data-test\": \"start-screen-most-viewed-list-item\"\n    }, /*#__PURE__*/React.createElement(\"span\", null, visualization.name));\n  })));\n\n  const getErrorContent = () => /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.errorContainer,\n    \"data-test\": \"start-screen-error-container\"\n  }, error instanceof VisualizationError ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.errorIcon\n  }, error.icon()), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.errorTitle\n  }, error.title), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.errorDescription\n  }, error.description)) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.errorIcon\n  }, GenericError()), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.errorTitle\n  }, genericErrorTitle), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.errorDescription\n  }, error.message || error)));\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.outer\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.inner\n  }, getContent()));\n};\n\nStartScreen.propTypes = {\n  error: PropTypes.object,\n  username: PropTypes.string\n};\n\nconst mapStateToProps = state => ({\n  // TODO: Implement set and get load error in the store and on the visualization\n  error: null,\n  //sGetLoadError(state),\n  username: sGetUsername(state)\n});\n\nexport default connect(mapStateToProps)(StartScreen);","import { useDataQuery, useDataMutation } from '@dhis2/app-runtime';\nimport { useD2 } from '@dhis2/app-runtime-adapter-d2';\nimport { CssVariables } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useState, useEffect, useRef } from 'react';\nimport { connect, useDispatch } from 'react-redux';\nimport { acClearCurrent, acSetCurrent } from '../actions/current.js';\nimport { acSetVisualizationLoading } from '../actions/loader.js';\nimport { acAddMetadata, tSetInitMetadata } from '../actions/metadata.js';\nimport { tAddSettings } from '../actions/settings.js';\nimport { tClearUi, acSetUiFromVisualization, acAddParentGraphMap, acSetShowExpandedLayoutPanel } from '../actions/ui.js';\nimport { acSetUser } from '../actions/user.js';\nimport { acClearVisualization, acSetVisualization } from '../actions/visualization.js';\nimport { EVENT_TYPE } from '../modules/dataStatistics.js';\nimport history from '../modules/history.js';\nimport { getParentGraphMapFromVisualization } from '../modules/ui.js';\nimport { transformVisualization } from '../modules/visualization.js';\nimport { sGetCurrent } from '../reducers/current.js';\nimport { sGetIsVisualizationLoading } from '../reducers/loader.js';\nimport { sGetUiShowDetailsPanel } from '../reducers/ui.js';\nimport classes from './App.module.css';\nimport { default as DetailsPanel } from './DetailsPanel/DetailsPanel.js';\nimport { default as DialogManager } from './Dialogs/DialogManager.js';\nimport DndContext from './DndContext.js';\nimport { InterpretationModal } from './InterpretationModal/index.js';\nimport Layout from './Layout/Layout.js';\nimport LoadingMask from './LoadingMask/LoadingMask.js';\nimport { MainSidebar } from './MainSidebar/index.js';\nimport { default as TitleBar } from './TitleBar/TitleBar.js';\nimport { Toolbar } from './Toolbar/Toolbar.js';\nimport StartScreen from './Visualization/StartScreen.js';\nimport { Visualization } from './Visualization/Visualization.js';\nconst visualizationQuery = {\n  eventVisualization: {\n    resource: 'eventVisualizations',\n    id: ({\n      id\n    }) => id,\n    // TODO: check if this list is what we need/want (copied from old ER)\n    params: {\n      fields: ['*', 'columns[dimension,dimensionType,filter,programStage[id],optionSet[id],valueType,legendSet[id],items[dimensionItem~rename(id)]]', 'rows[dimension,dimensionType,filter,programStage[id],optionSet[id],valueType,legendSet[id],items[dimensionItem~rename(id)]]', 'filters[dimension,dimensionType,filter,programStage[id],optionSet[id],valueType,legendSet[id],items[dimensionItem~rename(id)]]', 'program[id,displayName~rename(name),displayEnrollmentDateLabel,displayIncidentDateLabel,displayIncidentDate]', 'programStage[id,displayName~rename(name),displayExecutionDateLabel,displayDueDateLabel,hideDueDate]', 'access,user[displayName,userCredentials[username]]', 'href', 'dataElementDimensions[legendSet[id,name]', 'dataElement[id,name]]', '!interpretations', '!userGroupAccesses', '!publicAccess', '!displayDescription', '!rewindRelativePeriods', '!userOrganisationUnit', '!userOrganisationUnitChildren', '!userOrganisationUnitGrandChildren', '!externalAccess', '!relativePeriods', '!columnDimensions', '!rowDimensions', '!filterDimensions', '!organisationUnitGroups', '!itemOrganisationUnitGroups', '!indicators', '!dataElements', '!dataElementOperands', '!dataElementGroups', '!dataSets', '!periods', '!organisationUnitLevels', '!organisationUnits']\n    }\n  }\n};\nconst dataStatisticsMutation = {\n  resource: 'dataStatistics',\n  params: ({\n    id\n  }) => ({\n    favorite: id,\n    eventType: EVENT_TYPE\n  }),\n  type: 'create'\n};\n\nconst App = ({\n  initialLocation,\n  current,\n  addMetadata,\n  addParentGraphMap,\n  addSettings,\n  clearCurrent,\n  clearVisualization,\n  clearUi,\n  isLoading,\n  setCurrent,\n  setInitMetadata,\n  setVisualization,\n  setVisualizationLoading,\n  setUiFromVisualization,\n  setUser,\n  showDetailsPanel,\n  userSettings\n}) => {\n  const [previousLocation, setPreviousLocation] = useState(null);\n  const [initialLoadIsComplete, setInitialLoadIsComplete] = useState(false);\n  const {\n    data,\n    refetch\n  } = useDataQuery(visualizationQuery, {\n    lazy: true\n  });\n  const [postDataStatistics] = useDataMutation(dataStatisticsMutation);\n  const {\n    d2\n  } = useD2();\n  const dispatch = useDispatch();\n  const interpretationsUnitRef = useRef();\n\n  const onInterpretationUpdate = () => {\n    interpretationsUnitRef.current.refresh();\n  };\n\n  const needsRefetch = location => {\n    if (!previousLocation) {\n      return true;\n    }\n\n    const id = location.pathname.slice(1).split('/')[0];\n    const prevId = previousLocation.slice(1).split('/')[0];\n\n    if (id !== prevId || previousLocation === location.pathname) {\n      return true;\n    }\n\n    return false;\n  };\n\n  const parseLocation = location => {\n    const pathParts = location.pathname.slice(1).split('/');\n    const id = pathParts[0];\n    const interpretationId = pathParts[2];\n    return {\n      id,\n      interpretationId\n    };\n  };\n\n  const loadVisualization = location => {\n    setVisualizationLoading(true);\n    const isExisting = location.pathname.length > 1;\n\n    if (isExisting) {\n      // /currentAnalyticalObject\n      // /${id}/\n      // /${id}/interpretation/${interpretationId}\n      const {\n        id\n      } = parseLocation(location);\n\n      if (needsRefetch(location)) {\n        refetch({\n          id\n        });\n      }\n    } else {\n      clearCurrent();\n      clearVisualization(); //const digitGroupSeparator = sGetSettingsDigitGroupSeparator(getState())\n\n      clearUi();\n      setVisualizationLoading(false);\n    }\n\n    dispatch(acSetShowExpandedLayoutPanel(!isExisting));\n    setInitialLoadIsComplete(true);\n    setPreviousLocation(location.pathname);\n  };\n\n  const onResponseReceived = response => {\n    setVisualizationLoading(false);\n    const {\n      program,\n      programStage\n    } = data.eventVisualization;\n    const itemsMetadata = Object.entries(response.metaData.items).reduce((obj, [id, item]) => {\n      obj[id] = {\n        id,\n        name: item.name || item.displayName,\n        displayName: item.displayName,\n        dimensionItemType: item.dimensionItemType,\n        // TODO needed?\n        code: item.code\n      };\n      return obj;\n    }, {});\n    addMetadata({ ...itemsMetadata,\n      [program.id]: program,\n      [programStage.id]: programStage\n    });\n  };\n\n  useEffect(() => {\n    const onMount = async () => {\n      await addSettings(userSettings);\n      setUser(d2.currentUser);\n      setInitMetadata();\n      loadVisualization(initialLocation);\n    };\n\n    onMount();\n    const unlisten = history.listen(({\n      location\n    }) => {\n      var _location$state, _location$state2, _location$state3, _location$state4, _location$state5;\n\n      const isSaving = (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.isSaving;\n      const isOpening = (_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.isOpening;\n      const isResetting = (_location$state3 = location.state) === null || _location$state3 === void 0 ? void 0 : _location$state3.isResetting;\n      const isModalOpening = (_location$state4 = location.state) === null || _location$state4 === void 0 ? void 0 : _location$state4.isModalOpening;\n      const isModalClosing = (_location$state5 = location.state) === null || _location$state5 === void 0 ? void 0 : _location$state5.isModalClosing;\n      const isValidLocationChange = previousLocation !== location.pathname && !isModalOpening && !isModalClosing; // TODO navigation confirm dialog\n\n      if (isSaving || isOpening || isResetting || isValidLocationChange) {\n        loadVisualization(location);\n      }\n    });\n    return () => unlisten && unlisten();\n  }, []);\n  useEffect(() => {\n    if (data !== null && data !== void 0 && data.eventVisualization) {\n      const visualization = transformVisualization(data.eventVisualization);\n      addParentGraphMap(getParentGraphMapFromVisualization(visualization));\n      setVisualization(visualization);\n      setCurrent(visualization);\n      setUiFromVisualization(visualization);\n      postDataStatistics({\n        id: visualization.id\n      });\n    }\n  }, [data]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.eventReportsApp, classes.flexCt, classes.flexDirCol)\n  }, /*#__PURE__*/React.createElement(Toolbar, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.sectionMain, classes.flexGrow1, classes.flexCt)\n  }, /*#__PURE__*/React.createElement(DndContext, null, /*#__PURE__*/React.createElement(MainSidebar, null), /*#__PURE__*/React.createElement(DialogManager, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.mainCenter, classes.flexGrow1, classes.flexBasis0, classes.flexCt, classes.flexDirCol)\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.mainCenterLayout\n  }, /*#__PURE__*/React.createElement(Layout, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.mainCenterTitlebar\n  }, /*#__PURE__*/React.createElement(TitleBar, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.mainCenterCanvas, classes.flexGrow1)\n  }, initialLoadIsComplete && (!current && !isLoading ? /*#__PURE__*/React.createElement(StartScreen, null) : /*#__PURE__*/React.createElement(React.Fragment, null, isLoading && /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.loadingCover\n  }, /*#__PURE__*/React.createElement(LoadingMask, null)), current && /*#__PURE__*/React.createElement(Visualization, {\n    visualization: current,\n    onResponseReceived: onResponseReceived\n  }), current && /*#__PURE__*/React.createElement(InterpretationModal, {\n    onInterpretationUpdate: onInterpretationUpdate\n  })))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.mainRight, {\n      [classes.hidden]: !showDetailsPanel\n    })\n  }, showDetailsPanel && current && /*#__PURE__*/React.createElement(DetailsPanel, {\n    interpretationsUnitRef: interpretationsUnitRef\n  }))), /*#__PURE__*/React.createElement(CssVariables, {\n    colors: true,\n    spacers: true,\n    theme: true\n  }));\n};\n\nconst mapStateToProps = state => ({\n  current: sGetCurrent(state),\n  isLoading: sGetIsVisualizationLoading(state),\n  showDetailsPanel: sGetUiShowDetailsPanel(state)\n});\n\nconst mapDispatchToProps = {\n  addMetadata: acAddMetadata,\n  addParentGraphMap: acAddParentGraphMap,\n  addSettings: tAddSettings,\n  clearVisualization: acClearVisualization,\n  clearCurrent: acClearCurrent,\n  clearUi: tClearUi,\n  setCurrent: acSetCurrent,\n  setInitMetadata: tSetInitMetadata,\n  setVisualization: acSetVisualization,\n  setUser: acSetUser,\n  setUiFromVisualization: acSetUiFromVisualization,\n  setVisualizationLoading: acSetVisualizationLoading\n};\nApp.propTypes = {\n  addMetadata: PropTypes.func,\n  addParentGraphMap: PropTypes.func,\n  addSettings: PropTypes.func,\n  clearCurrent: PropTypes.func,\n  clearUi: PropTypes.func,\n  clearVisualization: PropTypes.func,\n  current: PropTypes.object,\n  initialLocation: PropTypes.object,\n  isLoading: PropTypes.bool,\n  setCurrent: PropTypes.func,\n  setInitMetadata: PropTypes.func,\n  setUiFromVisualization: PropTypes.func,\n  setUser: PropTypes.func,\n  setVisualization: PropTypes.func,\n  setVisualizationLoading: PropTypes.func,\n  showDetailsPanel: PropTypes.bool,\n  userSettings: PropTypes.object\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","import { apiFetchOrganisationUnitRoots } from '@dhis2/analytics';\nimport { apiFetchSystemSettings } from '../api/settings.js';\nimport { ADD_SETTINGS } from '../reducers/settings.js';\nexport const acAddSettings = value => ({\n  type: ADD_SETTINGS,\n  value\n});\nexport const tAddSettings = (...extraSettings) => async (dispatch, getState, engine) => {\n  const onSuccess = fetchedSettings => {\n    dispatch(acAddSettings(Object.assign({}, fetchedSettings, ...extraSettings)));\n  };\n\n  const onError = error => {\n    console.log('Error (apiFetchSystemSettings): ', error);\n    return error;\n  };\n\n  try {\n    const fetchSystemSettings = apiFetchSystemSettings(engine);\n    const fetchOrgUnitRoots = apiFetchOrganisationUnitRoots(engine); // run in parallel\n\n    const [systemSettings, orgUnitRoots] = await Promise.all([fetchSystemSettings, fetchOrgUnitRoots]);\n    return onSuccess({ ...systemSettings,\n      rootOrgUnits: orgUnitRoots\n    });\n  } catch (err) {\n    return onError(err);\n  }\n};","import { USER_ORG_UNIT, USER_ORG_UNIT_CHILDREN, USER_ORG_UNIT_GRANDCHILDREN, DIMENSION_ID_ORGUNIT, getDimensionById, DIMENSION_ID_PERIOD } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\n\nconst getOrganisationUnits = () => ({\n  [USER_ORG_UNIT]: i18n.t('User organisation unit'),\n  [USER_ORG_UNIT_CHILDREN]: i18n.t('User sub-units'),\n  [USER_ORG_UNIT_GRANDCHILDREN]: i18n.t('User sub-x2-units')\n});\n\nconst getFixedDimensions = () => ({\n  [DIMENSION_ID_ORGUNIT]: getDimensionById(DIMENSION_ID_ORGUNIT),\n  [DIMENSION_ID_PERIOD]: getDimensionById(DIMENSION_ID_PERIOD)\n});\n\nexport default function () {\n  return { ...Object.entries({ ...getOrganisationUnits()\n    }).reduce((obj, [key, value]) => ({ ...obj,\n      [key]: {\n        name: value\n      }\n    }), {}),\n    ...getFixedDimensions()\n  };\n}","import { SET_USER } from '../reducers/user.js';\nexport const acSetUser = value => ({\n  type: SET_USER,\n  value\n});","import { SET_LOAD_ERROR, CLEAR_LOAD_ERROR, SET_VISUALIZATION_LOADING } from '../reducers/loader.js';\nexport const acSetLoadError = value => ({\n  type: SET_LOAD_ERROR,\n  value\n});\nexport const acClearLoadError = () => ({\n  type: CLEAR_LOAD_ERROR\n});\nexport const acSetVisualizationLoading = value => ({\n  type: SET_VISUALIZATION_LOADING,\n  value\n});","import { useDataEngine } from '@dhis2/app-runtime';\nimport PropTypes from 'prop-types';\nimport React, { useContext, useState, useEffect, createContext } from 'react';\nexport const userSettingsQuery = {\n  resource: 'userSettings',\n  params: {\n    key: ['keyUiLocale', 'keyAnalysisDisplayProperty']\n  }\n};\nexport const UserSettingsCtx = /*#__PURE__*/createContext({});\n\nconst UserSettingsProvider = ({\n  children\n}) => {\n  const [settings, setSettings] = useState([]);\n  const engine = useDataEngine();\n  useEffect(() => {\n    async function fetchData() {\n      const {\n        userSettings\n      } = await engine.query({\n        userSettings: userSettingsQuery\n      });\n      const {\n        keyAnalysisDisplayProperty,\n        keyUiLocale,\n        ...rest\n      } = userSettings;\n      setSettings({ ...rest,\n        displayProperty: keyAnalysisDisplayProperty,\n        displayNameProperty: keyAnalysisDisplayProperty === 'name' ? 'displayName' : 'displayShortName',\n        uiLocale: keyUiLocale\n      });\n    }\n\n    fetchData();\n  }, []);\n  return /*#__PURE__*/React.createElement(UserSettingsCtx.Provider, {\n    value: {\n      userSettings: settings\n    }\n  }, children);\n};\n\nUserSettingsProvider.propTypes = {\n  children: PropTypes.node\n};\nexport default UserSettingsProvider;\nexport const useUserSettings = () => useContext(UserSettingsCtx);","import { combineReducers } from 'redux';\nimport current from './current.js';\nimport loader from './loader.js';\nimport metadata from './metadata.js';\nimport settings from './settings.js';\nimport ui from './ui.js';\nimport user from './user.js';\nimport visualization from './visualization.js'; // Reducers\n\nexport default combineReducers({\n  current,\n  loader,\n  metadata,\n  settings,\n  ui,\n  user,\n  visualization\n});","import { createStore, applyMiddleware, compose } from 'redux';\nimport { createLogger } from 'redux-logger';\nimport reducer from './reducers/index.js';\n\nconst configureStore = middleware => {\n  // Enable Redux devtools if extension is installed instead of redux-logger\n  // const composeEnhancers =\n  //     window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n  const composeEnhancers = typeof window === 'object' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\n    name: 'event-reports-app'\n  }) : compose;\n\n  if (!window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ && process.env.NODE_ENV !== 'production') {\n    middleware.push(createLogger());\n  }\n\n  return createStore(reducer, composeEnhancers(applyMiddleware(...middleware)));\n};\n\nexport default configureStore;","import { acAddMetadata } from '../actions/metadata.js';\nexport default (({\n  dispatch\n}) => next => action => {\n  if (typeof action.metadata === 'object') {\n    if (Array.isArray(action.metadata)) {\n      dispatch(acAddMetadata(action.metadata.reduce((meta, obj) => ({ ...meta,\n        ...obj\n      }), {})));\n    } else {\n      dispatch(acAddMetadata(action.metadata));\n    }\n  }\n\n  next(action);\n});","//------------------------------------------------------------------------------\n// <auto-generated>\n// This code was generated by d2-i18n-generate.\n//\n// Changes to this file may cause incorrect behavior and will be lost if\n// the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\nimport enTranslations from './en/translations.json';\nconst namespace = 'default';\ni18n.addResources('en', namespace, enTranslations);\nexport default i18n;","import { apiFetchOrganisationUnitLevels } from '@dhis2/analytics';\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport { D2Shim } from '@dhis2/app-runtime-adapter-d2';\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Provider as ReduxProvider } from 'react-redux';\nimport thunk from 'redux-thunk';\nimport App from './components/App.js';\nimport UserSettingsProvider, { UserSettingsCtx } from './components/UserSettingsProvider.js';\nimport configureStore from './configureStore.js';\nimport metadataMiddleware from './middleware/metadata.js';\nimport history from './modules/history.js';\nimport './locales/index.js';\n\nconst AppWrapper = () => {\n  const engine = useDataEngine();\n  const store = configureStore([thunk.withExtraArgument(engine), // FIXME: Not needed for ER? Pointed out by @edoardo\n  metadataMiddleware]);\n\n  if (window.Cypress) {\n    window.store = store;\n  }\n\n  const [ouLevels, setOuLevels] = useState(null);\n  const doFetchOuLevelsData = useCallback(async () => {\n    const ouLevels = await apiFetchOrganisationUnitLevels(engine);\n    return ouLevels;\n  }, [engine]);\n  useEffect(() => {\n    const doFetch = async () => {\n      const ouLevelsData = await doFetchOuLevelsData();\n      setOuLevels(ouLevelsData);\n    };\n\n    doFetch();\n  }, []);\n  const d2Config = {\n    schemas: []\n  };\n  return /*#__PURE__*/React.createElement(ReduxProvider, {\n    store: store\n  }, /*#__PURE__*/React.createElement(UserSettingsProvider, null, /*#__PURE__*/React.createElement(UserSettingsCtx.Consumer, null, ({\n    userSettings\n  }) => {\n    return userSettings !== null && userSettings !== void 0 && userSettings.uiLocale ? /*#__PURE__*/React.createElement(D2Shim, {\n      d2Config: d2Config,\n      i18nRoot: \"./i18n_old\",\n      locale: userSettings.uiLocale\n    }, ({\n      d2\n    }) => {\n      if (!d2) {\n        // TODO: Handle errors in d2 initialization\n        return null;\n      } else {\n        return /*#__PURE__*/React.createElement(App, {\n          initialLocation: history.location,\n          ouLevels: ouLevels // TODO: Unused by App.js?\n          ,\n          userSettings: userSettings\n        });\n      }\n    }) : null;\n  })));\n};\n\nexport default AppWrapper;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Condition_container__2PHek\",\"caseSensitiveCheckbox\":\"Condition_caseSensitiveCheckbox__3uv1C\",\"checkboxOption\":\"Condition_checkboxOption__S7cPf\",\"transferEmptyList\":\"Condition_transferEmptyList__-jLXv\",\"transferRightHeader\":\"Condition_transferRightHeader__3lqCY\",\"transferLeftHeader\":\"Condition_transferLeftHeader__16EYc\",\"transferLeftTitle\":\"Condition_transferLeftTitle__3qU-f\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"eventReportsApp\":\"App_eventReportsApp__1IBE2\",\"flexCt\":\"App_flexCt__1IpfG\",\"flexDirCol\":\"App_flexDirCol__1Cgay\",\"flexGrow1\":\"App_flexGrow1__8jN-Q\",\"flexBasis0\":\"App_flexBasis0__1mO1H\",\"sectionToolbar\":\"App_sectionToolbar__12zaV\",\"sectionMain\":\"App_sectionMain__YyINn\",\"mainRight\":\"App_mainRight__BzcXA\",\"hidden\":\"App_hidden__12ktD\",\"mainCenterCanvas\":\"App_mainCenterCanvas__2pvhq\",\"loadingCover\":\"App_loadingCover__1pu3p\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"DefaultAxis_content__VAbLV\",\"axisContainer\":\"DefaultAxis_axisContainer__q8XYW\",\"axisContainerLeft\":\"DefaultAxis_axisContainerLeft__npnSy\",\"label\":\"DefaultAxis_label__2sa1T\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"VisualizationTypeSelector_container__1XsCk\",\"arrowIcon\":\"VisualizationTypeSelector_arrowIcon__2y1Rf\",\"button\":\"VisualizationTypeSelector_button__2kNLq\",\"cardContainer\":\"VisualizationTypeSelector_cardContainer__2ZAYC\",\"listContainer\":\"VisualizationTypeSelector_listContainer__3ialy\",\"listSection\":\"VisualizationTypeSelector_listSection__pmWHb\",\"listItem\":\"VisualizationTypeSelector_listItem__1aN1Q\",\"listItemActive\":\"VisualizationTypeSelector_listItemActive__mxbeD\",\"listItemDisabled\":\"VisualizationTypeSelector_listItemDisabled__fj4sn\",\"listItemSvg\":\"VisualizationTypeSelector_listItemSvg__1pu1R\",\"listItemIcon\":\"VisualizationTypeSelector_listItemIcon__3htla\",\"listItemName\":\"VisualizationTypeSelector_listItemName__qOXbS\",\"listItemDescription\":\"VisualizationTypeSelector_listItemDescription__2nek3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"panel\":\"DetailsPanel_panel__3HQiD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modalContent\":\"DimensionModal_modalContent__2kUc6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"paragraph\":\"ConditionsManager_paragraph__XbFiK\",\"mainSection\":\"ConditionsManager_mainSection__3pSE1\",\"infoIcon\":\"ConditionsManager_infoIcon__3srry\",\"separator\":\"ConditionsManager_separator__2T_O2\",\"tooltipReference\":\"ConditionsManager_tooltipReference__ma5Fs\",\"addConditionButton\":\"ConditionsManager_addConditionButton__1jGDJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"menuButton\":\"MenuButton_menuButton__1DWzl\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ModalDownloadDropdown_container__3I5rL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Visualization_wrapper__ssRwb\",\"fetchIndicator\":\"Visualization_fetchIndicator__2FWs8\",\"fetching\":\"Visualization_fetching__35syS\",\"rotation\":\"Visualization_rotation__1ex8N\",\"stickyFooter\":\"Visualization_stickyFooter__19-kU\",\"fontSizeLarge\":\"Visualization_fontSizeLarge__1daMy\",\"fontSizeNormal\":\"Visualization_fontSizeNormal__2924D\",\"fontSizeSmall\":\"Visualization_fontSizeSmall__1uPuD\",\"error\":\"Visualization_error__3jNKn\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chipWrapper\":\"Chip_chipWrapper__1gPDj\",\"chip\":\"Chip_chip__cOcF9\",\"chipEmpty\":\"Chip_chipEmpty__2QrQ6\",\"fixedDimensionIcon\":\"Chip_fixedDimensionIcon__18wQS\",\"leftIconWrapper\":\"Chip_leftIconWrapper__1w0dt\",\"rightIconWrapper\":\"Chip_rightIconWrapper__LUdE5\",\"label\":\"Chip_label__Ev-rO\",\"chipLeft\":\"Chip_chipLeft__2t7wj\",\"chipRight\":\"Chip_chipRight__2oU_k\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tooltip\":\"Tooltip_tooltip__2SB4H\",\"list\":\"Tooltip_list__3YnyU\",\"item\":\"Tooltip_item__2A5po\",\"iconWrapper\":\"Tooltip_iconWrapper__3oGXn\",\"label\":\"Tooltip_label__1OqRb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconButton\":\"IconButton_iconButton__2bUtk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ct\":\"DefaultLayout_ct__g44sy\",\"axisGroup\":\"DefaultLayout_axisGroup__1U48b\",\"axisGroupLeft\":\"DefaultLayout_axisGroupLeft__2zBGl\",\"axisGroupRight\":\"DefaultLayout_axisGroupRight__2mIMK\",\"columns\":\"DefaultLayout_columns__2b1mE\",\"rows\":\"DefaultLayout_rows__2OEBn\",\"filters\":\"DefaultLayout_filters__2SGgf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"axisGroupLeft\":\"LineListLayout_axisGroupLeft__2V_pu\",\"axisGroupRight\":\"LineListLayout_axisGroupRight__W0bLg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Layout_container__iNjNx\",\"overflowContainer\":\"Layout_overflowContainer__NNhEO\",\"expanded\":\"Layout_expanded__1-qxf\",\"button\":\"Layout_button__alBlV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"progress\":\"LoadingMask_progress__lij90\",\"outer\":\"LoadingMask_outer__WLmB4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"InputOption_container__LZ-Ch\",\"selected\":\"InputOption_selected__1mHRB\",\"label\":\"InputOption_label__2NFiX\",\"header\":\"InputOption_header__f4LP6\",\"description\":\"InputOption_description__220eS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"InputPanel_container__1gzZi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"MainSidebar_container__pD1UY\",\"main\":\"MainSidebar_main__dduRL\",\"accessory\":\"MainSidebar_accessory__2ZuTp\",\"hidden\":\"MainSidebar_hidden__1YPr-\",\"accessoryInner\":\"MainSidebar_accessoryInner__7uTeb\",\"padded\":\"MainSidebar_padded__2Eout\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"MenuItem_container__1bcNf\",\"selected\":\"MenuItem_selected__3J3UG\",\"icon\":\"MenuItem_icon__3WuSd\",\"label\":\"MenuItem_label__24aSP\",\"count\":\"MenuItem_count__FjJ6I\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ProgramDimensionsFilter_container__3Yn6W\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dimensionItem\":\"DimensionListItem_dimensionItem__1oN_u\",\"dragOnly\":\"DimensionListItem_dragOnly__2pxr7\",\"icon\":\"DimensionListItem_icon__2DFfP\",\"label\":\"DimensionListItem_label__3Qdwn\",\"lock\":\"DimensionListItem_lock__2bLQ7\",\"menuTrigger\":\"DimensionListItem_menuTrigger__1GRLs\",\"disabled\":\"DimensionListItem_disabled__1ReiF\",\"menuTriggerActive\":\"DimensionListItem_menuTriggerActive__2nkgm\",\"picked\":\"DimensionListItem_picked__1FkAy\",\"recommended\":\"DimensionListItem_recommended__2vTqd\",\"diLabelAfter\":\"DimensionListItem_diLabelAfter__2pd00\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"scrollbox\":\"DimensionsList_scrollbox__2gqbB\",\"list\":\"DimensionsList_list__3YME8\",\"errorWrap\":\"DimensionsList_errorWrap__F02mo\",\"noResults\":\"DimensionsList_noResults__3VG-C\",\"loaderWrap\":\"DimensionsList_loaderWrap__2vHE8\",\"loadMoreWrap\":\"DimensionsList_loadMoreWrap__3hDWV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ProgramDimensionsPanel_container__1w1No\",\"section\":\"ProgramDimensionsPanel_section__3ettA\",\"bordered\":\"ProgramDimensionsPanel_bordered__CgudI\",\"helptext\":\"ProgramDimensionsPanel_helptext__3KF_I\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"rows\":\"ProgramSelect_rows__4lzXm\",\"columns\":\"ProgramSelect_columns__t6lxb\",\"stretch\":\"ProgramSelect_stretch__2sQrM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"search\":\"YourDimensionsPanel_search__3sv7B\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"titleBar\":\"TitleBar_titleBar__2T_Zo\",\"cell\":\"TitleBar_cell__1Hoh9\",\"title\":\"TitleBar_title__feEes\",\"suffix\":\"TitleBar_suffix__ZpeRe\",\"titleUnsaved\":\"TitleBar_titleUnsaved__2QMMQ\",\"titleDirty\":\"TitleBar_titleDirty__1WtZH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconWrapper\":\"InterpretationsButton_iconWrapper__1D7Q_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"menuBar\":\"MenuBar_menuBar__1bQ7O\",\"updateButton\":\"MenuBar_updateButton__S7DT_\",\"flexGrow\":\"MenuBar_flexGrow__1THGo\"};"],"sourceRoot":""}